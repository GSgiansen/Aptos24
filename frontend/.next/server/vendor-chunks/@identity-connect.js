"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@identity-connect";
exports.ids = ["vendor-chunks/@identity-connect"];
exports.modules = {

/***/ "(ssr)/../../../../node_modules/@identity-connect/api/dist/index.mjs":
/*!*********************************************************************!*\
  !*** ../../../../node_modules/@identity-connect/api/dist/index.mjs ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_BACKEND_URL: () => (/* binding */ DEFAULT_BACKEND_URL),\n/* harmony export */   NetworkName: () => (/* binding */ NetworkName),\n/* harmony export */   PairingStatus: () => (/* binding */ PairingStatus),\n/* harmony export */   SigningRequestStatus: () => (/* binding */ SigningRequestStatus),\n/* harmony export */   SigningRequestTypes: () => (/* binding */ SigningRequestTypes)\n/* harmony export */ });\n// src/constants.ts\nvar DEFAULT_BACKEND_URL = \"https://identityconnect.com\";\n\n// src/network.ts\nvar NetworkName = /* @__PURE__ */ ((NetworkName2) => {\n  NetworkName2[\"DEVNET\"] = \"devnet\";\n  NetworkName2[\"MAINNET\"] = \"mainnet\";\n  NetworkName2[\"TESTNET\"] = \"testnet\";\n  return NetworkName2;\n})(NetworkName || {});\n\n// src/types/pairing.ts\nvar PairingStatus = /* @__PURE__ */ ((PairingStatus2) => {\n  PairingStatus2[\"Finalized\"] = \"FINALIZED\";\n  PairingStatus2[\"Pending\"] = \"PENDING\";\n  return PairingStatus2;\n})(PairingStatus || {});\n\n// src/types/signingRequest.ts\nvar SigningRequestTypes = /* @__PURE__ */ ((SigningRequestTypes2) => {\n  SigningRequestTypes2[\"SIGN_AND_SUBMIT_TRANSACTION\"] = \"SIGN_AND_SUBMIT_TRANSACTION\";\n  SigningRequestTypes2[\"SIGN_MESSAGE\"] = \"SIGN_MESSAGE\";\n  SigningRequestTypes2[\"SIGN_TRANSACTION\"] = \"SIGN_TRANSACTION\";\n  return SigningRequestTypes2;\n})(SigningRequestTypes || {});\nvar SigningRequestStatus = /* @__PURE__ */ ((SigningRequestStatus2) => {\n  SigningRequestStatus2[\"APPROVED\"] = \"APPROVED\";\n  SigningRequestStatus2[\"CANCELLED\"] = \"CANCELLED\";\n  SigningRequestStatus2[\"INVALID\"] = \"INVALID\";\n  SigningRequestStatus2[\"PENDING\"] = \"PENDING\";\n  SigningRequestStatus2[\"REJECTED\"] = \"REJECTED\";\n  return SigningRequestStatus2;\n})(SigningRequestStatus || {});\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL0BpZGVudGl0eS1jb25uZWN0L2FwaS9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxtQkFBbUI7O0FBRXBCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHFCQUFxQjs7QUFFdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywyQkFBMkI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDRCQUE0QjtBQU8zQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZnJvbnRlbmQvLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL0BpZGVudGl0eS1jb25uZWN0L2FwaS9kaXN0L2luZGV4Lm1qcz83YTA2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9jb25zdGFudHMudHNcbnZhciBERUZBVUxUX0JBQ0tFTkRfVVJMID0gXCJodHRwczovL2lkZW50aXR5Y29ubmVjdC5jb21cIjtcblxuLy8gc3JjL25ldHdvcmsudHNcbnZhciBOZXR3b3JrTmFtZSA9IC8qIEBfX1BVUkVfXyAqLyAoKE5ldHdvcmtOYW1lMikgPT4ge1xuICBOZXR3b3JrTmFtZTJbXCJERVZORVRcIl0gPSBcImRldm5ldFwiO1xuICBOZXR3b3JrTmFtZTJbXCJNQUlOTkVUXCJdID0gXCJtYWlubmV0XCI7XG4gIE5ldHdvcmtOYW1lMltcIlRFU1RORVRcIl0gPSBcInRlc3RuZXRcIjtcbiAgcmV0dXJuIE5ldHdvcmtOYW1lMjtcbn0pKE5ldHdvcmtOYW1lIHx8IHt9KTtcblxuLy8gc3JjL3R5cGVzL3BhaXJpbmcudHNcbnZhciBQYWlyaW5nU3RhdHVzID0gLyogQF9fUFVSRV9fICovICgoUGFpcmluZ1N0YXR1czIpID0+IHtcbiAgUGFpcmluZ1N0YXR1czJbXCJGaW5hbGl6ZWRcIl0gPSBcIkZJTkFMSVpFRFwiO1xuICBQYWlyaW5nU3RhdHVzMltcIlBlbmRpbmdcIl0gPSBcIlBFTkRJTkdcIjtcbiAgcmV0dXJuIFBhaXJpbmdTdGF0dXMyO1xufSkoUGFpcmluZ1N0YXR1cyB8fCB7fSk7XG5cbi8vIHNyYy90eXBlcy9zaWduaW5nUmVxdWVzdC50c1xudmFyIFNpZ25pbmdSZXF1ZXN0VHlwZXMgPSAvKiBAX19QVVJFX18gKi8gKChTaWduaW5nUmVxdWVzdFR5cGVzMikgPT4ge1xuICBTaWduaW5nUmVxdWVzdFR5cGVzMltcIlNJR05fQU5EX1NVQk1JVF9UUkFOU0FDVElPTlwiXSA9IFwiU0lHTl9BTkRfU1VCTUlUX1RSQU5TQUNUSU9OXCI7XG4gIFNpZ25pbmdSZXF1ZXN0VHlwZXMyW1wiU0lHTl9NRVNTQUdFXCJdID0gXCJTSUdOX01FU1NBR0VcIjtcbiAgU2lnbmluZ1JlcXVlc3RUeXBlczJbXCJTSUdOX1RSQU5TQUNUSU9OXCJdID0gXCJTSUdOX1RSQU5TQUNUSU9OXCI7XG4gIHJldHVybiBTaWduaW5nUmVxdWVzdFR5cGVzMjtcbn0pKFNpZ25pbmdSZXF1ZXN0VHlwZXMgfHwge30pO1xudmFyIFNpZ25pbmdSZXF1ZXN0U3RhdHVzID0gLyogQF9fUFVSRV9fICovICgoU2lnbmluZ1JlcXVlc3RTdGF0dXMyKSA9PiB7XG4gIFNpZ25pbmdSZXF1ZXN0U3RhdHVzMltcIkFQUFJPVkVEXCJdID0gXCJBUFBST1ZFRFwiO1xuICBTaWduaW5nUmVxdWVzdFN0YXR1czJbXCJDQU5DRUxMRURcIl0gPSBcIkNBTkNFTExFRFwiO1xuICBTaWduaW5nUmVxdWVzdFN0YXR1czJbXCJJTlZBTElEXCJdID0gXCJJTlZBTElEXCI7XG4gIFNpZ25pbmdSZXF1ZXN0U3RhdHVzMltcIlBFTkRJTkdcIl0gPSBcIlBFTkRJTkdcIjtcbiAgU2lnbmluZ1JlcXVlc3RTdGF0dXMyW1wiUkVKRUNURURcIl0gPSBcIlJFSkVDVEVEXCI7XG4gIHJldHVybiBTaWduaW5nUmVxdWVzdFN0YXR1czI7XG59KShTaWduaW5nUmVxdWVzdFN0YXR1cyB8fCB7fSk7XG5leHBvcnQge1xuICBERUZBVUxUX0JBQ0tFTkRfVVJMLFxuICBOZXR3b3JrTmFtZSxcbiAgUGFpcmluZ1N0YXR1cyxcbiAgU2lnbmluZ1JlcXVlc3RTdGF0dXMsXG4gIFNpZ25pbmdSZXF1ZXN0VHlwZXNcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5tanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/../../../../node_modules/@identity-connect/api/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/../../../../node_modules/@identity-connect/crypto/dist/index.mjs":
/*!************************************************************************!*\
  !*** ../../../../node_modules/@identity-connect/crypto/dist/index.mjs ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AccountConnectionAction: () => (/* binding */ AccountConnectionAction),\n/* harmony export */   DecryptionError: () => (/* binding */ DecryptionError),\n/* harmony export */   EncryptionEnvelopeError: () => (/* binding */ EncryptionEnvelopeError),\n/* harmony export */   EnvelopeMessageMismatchError: () => (/* binding */ EnvelopeMessageMismatchError),\n/* harmony export */   KeyTypes: () => (/* binding */ KeyTypes),\n/* harmony export */   REQUIRED_FIELDS: () => (/* binding */ REQUIRED_FIELDS),\n/* harmony export */   SIGNATURE_PREFIX: () => (/* binding */ SIGNATURE_PREFIX),\n/* harmony export */   aptosAccountToEd25519Keypair: () => (/* binding */ aptosAccountToEd25519Keypair),\n/* harmony export */   aptosAccountToSerializedInfo: () => (/* binding */ aptosAccountToSerializedInfo),\n/* harmony export */   concatUint8array: () => (/* binding */ concatUint8array),\n/* harmony export */   constructMetadata: () => (/* binding */ constructMetadata),\n/* harmony export */   convertEd25519PublicKeyToX25519PublicKey: () => (/* binding */ convertEd25519PublicKeyToX25519PublicKey),\n/* harmony export */   convertEd25519SecretKeyToX25519SecretKey: () => (/* binding */ convertEd25519SecretKeyToX25519SecretKey),\n/* harmony export */   createEd25519KeyPair: () => (/* binding */ createEd25519KeyPair),\n/* harmony export */   createSerializedAccountInfo: () => (/* binding */ createSerializedAccountInfo),\n/* harmony export */   createX25519KeyPair: () => (/* binding */ createX25519KeyPair),\n/* harmony export */   dangerouslyEncryptAndSignEnvelopeUnvalidated: () => (/* binding */ dangerouslyEncryptAndSignEnvelopeUnvalidated),\n/* harmony export */   decodeBase64: () => (/* binding */ decodeBase64),\n/* harmony export */   decryptEnvelope: () => (/* binding */ decryptEnvelope),\n/* harmony export */   decryptMessage: () => (/* binding */ decryptMessage),\n/* harmony export */   decryptMessageDirect: () => (/* binding */ decryptMessageDirect),\n/* harmony export */   decryptObject: () => (/* binding */ decryptObject),\n/* harmony export */   decryptObjectDirect: () => (/* binding */ decryptObjectDirect),\n/* harmony export */   decryptSerializedEncryptionResult: () => (/* binding */ decryptSerializedEncryptionResult),\n/* harmony export */   decryptSerializedEncryptionResultDirect: () => (/* binding */ decryptSerializedEncryptionResultDirect),\n/* harmony export */   deriveAccountTransportEd25519Keypair: () => (/* binding */ deriveAccountTransportEd25519Keypair),\n/* harmony export */   deserializeEd25519PublicKeyB64: () => (/* binding */ deserializeEd25519PublicKeyB64),\n/* harmony export */   deserializeEd25519SignatureB64: () => (/* binding */ deserializeEd25519SignatureB64),\n/* harmony export */   deserializeEncryptionResult: () => (/* binding */ deserializeEncryptionResult),\n/* harmony export */   deserializePublicKeyB64: () => (/* binding */ deserializePublicKeyB64),\n/* harmony export */   deserializeSignatureB64: () => (/* binding */ deserializeSignatureB64),\n/* harmony export */   deserializeTransportEnvelope: () => (/* binding */ deserializeTransportEnvelope),\n/* harmony export */   ed25519KeypairFromSecret: () => (/* binding */ ed25519KeypairFromSecret),\n/* harmony export */   encodeBase64: () => (/* binding */ encodeBase64),\n/* harmony export */   encryptAndSignEnvelope: () => (/* binding */ encryptAndSignEnvelope),\n/* harmony export */   encryptMessage: () => (/* binding */ encryptMessage),\n/* harmony export */   encryptMessageDirect: () => (/* binding */ encryptMessageDirect),\n/* harmony export */   encryptObject: () => (/* binding */ encryptObject),\n/* harmony export */   encryptObjectDirect: () => (/* binding */ encryptObjectDirect),\n/* harmony export */   ensureMetadataFields: () => (/* binding */ ensureMetadataFields),\n/* harmony export */   ensurePrivatePublicFieldsDisjoint: () => (/* binding */ ensurePrivatePublicFieldsDisjoint),\n/* harmony export */   hashAndVerifySignature: () => (/* binding */ hashAndVerifySignature),\n/* harmony export */   keypairToEd25519: () => (/* binding */ keypairToEd25519),\n/* harmony export */   keypairToX25519: () => (/* binding */ keypairToX25519),\n/* harmony export */   makeEd25519SecretKeySignCallbackNoDomainSeparation: () => (/* binding */ makeEd25519SecretKeySignCallbackNoDomainSeparation),\n/* harmony export */   messageHash: () => (/* binding */ messageHash),\n/* harmony export */   publicKeyB64FromEd25519PublicKeyB64: () => (/* binding */ publicKeyB64FromEd25519PublicKeyB64),\n/* harmony export */   serializeEncryptionResult: () => (/* binding */ serializeEncryptionResult),\n/* harmony export */   serializePublicKeyB64: () => (/* binding */ serializePublicKeyB64),\n/* harmony export */   serializeSignatureB64: () => (/* binding */ serializeSignatureB64),\n/* harmony export */   signWithEd25519SecretKey: () => (/* binding */ signWithEd25519SecretKey),\n/* harmony export */   toKey: () => (/* binding */ toKey),\n/* harmony export */   verifyEnvelopeSignature: () => (/* binding */ verifyEnvelopeSignature),\n/* harmony export */   verifySignature: () => (/* binding */ verifySignature)\n/* harmony export */ });\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/../../../../node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var _noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @noble/hashes/sha3 */ \"(ssr)/../../../../node_modules/@noble/hashes/esm/sha3.js\");\n/* harmony import */ var tweetnacl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tweetnacl */ \"(ssr)/../../../../node_modules/tweetnacl/nacl-fast.js\");\n/* harmony import */ var ed2curve__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ed2curve */ \"(ssr)/../../../../node_modules/ed2curve/ed2curve.js\");\n/* harmony import */ var _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @aptos-connect/wallet-api */ \"(ssr)/../../../../node_modules/@aptos-connect/wallet-api/dist/index.mjs\");\n// src/encrDecr.ts\n\n\n\n\n\n// src/errors.ts\nvar EncryptionEnvelopeError = class extends Error {\n};\nvar EnvelopeMessageMismatchError = class _EnvelopeMessageMismatchError extends EncryptionEnvelopeError {\n  constructor(message, field) {\n    super(message);\n    this.field = field;\n    this.name = \"EnvelopeMessageMismatchError\";\n    Object.setPrototypeOf(this, _EnvelopeMessageMismatchError.prototype);\n  }\n};\nvar DecryptionError = class _DecryptionError extends EncryptionEnvelopeError {\n  constructor(message) {\n    super(message);\n    this.name = \"DecryptionError\";\n    Object.setPrototypeOf(this, _DecryptionError.prototype);\n  }\n};\n\n// src/utils.ts\n\nvar KeyTypes = /* @__PURE__ */ ((KeyTypes2) => {\n  KeyTypes2[\"Ed25519PublicKey\"] = \"Ed25519PublicKey\";\n  KeyTypes2[\"Ed25519SecretKey\"] = \"Ed25519SecretKey\";\n  KeyTypes2[\"X25519PublicKey\"] = \"X25519PublicKey\";\n  KeyTypes2[\"X25519SecretKey\"] = \"X25519SecretKey\";\n  return KeyTypes2;\n})(KeyTypes || {});\nfunction createX25519KeyPair() {\n  return keypairToX25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.keyPair());\n}\nfunction createEd25519KeyPair() {\n  return keypairToEd25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.keyPair());\n}\nfunction toKey(rawKey, type) {\n  return {\n    key: rawKey,\n    type\n  };\n}\nfunction keypairToEd25519(keyPair) {\n  return {\n    publicKey: toKey(keyPair.publicKey, \"Ed25519PublicKey\" /* Ed25519PublicKey */),\n    secretKey: toKey(keyPair.secretKey, \"Ed25519SecretKey\" /* Ed25519SecretKey */)\n  };\n}\nfunction keypairToX25519(keyPair) {\n  return {\n    publicKey: toKey(keyPair.publicKey, \"X25519PublicKey\" /* X25519PublicKey */),\n    secretKey: toKey(keyPair.secretKey, \"X25519SecretKey\" /* X25519SecretKey */)\n  };\n}\nfunction aptosAccountToEd25519Keypair(account) {\n  return ed25519KeypairFromSecret(account.signingKey.secretKey);\n}\nfunction ed25519KeypairFromSecret(ed25519SecretKeyBytes) {\n  return keypairToEd25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.keyPair.fromSeed(ed25519SecretKeyBytes.slice(0, 32)));\n}\nfunction decodeBase64(base64Str) {\n  if (globalThis.Buffer) {\n    return new Uint8Array(Buffer.from(base64Str, \"base64\"));\n  }\n  return Uint8Array.from(atob(base64Str), (m) => m.codePointAt(0));\n}\nfunction encodeBase64(bytes) {\n  if (globalThis.Buffer) {\n    return Buffer.from(bytes).toString(\"base64\");\n  }\n  return btoa(Array.from(bytes, (x) => String.fromCodePoint(x)).join(\"\"));\n}\nfunction concatUint8array(arrayOne, arrayTwo) {\n  const mergedArray = new Uint8Array(arrayOne.length + arrayTwo.length);\n  mergedArray.set(arrayOne);\n  mergedArray.set(arrayTwo, arrayOne.length);\n  return mergedArray;\n}\n\n// src/encrDecr.ts\nvar SIGNATURE_PREFIX = \"APTOS::IDENTITY_CONNECT\";\nfunction convertEd25519PublicKeyToX25519PublicKey(ed25519PublicKey, errorKeyName) {\n  const x25519PublicKey = ed2curve__WEBPACK_IMPORTED_MODULE_2__.convertPublicKey(ed25519PublicKey.key.slice(0, 32));\n  if (!x25519PublicKey)\n    throw new Error(`${errorKeyName} is not a valid Ed25519 public key`);\n  return toKey(x25519PublicKey, \"X25519PublicKey\" /* X25519PublicKey */);\n}\nfunction convertEd25519SecretKeyToX25519SecretKey(ed25519SecretKey) {\n  const x25519SecretKey = ed2curve__WEBPACK_IMPORTED_MODULE_2__.convertSecretKey(ed25519SecretKey.key.slice(0, 32));\n  return toKey(x25519SecretKey, \"X25519SecretKey\" /* X25519SecretKey */);\n}\nfunction serializeEncryptionResult(enc) {\n  return {\n    nonceB64: encodeBase64(enc.nonce),\n    securedB64: encodeBase64(enc.secured)\n  };\n}\nfunction deserializeEncryptionResult(enc) {\n  return {\n    nonce: decodeBase64(enc.nonceB64),\n    secured: decodeBase64(enc.securedB64)\n  };\n}\nfunction decryptSerializedEncryptionResult(senderX25519PublicKey, receiverEd25519SecretKey, enc) {\n  const des = deserializeEncryptionResult(enc);\n  return decryptObject(senderX25519PublicKey, receiverEd25519SecretKey, des.secured, des.nonce);\n}\nfunction decryptSerializedEncryptionResultDirect(senderX25519PublicKey, receiverX25519SecretKey, enc) {\n  const des = deserializeEncryptionResult(enc);\n  return decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, des.secured, des.nonce);\n}\nfunction encryptMessage(senderX25519SecretKey, receiverEd25519PublicKey, message) {\n  const receiverX25519PublicKey = convertEd25519PublicKeyToX25519PublicKey(\n    receiverEd25519PublicKey,\n    \"receiver public key\"\n  );\n  return encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, message);\n}\nfunction encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, message) {\n  const nonce = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.randomBytes(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.nonceLength);\n  const messageUint8 = new TextEncoder().encode(message);\n  const secured = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box(messageUint8, nonce, receiverX25519PublicKey.key, senderX25519SecretKey.key.slice(0, 32));\n  return { nonce, secured };\n}\nfunction encryptObject(senderX25519SecretKey, receiverEd25519PublicKey, message) {\n  const receiverX25519PublicKey = convertEd25519PublicKeyToX25519PublicKey(\n    receiverEd25519PublicKey,\n    \"receiver public key\"\n  );\n  return encryptObjectDirect(senderX25519SecretKey, receiverX25519PublicKey, message);\n}\nfunction encryptObjectDirect(senderX25519SecretKey, receiverX25519PublicKey, message) {\n  return encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, JSON.stringify(message));\n}\nfunction decryptMessage(senderX25519PublicKey, receiverEd25519SecretKey, securedMessage, nonce) {\n  const receiverX25519SecretKey = convertEd25519SecretKeyToX25519SecretKey(receiverEd25519SecretKey);\n  return decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n}\nfunction decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce) {\n  let decryptedUint8;\n  try {\n    decryptedUint8 = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.open(\n      securedMessage,\n      nonce,\n      senderX25519PublicKey.key.slice(0, 32),\n      receiverX25519SecretKey.key.slice(0, 32)\n    );\n  } catch (e) {\n    throw new DecryptionError(`Could not decrypt message: ${e.message}`);\n  }\n  if (!decryptedUint8)\n    throw new DecryptionError(\"Could not decrypt message\");\n  return new TextDecoder().decode(decryptedUint8);\n}\nfunction decryptObject(senderX25519PublicKey, receiverEd25519SecretKey, securedMessage, nonce) {\n  const receiverX25519SecretKey = convertEd25519SecretKeyToX25519SecretKey(receiverEd25519SecretKey);\n  return decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n}\nfunction decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce) {\n  const decryptedStr = decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n  return JSON.parse(decryptedStr);\n}\nfunction messageHash(message, purpose) {\n  const signaturePrefixHash = new Uint8Array((0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(`${SIGNATURE_PREFIX}::${purpose}::`));\n  return new Uint8Array((0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(concatUint8array(signaturePrefixHash, message)));\n}\nfunction signWithEd25519SecretKey(message, signingEd25519SecretKey, purpose) {\n  return tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.detached(messageHash(message, purpose), signingEd25519SecretKey.key);\n}\nfunction makeEd25519SecretKeySignCallbackNoDomainSeparation(signingEd25519SecretKey) {\n  return async (message) => new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.detached(message, signingEd25519SecretKey.key));\n}\nfunction verifySignature(message, signature, signingPublicKey, purpose) {\n  return signingPublicKey.verifySignature({ message: messageHash(message, purpose), signature });\n}\nfunction hashAndVerifySignature(message, signature, signingPublicKey, purpose) {\n  const messageUint8 = message instanceof Uint8Array ? message : new TextEncoder().encode(message);\n  const messageUint8Hash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(messageUint8);\n  return verifySignature(messageUint8Hash, signature, signingPublicKey, purpose);\n}\n\n// src/securedEnvelope.ts\n\n\nvar REQUIRED_FIELDS = [\n  \"receiverEd25519PublicKeyB64\",\n  \"senderEd25519PublicKeyB64\",\n  \"senderX25519PublicKeyB64\",\n  \"sequence\",\n  \"timestampMillis\"\n].sort();\nfunction ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage) {\n  const intersection = Object.keys(privateMessage).filter((x) => Object.keys(publicMessage).includes(x));\n  if (intersection.length > 0) {\n    const field = intersection[0];\n    throw new EnvelopeMessageMismatchError(`Field ${field} appears in both private and public message fields`, field);\n  }\n}\nfunction ensureMetadataFields(message) {\n  const messageKeys = Object.keys(message).sort();\n  const extraFields = messageKeys.filter((key) => !REQUIRED_FIELDS.includes(key));\n  const missingFields = REQUIRED_FIELDS.filter((key) => !messageKeys.includes(key));\n  if (extraFields.length > 0 || missingFields.length > 0) {\n    let extraFieldsStr = extraFields.length > 0 ? `extra(${extraFields.join(\", \")})` : \"\";\n    const missingFieldsStr = missingFields.length > 0 ? `missing(${missingFields.join(\", \")})` : \"\";\n    extraFieldsStr = extraFieldsStr.length > 0 && missingFieldsStr.length > 0 ? `${extraFieldsStr}, ` : extraFieldsStr;\n    throw new EnvelopeMessageMismatchError(\n      `PublicMessage metadata fields do not conform to spec: ${extraFieldsStr}${missingFieldsStr}`,\n      \"_metadata\"\n    );\n  }\n}\nfunction deserializeTransportEnvelope(transportEnvelope) {\n  const publicMessage = JSON.parse(transportEnvelope.serializedPublicMessage);\n  return {\n    ...transportEnvelope,\n    publicMessage\n  };\n}\nfunction encryptAndSignEnvelope(senderEd25519SecretKey, senderEd25519PublicKey, receiverEd25519PublicKey, sequence, publicMessage, privateMessage) {\n  const senderEphemeralX25519KeyPair = createX25519KeyPair();\n  const metadata = constructMetadata(\n    senderEd25519PublicKey,\n    receiverEd25519PublicKey,\n    sequence,\n    senderEphemeralX25519KeyPair.publicKey\n  );\n  ensureMetadataFields(metadata);\n  ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage);\n  return dangerouslyEncryptAndSignEnvelopeUnvalidated(\n    senderEd25519SecretKey,\n    receiverEd25519PublicKey,\n    metadata,\n    privateMessage,\n    publicMessage,\n    senderEphemeralX25519KeyPair\n  );\n}\nfunction constructMetadata(senderEd25519PublicKey, receiverEd25519PublicKey, sequence, senderEphemeralX25519PublicKey) {\n  return {\n    receiverEd25519PublicKeyB64: encodeBase64(receiverEd25519PublicKey.key),\n    senderEd25519PublicKeyB64: encodeBase64(senderEd25519PublicKey.key),\n    senderX25519PublicKeyB64: encodeBase64(senderEphemeralX25519PublicKey.key),\n    sequence,\n    timestampMillis: Date.now()\n  };\n}\nfunction dangerouslyEncryptAndSignEnvelopeUnvalidated(senderEd25519SecretKey, receiverEd25519PublicKey, metadata, privateMessage, publicMessage, senderEphemeralX25519KeyPair) {\n  const encryptionResult = encryptObject(\n    senderEphemeralX25519KeyPair.secretKey,\n    receiverEd25519PublicKey,\n    privateMessage\n  );\n  const encryptedPrivateMessage = serializeEncryptionResult(encryptionResult);\n  const encryptedPrivateMessageBytes = decodeBase64(encryptedPrivateMessage.securedB64);\n  const serializedPublicMessage = JSON.stringify({ ...publicMessage, _metadata: metadata });\n  const publicMessageBytes = new TextEncoder().encode(serializedPublicMessage);\n  const messageSignature = signEnvelope(publicMessageBytes, encryptedPrivateMessageBytes, senderEd25519SecretKey);\n  return {\n    encryptedPrivateMessage,\n    messageSignature,\n    serializedPublicMessage\n  };\n}\nfunction combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes) {\n  const publicMessageBytesHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(publicMessageBytes);\n  const privateMessageBytesHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(privateMessageBytes);\n  const combinedHash = new Uint8Array(publicMessageBytesHash.length + privateMessageBytesHash.length);\n  combinedHash.set(publicMessageBytesHash);\n  combinedHash.set(privateMessageBytesHash, publicMessageBytesHash.length);\n  return (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(combinedHash);\n}\nfunction signEnvelope(publicMessageBytes, privateMessageBytes, senderEd25519SecretKey) {\n  const messageHashBytes = combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes);\n  const signatureBytes = signWithEd25519SecretKey(messageHashBytes, senderEd25519SecretKey, \"SECURED_ENVELOPE\");\n  return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(signatureBytes).toString();\n}\nfunction verifyEnvelopeSignature(publicMessageBytes, privateMessageBytes, messageSignatureInput, senderEd25519PublicKey) {\n  const messageSignature = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(messageSignatureInput).toUint8Array());\n  const senderPublicKey = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey(senderEd25519PublicKey.key);\n  const messageHashBytes = combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes);\n  const messageVerified = verifySignature(messageHashBytes, messageSignature, senderPublicKey, \"SECURED_ENVELOPE\");\n  if (!messageVerified) {\n    throw new EnvelopeMessageMismatchError(\"Could not verify SecuredEnvelope signature\", \"messageSignature\");\n  }\n}\nfunction decryptEnvelope(senderEd25519PublicKey, receiverEd25519SecretKey, message) {\n  const { encryptedPrivateMessage, messageSignature, serializedPublicMessage } = message;\n  const publicMessage = JSON.parse(serializedPublicMessage);\n  const rawPrivateMessage = decodeBase64(encryptedPrivateMessage.securedB64);\n  const rawPublicMessage = new TextEncoder().encode(serializedPublicMessage);\n  verifyEnvelopeSignature(rawPublicMessage, rawPrivateMessage, messageSignature, senderEd25519PublicKey);\n  const senderEd25519PublicKeyB64 = encodeBase64(senderEd25519PublicKey.key);\n  const expectedPublicKeyB64 = publicMessage._metadata.senderEd25519PublicKeyB64;\n  if (senderEd25519PublicKeyB64 !== expectedPublicKeyB64) {\n    throw new EnvelopeMessageMismatchError(\n      \"senderEd25519PublicKey in envelope does not match provided receiverEd25519SecretKey\",\n      \"senderPublicKey\"\n    );\n  }\n  const senderX25519PublicKeyBytes = decodeBase64(publicMessage._metadata.senderX25519PublicKeyB64);\n  const senderX25519PublicKey = toKey(senderX25519PublicKeyBytes, \"X25519PublicKey\" /* X25519PublicKey */);\n  const encryptionResult = deserializeEncryptionResult(encryptedPrivateMessage);\n  const privateMessage = decryptObject(\n    senderX25519PublicKey,\n    receiverEd25519SecretKey,\n    encryptionResult.secured,\n    encryptionResult.nonce\n  );\n  ensureMetadataFields(publicMessage._metadata);\n  ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage);\n  return {\n    messageSignature,\n    privateMessage,\n    publicMessage\n  };\n}\n\n// src/serialization.ts\n\n\nfunction serializePublicKeyB64(publicKey) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.serializePublicKey)(serializer, publicKey);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.bytesToBase64)(serializer.toUint8Array());\n}\nfunction deserializePublicKeyB64(publicKeyB64) {\n  const serializedPublicKey = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.base64ToBytes)(publicKeyB64);\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedPublicKey);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.deserializePublicKey)(deserializer);\n}\nfunction deserializeEd25519PublicKeyB64(ed25519PublicKeyB64) {\n  return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey(decodeBase64(ed25519PublicKeyB64));\n}\nfunction serializeSignatureB64(signature) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.serializeSignature)(serializer, signature);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.bytesToBase64)(serializer.toUint8Array());\n}\nfunction deserializeSignatureB64(signatureB64) {\n  const serializedSignature = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.base64ToBytes)(signatureB64);\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedSignature);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.deserializeSignature)(deserializer);\n}\nfunction deserializeEd25519SignatureB64(ed25519SignatureB64) {\n  const signatureBytes = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(ed25519SignatureB64).toUint8Array();\n  return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(signatureBytes);\n}\nfunction publicKeyB64FromEd25519PublicKeyB64(ed25519PublicKeyB64) {\n  const publicKey = deserializeEd25519PublicKeyB64(ed25519PublicKeyB64);\n  return serializePublicKeyB64(publicKey);\n}\n\n// src/walletAccounts.ts\n\n\nvar AccountConnectionAction = /* @__PURE__ */ ((AccountConnectionAction2) => {\n  AccountConnectionAction2[\"ADD\"] = \"add\";\n  AccountConnectionAction2[\"REMOVE\"] = \"remove\";\n  return AccountConnectionAction2;\n})(AccountConnectionAction || {});\nfunction deriveAccountTransportEd25519Keypair(ed25519SecretKeyOrSignCallback, publicKey) {\n  const publicKeyBytes = publicKey instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.PublicKey ? publicKey.toUint8Array() : publicKey.key;\n  if (ed25519SecretKeyOrSignCallback instanceof Function) {\n    const seedGeneratorBytes = messageHash(publicKeyBytes, \"TRANSPORT_KEYPAIR\");\n    const signature = ed25519SecretKeyOrSignCallback(seedGeneratorBytes);\n    if (signature instanceof Promise) {\n      return signature.then((value) => ed25519KeypairFromSecret(value.toUint8Array()));\n    }\n    return ed25519KeypairFromSecret(signature.toUint8Array());\n  }\n  const seedBytes = signWithEd25519SecretKey(publicKeyBytes, ed25519SecretKeyOrSignCallback, \"TRANSPORT_KEYPAIR\");\n  return ed25519KeypairFromSecret(seedBytes);\n}\nfunction createSerializedAccountInfo(...[\n  signCallback,\n  publicKey,\n  transportEd25519PublicKey,\n  action,\n  intentId,\n  accountAddress\n]) {\n  const authKey = publicKey.authKey();\n  const finalAccountAddress = accountAddress || authKey.derivedAddress().toString();\n  const publicKeyB64 = serializePublicKeyB64(publicKey);\n  const accountInfo = {\n    accountAddress: finalAccountAddress,\n    action,\n    intentId,\n    publicKeyB64,\n    timestampMillis: Date.now(),\n    transportEd25519PublicKeyB64: encodeBase64(transportEd25519PublicKey.key)\n  };\n  const accountInfoSerialized = JSON.stringify(accountInfo);\n  const accountInfoBytes = new TextEncoder().encode(accountInfoSerialized);\n  const accountInfoHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(accountInfoBytes);\n  const signature = signCallback(messageHash(accountInfoHash, \"ACCOUNT_INFO\"));\n  if (signature instanceof Promise) {\n    return signature.then((value) => ({\n      accountInfoSerialized,\n      signatureB64: serializeSignatureB64(value)\n    }));\n  }\n  return {\n    accountInfoSerialized,\n    signatureB64: serializeSignatureB64(signature)\n  };\n}\nasync function aptosAccountToSerializedInfo(account, intentId) {\n  const signCallback = async (data) => account.sign(data);\n  const transportKey = await deriveAccountTransportEd25519Keypair(signCallback, account.publicKey);\n  return createSerializedAccountInfo(\n    signCallback,\n    account.publicKey,\n    transportKey.publicKey,\n    \"add\" /* ADD */,\n    intentId\n  );\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL0BpZGVudGl0eS1jb25uZWN0L2NyeXB0by9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ3NEO0FBQ1I7QUFDaEI7QUFDRTs7QUFFaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQzZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsZ0JBQWdCO0FBQ2pCO0FBQ0EseUJBQXlCLDBDQUFRO0FBQ2pDO0FBQ0E7QUFDQSwwQkFBMEIsMkNBQVM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiwyQ0FBUztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsc0RBQXlCO0FBQ25EO0FBQ0EsdUJBQXVCLGNBQWM7QUFDckM7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHNEQUF5QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0Isa0RBQWlCLENBQUMsMENB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OEMseURBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw0REFBUztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF3REU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Zyb250ZW5kLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9AaWRlbnRpdHktY29ubmVjdC9jcnlwdG8vZGlzdC9pbmRleC5tanM/OWNlNyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvZW5jckRlY3IudHNcbmltcG9ydCB7IEVkMjU1MTlTaWduYXR1cmUgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQgeyBzaGEzXzI1NiB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3NoYTNcIjtcbmltcG9ydCBuYWNsMiBmcm9tIFwidHdlZXRuYWNsXCI7XG5pbXBvcnQgZWQyY3VydmUgZnJvbSBcImVkMmN1cnZlXCI7XG5cbi8vIHNyYy9lcnJvcnMudHNcbnZhciBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xufTtcbnZhciBFbnZlbG9wZU1lc3NhZ2VNaXNtYXRjaEVycm9yID0gY2xhc3MgX0VudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IgZXh0ZW5kcyBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIGZpZWxkKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5maWVsZCA9IGZpZWxkO1xuICAgIHRoaXMubmFtZSA9IFwiRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvci5wcm90b3R5cGUpO1xuICB9XG59O1xudmFyIERlY3J5cHRpb25FcnJvciA9IGNsYXNzIF9EZWNyeXB0aW9uRXJyb3IgZXh0ZW5kcyBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIkRlY3J5cHRpb25FcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfRGVjcnlwdGlvbkVycm9yLnByb3RvdHlwZSk7XG4gIH1cbn07XG5cbi8vIHNyYy91dGlscy50c1xuaW1wb3J0IG5hY2wgZnJvbSBcInR3ZWV0bmFjbFwiO1xudmFyIEtleVR5cGVzID0gLyogQF9fUFVSRV9fICovICgoS2V5VHlwZXMyKSA9PiB7XG4gIEtleVR5cGVzMltcIkVkMjU1MTlQdWJsaWNLZXlcIl0gPSBcIkVkMjU1MTlQdWJsaWNLZXlcIjtcbiAgS2V5VHlwZXMyW1wiRWQyNTUxOVNlY3JldEtleVwiXSA9IFwiRWQyNTUxOVNlY3JldEtleVwiO1xuICBLZXlUeXBlczJbXCJYMjU1MTlQdWJsaWNLZXlcIl0gPSBcIlgyNTUxOVB1YmxpY0tleVwiO1xuICBLZXlUeXBlczJbXCJYMjU1MTlTZWNyZXRLZXlcIl0gPSBcIlgyNTUxOVNlY3JldEtleVwiO1xuICByZXR1cm4gS2V5VHlwZXMyO1xufSkoS2V5VHlwZXMgfHwge30pO1xuZnVuY3Rpb24gY3JlYXRlWDI1NTE5S2V5UGFpcigpIHtcbiAgcmV0dXJuIGtleXBhaXJUb1gyNTUxOShuYWNsLmJveC5rZXlQYWlyKCkpO1xufVxuZnVuY3Rpb24gY3JlYXRlRWQyNTUxOUtleVBhaXIoKSB7XG4gIHJldHVybiBrZXlwYWlyVG9FZDI1NTE5KG5hY2wuc2lnbi5rZXlQYWlyKCkpO1xufVxuZnVuY3Rpb24gdG9LZXkocmF3S2V5LCB0eXBlKSB7XG4gIHJldHVybiB7XG4gICAga2V5OiByYXdLZXksXG4gICAgdHlwZVxuICB9O1xufVxuZnVuY3Rpb24ga2V5cGFpclRvRWQyNTUxOShrZXlQYWlyKSB7XG4gIHJldHVybiB7XG4gICAgcHVibGljS2V5OiB0b0tleShrZXlQYWlyLnB1YmxpY0tleSwgXCJFZDI1NTE5UHVibGljS2V5XCIgLyogRWQyNTUxOVB1YmxpY0tleSAqLyksXG4gICAgc2VjcmV0S2V5OiB0b0tleShrZXlQYWlyLnNlY3JldEtleSwgXCJFZDI1NTE5U2VjcmV0S2V5XCIgLyogRWQyNTUxOVNlY3JldEtleSAqLylcbiAgfTtcbn1cbmZ1bmN0aW9uIGtleXBhaXJUb1gyNTUxOShrZXlQYWlyKSB7XG4gIHJldHVybiB7XG4gICAgcHVibGljS2V5OiB0b0tleShrZXlQYWlyLnB1YmxpY0tleSwgXCJYMjU1MTlQdWJsaWNLZXlcIiAvKiBYMjU1MTlQdWJsaWNLZXkgKi8pLFxuICAgIHNlY3JldEtleTogdG9LZXkoa2V5UGFpci5zZWNyZXRLZXksIFwiWDI1NTE5U2VjcmV0S2V5XCIgLyogWDI1NTE5U2VjcmV0S2V5ICovKVxuICB9O1xufVxuZnVuY3Rpb24gYXB0b3NBY2NvdW50VG9FZDI1NTE5S2V5cGFpcihhY2NvdW50KSB7XG4gIHJldHVybiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQoYWNjb3VudC5zaWduaW5nS2V5LnNlY3JldEtleSk7XG59XG5mdW5jdGlvbiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQoZWQyNTUxOVNlY3JldEtleUJ5dGVzKSB7XG4gIHJldHVybiBrZXlwYWlyVG9FZDI1NTE5KG5hY2wuc2lnbi5rZXlQYWlyLmZyb21TZWVkKGVkMjU1MTlTZWNyZXRLZXlCeXRlcy5zbGljZSgwLCAzMikpKTtcbn1cbmZ1bmN0aW9uIGRlY29kZUJhc2U2NChiYXNlNjRTdHIpIHtcbiAgaWYgKGdsb2JhbFRoaXMuQnVmZmVyKSB7XG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KEJ1ZmZlci5mcm9tKGJhc2U2NFN0ciwgXCJiYXNlNjRcIikpO1xuICB9XG4gIHJldHVybiBVaW50OEFycmF5LmZyb20oYXRvYihiYXNlNjRTdHIpLCAobSkgPT4gbS5jb2RlUG9pbnRBdCgwKSk7XG59XG5mdW5jdGlvbiBlbmNvZGVCYXNlNjQoYnl0ZXMpIHtcbiAgaWYgKGdsb2JhbFRoaXMuQnVmZmVyKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5mcm9tKGJ5dGVzKS50b1N0cmluZyhcImJhc2U2NFwiKTtcbiAgfVxuICByZXR1cm4gYnRvYShBcnJheS5mcm9tKGJ5dGVzLCAoeCkgPT4gU3RyaW5nLmZyb21Db2RlUG9pbnQoeCkpLmpvaW4oXCJcIikpO1xufVxuZnVuY3Rpb24gY29uY2F0VWludDhhcnJheShhcnJheU9uZSwgYXJyYXlUd28pIHtcbiAgY29uc3QgbWVyZ2VkQXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheU9uZS5sZW5ndGggKyBhcnJheVR3by5sZW5ndGgpO1xuICBtZXJnZWRBcnJheS5zZXQoYXJyYXlPbmUpO1xuICBtZXJnZWRBcnJheS5zZXQoYXJyYXlUd28sIGFycmF5T25lLmxlbmd0aCk7XG4gIHJldHVybiBtZXJnZWRBcnJheTtcbn1cblxuLy8gc3JjL2VuY3JEZWNyLnRzXG52YXIgU0lHTkFUVVJFX1BSRUZJWCA9IFwiQVBUT1M6OklERU5USVRZX0NPTk5FQ1RcIjtcbmZ1bmN0aW9uIGNvbnZlcnRFZDI1NTE5UHVibGljS2V5VG9YMjU1MTlQdWJsaWNLZXkoZWQyNTUxOVB1YmxpY0tleSwgZXJyb3JLZXlOYW1lKSB7XG4gIGNvbnN0IHgyNTUxOVB1YmxpY0tleSA9IGVkMmN1cnZlLmNvbnZlcnRQdWJsaWNLZXkoZWQyNTUxOVB1YmxpY0tleS5rZXkuc2xpY2UoMCwgMzIpKTtcbiAgaWYgKCF4MjU1MTlQdWJsaWNLZXkpXG4gICAgdGhyb3cgbmV3IEVycm9yKGAke2Vycm9yS2V5TmFtZX0gaXMgbm90IGEgdmFsaWQgRWQyNTUxOSBwdWJsaWMga2V5YCk7XG4gIHJldHVybiB0b0tleSh4MjU1MTlQdWJsaWNLZXksIFwiWDI1NTE5UHVibGljS2V5XCIgLyogWDI1NTE5UHVibGljS2V5ICovKTtcbn1cbmZ1bmN0aW9uIGNvbnZlcnRFZDI1NTE5U2VjcmV0S2V5VG9YMjU1MTlTZWNyZXRLZXkoZWQyNTUxOVNlY3JldEtleSkge1xuICBjb25zdCB4MjU1MTlTZWNyZXRLZXkgPSBlZDJjdXJ2ZS5jb252ZXJ0U2VjcmV0S2V5KGVkMjU1MTlTZWNyZXRLZXkua2V5LnNsaWNlKDAsIDMyKSk7XG4gIHJldHVybiB0b0tleSh4MjU1MTlTZWNyZXRLZXksIFwiWDI1NTE5U2VjcmV0S2V5XCIgLyogWDI1NTE5U2VjcmV0S2V5ICovKTtcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQoZW5jKSB7XG4gIHJldHVybiB7XG4gICAgbm9uY2VCNjQ6IGVuY29kZUJhc2U2NChlbmMubm9uY2UpLFxuICAgIHNlY3VyZWRCNjQ6IGVuY29kZUJhc2U2NChlbmMuc2VjdXJlZClcbiAgfTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplRW5jcnlwdGlvblJlc3VsdChlbmMpIHtcbiAgcmV0dXJuIHtcbiAgICBub25jZTogZGVjb2RlQmFzZTY0KGVuYy5ub25jZUI2NCksXG4gICAgc2VjdXJlZDogZGVjb2RlQmFzZTY0KGVuYy5zZWN1cmVkQjY0KVxuICB9O1xufVxuZnVuY3Rpb24gZGVjcnlwdFNlcmlhbGl6ZWRFbmNyeXB0aW9uUmVzdWx0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBlbmMpIHtcbiAgY29uc3QgZGVzID0gZGVzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuYyk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBkZXMuc2VjdXJlZCwgZGVzLm5vbmNlKTtcbn1cbmZ1bmN0aW9uIGRlY3J5cHRTZXJpYWxpemVkRW5jcnlwdGlvblJlc3VsdERpcmVjdChzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LCBlbmMpIHtcbiAgY29uc3QgZGVzID0gZGVzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuYyk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIGRlcy5zZWN1cmVkLCBkZXMubm9uY2UpO1xufVxuZnVuY3Rpb24gZW5jcnlwdE1lc3NhZ2Uoc2VuZGVyWDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksIG1lc3NhZ2UpIHtcbiAgY29uc3QgcmVjZWl2ZXJYMjU1MTlQdWJsaWNLZXkgPSBjb252ZXJ0RWQyNTUxOVB1YmxpY0tleVRvWDI1NTE5UHVibGljS2V5KFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBcInJlY2VpdmVyIHB1YmxpYyBrZXlcIlxuICApO1xuICByZXR1cm4gZW5jcnlwdE1lc3NhZ2VEaXJlY3Qoc2VuZGVyWDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlclgyNTUxOVB1YmxpY0tleSwgbWVzc2FnZSk7XG59XG5mdW5jdGlvbiBlbmNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBtZXNzYWdlKSB7XG4gIGNvbnN0IG5vbmNlID0gbmFjbDIucmFuZG9tQnl0ZXMobmFjbDIuYm94Lm5vbmNlTGVuZ3RoKTtcbiAgY29uc3QgbWVzc2FnZVVpbnQ4ID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKG1lc3NhZ2UpO1xuICBjb25zdCBzZWN1cmVkID0gbmFjbDIuYm94KG1lc3NhZ2VVaW50OCwgbm9uY2UsIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LmtleSwgc2VuZGVyWDI1NTE5U2VjcmV0S2V5LmtleS5zbGljZSgwLCAzMikpO1xuICByZXR1cm4geyBub25jZSwgc2VjdXJlZCB9O1xufVxuZnVuY3Rpb24gZW5jcnlwdE9iamVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSwgbWVzc2FnZSkge1xuICBjb25zdCByZWNlaXZlclgyNTUxOVB1YmxpY0tleSA9IGNvbnZlcnRFZDI1NTE5UHVibGljS2V5VG9YMjU1MTlQdWJsaWNLZXkoXG4gICAgcmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5LFxuICAgIFwicmVjZWl2ZXIgcHVibGljIGtleVwiXG4gICk7XG4gIHJldHVybiBlbmNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVNlY3JldEtleSwgcmVjZWl2ZXJYMjU1MTlQdWJsaWNLZXksIG1lc3NhZ2UpO1xufVxuZnVuY3Rpb24gZW5jcnlwdE9iamVjdERpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBtZXNzYWdlKSB7XG4gIHJldHVybiBlbmNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBKU09OLnN0cmluZ2lmeShtZXNzYWdlKSk7XG59XG5mdW5jdGlvbiBkZWNyeXB0TWVzc2FnZShzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSwgc2VjdXJlZE1lc3NhZ2UsIG5vbmNlKSB7XG4gIGNvbnN0IHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5ID0gY29udmVydEVkMjU1MTlTZWNyZXRLZXlUb1gyNTUxOVNlY3JldEtleShyZWNlaXZlckVkMjU1MTlTZWNyZXRLZXkpO1xuICByZXR1cm4gZGVjcnlwdE1lc3NhZ2VEaXJlY3Qoc2VuZGVyWDI1NTE5UHVibGljS2V5LCByZWNlaXZlclgyNTUxOVNlY3JldEtleSwgc2VjdXJlZE1lc3NhZ2UsIG5vbmNlKTtcbn1cbmZ1bmN0aW9uIGRlY3J5cHRNZXNzYWdlRGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSkge1xuICBsZXQgZGVjcnlwdGVkVWludDg7XG4gIHRyeSB7XG4gICAgZGVjcnlwdGVkVWludDggPSBuYWNsMi5ib3gub3BlbihcbiAgICAgIHNlY3VyZWRNZXNzYWdlLFxuICAgICAgbm9uY2UsXG4gICAgICBzZW5kZXJYMjU1MTlQdWJsaWNLZXkua2V5LnNsaWNlKDAsIDMyKSxcbiAgICAgIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LmtleS5zbGljZSgwLCAzMilcbiAgICApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IERlY3J5cHRpb25FcnJvcihgQ291bGQgbm90IGRlY3J5cHQgbWVzc2FnZTogJHtlLm1lc3NhZ2V9YCk7XG4gIH1cbiAgaWYgKCFkZWNyeXB0ZWRVaW50OClcbiAgICB0aHJvdyBuZXcgRGVjcnlwdGlvbkVycm9yKFwiQ291bGQgbm90IGRlY3J5cHQgbWVzc2FnZVwiKTtcbiAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShkZWNyeXB0ZWRVaW50OCk7XG59XG5mdW5jdGlvbiBkZWNyeXB0T2JqZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBzZWN1cmVkTWVzc2FnZSwgbm9uY2UpIHtcbiAgY29uc3QgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXkgPSBjb252ZXJ0RWQyNTUxOVNlY3JldEtleVRvWDI1NTE5U2VjcmV0S2V5KHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSk7XG59XG5mdW5jdGlvbiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSkge1xuICBjb25zdCBkZWNyeXB0ZWRTdHIgPSBkZWNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LCBzZWN1cmVkTWVzc2FnZSwgbm9uY2UpO1xuICByZXR1cm4gSlNPTi5wYXJzZShkZWNyeXB0ZWRTdHIpO1xufVxuZnVuY3Rpb24gbWVzc2FnZUhhc2gobWVzc2FnZSwgcHVycG9zZSkge1xuICBjb25zdCBzaWduYXR1cmVQcmVmaXhIYXNoID0gbmV3IFVpbnQ4QXJyYXkoc2hhM18yNTYoYCR7U0lHTkFUVVJFX1BSRUZJWH06OiR7cHVycG9zZX06OmApKTtcbiAgcmV0dXJuIG5ldyBVaW50OEFycmF5KHNoYTNfMjU2KGNvbmNhdFVpbnQ4YXJyYXkoc2lnbmF0dXJlUHJlZml4SGFzaCwgbWVzc2FnZSkpKTtcbn1cbmZ1bmN0aW9uIHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShtZXNzYWdlLCBzaWduaW5nRWQyNTUxOVNlY3JldEtleSwgcHVycG9zZSkge1xuICByZXR1cm4gbmFjbDIuc2lnbi5kZXRhY2hlZChtZXNzYWdlSGFzaChtZXNzYWdlLCBwdXJwb3NlKSwgc2lnbmluZ0VkMjU1MTlTZWNyZXRLZXkua2V5KTtcbn1cbmZ1bmN0aW9uIG1ha2VFZDI1NTE5U2VjcmV0S2V5U2lnbkNhbGxiYWNrTm9Eb21haW5TZXBhcmF0aW9uKHNpZ25pbmdFZDI1NTE5U2VjcmV0S2V5KSB7XG4gIHJldHVybiBhc3luYyAobWVzc2FnZSkgPT4gbmV3IEVkMjU1MTlTaWduYXR1cmUobmFjbDIuc2lnbi5kZXRhY2hlZChtZXNzYWdlLCBzaWduaW5nRWQyNTUxOVNlY3JldEtleS5rZXkpKTtcbn1cbmZ1bmN0aW9uIHZlcmlmeVNpZ25hdHVyZShtZXNzYWdlLCBzaWduYXR1cmUsIHNpZ25pbmdQdWJsaWNLZXksIHB1cnBvc2UpIHtcbiAgcmV0dXJuIHNpZ25pbmdQdWJsaWNLZXkudmVyaWZ5U2lnbmF0dXJlKHsgbWVzc2FnZTogbWVzc2FnZUhhc2gobWVzc2FnZSwgcHVycG9zZSksIHNpZ25hdHVyZSB9KTtcbn1cbmZ1bmN0aW9uIGhhc2hBbmRWZXJpZnlTaWduYXR1cmUobWVzc2FnZSwgc2lnbmF0dXJlLCBzaWduaW5nUHVibGljS2V5LCBwdXJwb3NlKSB7XG4gIGNvbnN0IG1lc3NhZ2VVaW50OCA9IG1lc3NhZ2UgaW5zdGFuY2VvZiBVaW50OEFycmF5ID8gbWVzc2FnZSA6IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShtZXNzYWdlKTtcbiAgY29uc3QgbWVzc2FnZVVpbnQ4SGFzaCA9IHNoYTNfMjU2KG1lc3NhZ2VVaW50OCk7XG4gIHJldHVybiB2ZXJpZnlTaWduYXR1cmUobWVzc2FnZVVpbnQ4SGFzaCwgc2lnbmF0dXJlLCBzaWduaW5nUHVibGljS2V5LCBwdXJwb3NlKTtcbn1cblxuLy8gc3JjL3NlY3VyZWRFbnZlbG9wZS50c1xuaW1wb3J0IHsgRWQyNTUxOVB1YmxpY0tleSBhcyBBcHRvc0VkMjU1MTlQdWJsaWNLZXksIEVkMjU1MTlTaWduYXR1cmUgYXMgRWQyNTUxOVNpZ25hdHVyZTIsIEhleCB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmltcG9ydCB7IHNoYTNfMjU2IGFzIHNoYTNfMjU2MiB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3NoYTNcIjtcbnZhciBSRVFVSVJFRF9GSUVMRFMgPSBbXG4gIFwicmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5QjY0XCIsXG4gIFwic2VuZGVyRWQyNTUxOVB1YmxpY0tleUI2NFwiLFxuICBcInNlbmRlclgyNTUxOVB1YmxpY0tleUI2NFwiLFxuICBcInNlcXVlbmNlXCIsXG4gIFwidGltZXN0YW1wTWlsbGlzXCJcbl0uc29ydCgpO1xuZnVuY3Rpb24gZW5zdXJlUHJpdmF0ZVB1YmxpY0ZpZWxkc0Rpc2pvaW50KHByaXZhdGVNZXNzYWdlLCBwdWJsaWNNZXNzYWdlKSB7XG4gIGNvbnN0IGludGVyc2VjdGlvbiA9IE9iamVjdC5rZXlzKHByaXZhdGVNZXNzYWdlKS5maWx0ZXIoKHgpID0+IE9iamVjdC5rZXlzKHB1YmxpY01lc3NhZ2UpLmluY2x1ZGVzKHgpKTtcbiAgaWYgKGludGVyc2VjdGlvbi5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgZmllbGQgPSBpbnRlcnNlY3Rpb25bMF07XG4gICAgdGhyb3cgbmV3IEVudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IoYEZpZWxkICR7ZmllbGR9IGFwcGVhcnMgaW4gYm90aCBwcml2YXRlIGFuZCBwdWJsaWMgbWVzc2FnZSBmaWVsZHNgLCBmaWVsZCk7XG4gIH1cbn1cbmZ1bmN0aW9uIGVuc3VyZU1ldGFkYXRhRmllbGRzKG1lc3NhZ2UpIHtcbiAgY29uc3QgbWVzc2FnZUtleXMgPSBPYmplY3Qua2V5cyhtZXNzYWdlKS5zb3J0KCk7XG4gIGNvbnN0IGV4dHJhRmllbGRzID0gbWVzc2FnZUtleXMuZmlsdGVyKChrZXkpID0+ICFSRVFVSVJFRF9GSUVMRFMuaW5jbHVkZXMoa2V5KSk7XG4gIGNvbnN0IG1pc3NpbmdGaWVsZHMgPSBSRVFVSVJFRF9GSUVMRFMuZmlsdGVyKChrZXkpID0+ICFtZXNzYWdlS2V5cy5pbmNsdWRlcyhrZXkpKTtcbiAgaWYgKGV4dHJhRmllbGRzLmxlbmd0aCA+IDAgfHwgbWlzc2luZ0ZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgbGV0IGV4dHJhRmllbGRzU3RyID0gZXh0cmFGaWVsZHMubGVuZ3RoID4gMCA/IGBleHRyYSgke2V4dHJhRmllbGRzLmpvaW4oXCIsIFwiKX0pYCA6IFwiXCI7XG4gICAgY29uc3QgbWlzc2luZ0ZpZWxkc1N0ciA9IG1pc3NpbmdGaWVsZHMubGVuZ3RoID4gMCA/IGBtaXNzaW5nKCR7bWlzc2luZ0ZpZWxkcy5qb2luKFwiLCBcIil9KWAgOiBcIlwiO1xuICAgIGV4dHJhRmllbGRzU3RyID0gZXh0cmFGaWVsZHNTdHIubGVuZ3RoID4gMCAmJiBtaXNzaW5nRmllbGRzU3RyLmxlbmd0aCA+IDAgPyBgJHtleHRyYUZpZWxkc1N0cn0sIGAgOiBleHRyYUZpZWxkc1N0cjtcbiAgICB0aHJvdyBuZXcgRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvcihcbiAgICAgIGBQdWJsaWNNZXNzYWdlIG1ldGFkYXRhIGZpZWxkcyBkbyBub3QgY29uZm9ybSB0byBzcGVjOiAke2V4dHJhRmllbGRzU3RyfSR7bWlzc2luZ0ZpZWxkc1N0cn1gLFxuICAgICAgXCJfbWV0YWRhdGFcIlxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplVHJhbnNwb3J0RW52ZWxvcGUodHJhbnNwb3J0RW52ZWxvcGUpIHtcbiAgY29uc3QgcHVibGljTWVzc2FnZSA9IEpTT04ucGFyc2UodHJhbnNwb3J0RW52ZWxvcGUuc2VyaWFsaXplZFB1YmxpY01lc3NhZ2UpO1xuICByZXR1cm4ge1xuICAgIC4uLnRyYW5zcG9ydEVudmVsb3BlLFxuICAgIHB1YmxpY01lc3NhZ2VcbiAgfTtcbn1cbmZ1bmN0aW9uIGVuY3J5cHRBbmRTaWduRW52ZWxvcGUoc2VuZGVyRWQyNTUxOVNlY3JldEtleSwgc2VuZGVyRWQyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5LCBzZXF1ZW5jZSwgcHVibGljTWVzc2FnZSwgcHJpdmF0ZU1lc3NhZ2UpIHtcbiAgY29uc3Qgc2VuZGVyRXBoZW1lcmFsWDI1NTE5S2V5UGFpciA9IGNyZWF0ZVgyNTUxOUtleVBhaXIoKTtcbiAgY29uc3QgbWV0YWRhdGEgPSBjb25zdHJ1Y3RNZXRhZGF0YShcbiAgICBzZW5kZXJFZDI1NTE5UHVibGljS2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBzZXF1ZW5jZSxcbiAgICBzZW5kZXJFcGhlbWVyYWxYMjU1MTlLZXlQYWlyLnB1YmxpY0tleVxuICApO1xuICBlbnN1cmVNZXRhZGF0YUZpZWxkcyhtZXRhZGF0YSk7XG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludChwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSk7XG4gIHJldHVybiBkYW5nZXJvdXNseUVuY3J5cHRBbmRTaWduRW52ZWxvcGVVbnZhbGlkYXRlZChcbiAgICBzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBtZXRhZGF0YSxcbiAgICBwcml2YXRlTWVzc2FnZSxcbiAgICBwdWJsaWNNZXNzYWdlLFxuICAgIHNlbmRlckVwaGVtZXJhbFgyNTUxOUtleVBhaXJcbiAgKTtcbn1cbmZ1bmN0aW9uIGNvbnN0cnVjdE1ldGFkYXRhKHNlbmRlckVkMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSwgc2VxdWVuY2UsIHNlbmRlckVwaGVtZXJhbFgyNTUxOVB1YmxpY0tleSkge1xuICByZXR1cm4ge1xuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleUI2NDogZW5jb2RlQmFzZTY0KHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleS5rZXkpLFxuICAgIHNlbmRlckVkMjU1MTlQdWJsaWNLZXlCNjQ6IGVuY29kZUJhc2U2NChzZW5kZXJFZDI1NTE5UHVibGljS2V5LmtleSksXG4gICAgc2VuZGVyWDI1NTE5UHVibGljS2V5QjY0OiBlbmNvZGVCYXNlNjQoc2VuZGVyRXBoZW1lcmFsWDI1NTE5UHVibGljS2V5LmtleSksXG4gICAgc2VxdWVuY2UsXG4gICAgdGltZXN0YW1wTWlsbGlzOiBEYXRlLm5vdygpXG4gIH07XG59XG5mdW5jdGlvbiBkYW5nZXJvdXNseUVuY3J5cHRBbmRTaWduRW52ZWxvcGVVbnZhbGlkYXRlZChzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksIG1ldGFkYXRhLCBwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSwgc2VuZGVyRXBoZW1lcmFsWDI1NTE5S2V5UGFpcikge1xuICBjb25zdCBlbmNyeXB0aW9uUmVzdWx0ID0gZW5jcnlwdE9iamVjdChcbiAgICBzZW5kZXJFcGhlbWVyYWxYMjU1MTlLZXlQYWlyLnNlY3JldEtleSxcbiAgICByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksXG4gICAgcHJpdmF0ZU1lc3NhZ2VcbiAgKTtcbiAgY29uc3QgZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UgPSBzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuY3J5cHRpb25SZXN1bHQpO1xuICBjb25zdCBlbmNyeXB0ZWRQcml2YXRlTWVzc2FnZUJ5dGVzID0gZGVjb2RlQmFzZTY0KGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLnNlY3VyZWRCNjQpO1xuICBjb25zdCBzZXJpYWxpemVkUHVibGljTWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KHsgLi4ucHVibGljTWVzc2FnZSwgX21ldGFkYXRhOiBtZXRhZGF0YSB9KTtcbiAgY29uc3QgcHVibGljTWVzc2FnZUJ5dGVzID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlKTtcbiAgY29uc3QgbWVzc2FnZVNpZ25hdHVyZSA9IHNpZ25FbnZlbG9wZShwdWJsaWNNZXNzYWdlQnl0ZXMsIGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlQnl0ZXMsIHNlbmRlckVkMjU1MTlTZWNyZXRLZXkpO1xuICByZXR1cm4ge1xuICAgIGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLFxuICAgIG1lc3NhZ2VTaWduYXR1cmUsXG4gICAgc2VyaWFsaXplZFB1YmxpY01lc3NhZ2VcbiAgfTtcbn1cbmZ1bmN0aW9uIGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpIHtcbiAgY29uc3QgcHVibGljTWVzc2FnZUJ5dGVzSGFzaCA9IHNoYTNfMjU2MihwdWJsaWNNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBwcml2YXRlTWVzc2FnZUJ5dGVzSGFzaCA9IHNoYTNfMjU2Mihwcml2YXRlTWVzc2FnZUJ5dGVzKTtcbiAgY29uc3QgY29tYmluZWRIYXNoID0gbmV3IFVpbnQ4QXJyYXkocHVibGljTWVzc2FnZUJ5dGVzSGFzaC5sZW5ndGggKyBwcml2YXRlTWVzc2FnZUJ5dGVzSGFzaC5sZW5ndGgpO1xuICBjb21iaW5lZEhhc2guc2V0KHB1YmxpY01lc3NhZ2VCeXRlc0hhc2gpO1xuICBjb21iaW5lZEhhc2guc2V0KHByaXZhdGVNZXNzYWdlQnl0ZXNIYXNoLCBwdWJsaWNNZXNzYWdlQnl0ZXNIYXNoLmxlbmd0aCk7XG4gIHJldHVybiBzaGEzXzI1NjIoY29tYmluZWRIYXNoKTtcbn1cbmZ1bmN0aW9uIHNpZ25FbnZlbG9wZShwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMsIHNlbmRlckVkMjU1MTlTZWNyZXRLZXkpIHtcbiAgY29uc3QgbWVzc2FnZUhhc2hCeXRlcyA9IGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBzaWduYXR1cmVCeXRlcyA9IHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShtZXNzYWdlSGFzaEJ5dGVzLCBzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LCBcIlNFQ1VSRURfRU5WRUxPUEVcIik7XG4gIHJldHVybiBIZXguZnJvbUhleElucHV0KHNpZ25hdHVyZUJ5dGVzKS50b1N0cmluZygpO1xufVxuZnVuY3Rpb24gdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUocHVibGljTWVzc2FnZUJ5dGVzLCBwcml2YXRlTWVzc2FnZUJ5dGVzLCBtZXNzYWdlU2lnbmF0dXJlSW5wdXQsIHNlbmRlckVkMjU1MTlQdWJsaWNLZXkpIHtcbiAgY29uc3QgbWVzc2FnZVNpZ25hdHVyZSA9IG5ldyBFZDI1NTE5U2lnbmF0dXJlMihIZXguZnJvbUhleElucHV0KG1lc3NhZ2VTaWduYXR1cmVJbnB1dCkudG9VaW50OEFycmF5KCkpO1xuICBjb25zdCBzZW5kZXJQdWJsaWNLZXkgPSBuZXcgQXB0b3NFZDI1NTE5UHVibGljS2V5KHNlbmRlckVkMjU1MTlQdWJsaWNLZXkua2V5KTtcbiAgY29uc3QgbWVzc2FnZUhhc2hCeXRlcyA9IGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBtZXNzYWdlVmVyaWZpZWQgPSB2ZXJpZnlTaWduYXR1cmUobWVzc2FnZUhhc2hCeXRlcywgbWVzc2FnZVNpZ25hdHVyZSwgc2VuZGVyUHVibGljS2V5LCBcIlNFQ1VSRURfRU5WRUxPUEVcIik7XG4gIGlmICghbWVzc2FnZVZlcmlmaWVkKSB7XG4gICAgdGhyb3cgbmV3IEVudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IoXCJDb3VsZCBub3QgdmVyaWZ5IFNlY3VyZWRFbnZlbG9wZSBzaWduYXR1cmVcIiwgXCJtZXNzYWdlU2lnbmF0dXJlXCIpO1xuICB9XG59XG5mdW5jdGlvbiBkZWNyeXB0RW52ZWxvcGUoc2VuZGVyRWQyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBtZXNzYWdlKSB7XG4gIGNvbnN0IHsgZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UsIG1lc3NhZ2VTaWduYXR1cmUsIHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlIH0gPSBtZXNzYWdlO1xuICBjb25zdCBwdWJsaWNNZXNzYWdlID0gSlNPTi5wYXJzZShzZXJpYWxpemVkUHVibGljTWVzc2FnZSk7XG4gIGNvbnN0IHJhd1ByaXZhdGVNZXNzYWdlID0gZGVjb2RlQmFzZTY0KGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLnNlY3VyZWRCNjQpO1xuICBjb25zdCByYXdQdWJsaWNNZXNzYWdlID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlKTtcbiAgdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUocmF3UHVibGljTWVzc2FnZSwgcmF3UHJpdmF0ZU1lc3NhZ2UsIG1lc3NhZ2VTaWduYXR1cmUsIHNlbmRlckVkMjU1MTlQdWJsaWNLZXkpO1xuICBjb25zdCBzZW5kZXJFZDI1NTE5UHVibGljS2V5QjY0ID0gZW5jb2RlQmFzZTY0KHNlbmRlckVkMjU1MTlQdWJsaWNLZXkua2V5KTtcbiAgY29uc3QgZXhwZWN0ZWRQdWJsaWNLZXlCNjQgPSBwdWJsaWNNZXNzYWdlLl9tZXRhZGF0YS5zZW5kZXJFZDI1NTE5UHVibGljS2V5QjY0O1xuICBpZiAoc2VuZGVyRWQyNTUxOVB1YmxpY0tleUI2NCAhPT0gZXhwZWN0ZWRQdWJsaWNLZXlCNjQpIHtcbiAgICB0aHJvdyBuZXcgRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvcihcbiAgICAgIFwic2VuZGVyRWQyNTUxOVB1YmxpY0tleSBpbiBlbnZlbG9wZSBkb2VzIG5vdCBtYXRjaCBwcm92aWRlZCByZWNlaXZlckVkMjU1MTlTZWNyZXRLZXlcIixcbiAgICAgIFwic2VuZGVyUHVibGljS2V5XCJcbiAgICApO1xuICB9XG4gIGNvbnN0IHNlbmRlclgyNTUxOVB1YmxpY0tleUJ5dGVzID0gZGVjb2RlQmFzZTY0KHB1YmxpY01lc3NhZ2UuX21ldGFkYXRhLnNlbmRlclgyNTUxOVB1YmxpY0tleUI2NCk7XG4gIGNvbnN0IHNlbmRlclgyNTUxOVB1YmxpY0tleSA9IHRvS2V5KHNlbmRlclgyNTUxOVB1YmxpY0tleUJ5dGVzLCBcIlgyNTUxOVB1YmxpY0tleVwiIC8qIFgyNTUxOVB1YmxpY0tleSAqLyk7XG4gIGNvbnN0IGVuY3J5cHRpb25SZXN1bHQgPSBkZXNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQoZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UpO1xuICBjb25zdCBwcml2YXRlTWVzc2FnZSA9IGRlY3J5cHRPYmplY3QoXG4gICAgc2VuZGVyWDI1NTE5UHVibGljS2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSxcbiAgICBlbmNyeXB0aW9uUmVzdWx0LnNlY3VyZWQsXG4gICAgZW5jcnlwdGlvblJlc3VsdC5ub25jZVxuICApO1xuICBlbnN1cmVNZXRhZGF0YUZpZWxkcyhwdWJsaWNNZXNzYWdlLl9tZXRhZGF0YSk7XG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludChwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSk7XG4gIHJldHVybiB7XG4gICAgbWVzc2FnZVNpZ25hdHVyZSxcbiAgICBwcml2YXRlTWVzc2FnZSxcbiAgICBwdWJsaWNNZXNzYWdlXG4gIH07XG59XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uLnRzXG5pbXBvcnQge1xuICBiYXNlNjRUb0J5dGVzLFxuICBieXRlc1RvQmFzZTY0LFxuICBkZXNlcmlhbGl6ZVB1YmxpY0tleSxcbiAgZGVzZXJpYWxpemVTaWduYXR1cmUsXG4gIHNlcmlhbGl6ZVB1YmxpY0tleSxcbiAgc2VyaWFsaXplU2lnbmF0dXJlXG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5pbXBvcnQge1xuICBEZXNlcmlhbGl6ZXIsXG4gIEVkMjU1MTlQdWJsaWNLZXkgYXMgQXB0b3NFZDI1NTE5UHVibGljS2V5MixcbiAgRWQyNTUxOVNpZ25hdHVyZSBhcyBFZDI1NTE5U2lnbmF0dXJlMyxcbiAgSGV4IGFzIEhleDIsXG4gIFNlcmlhbGl6ZXJcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSkge1xuICBjb25zdCBzZXJpYWxpemVyID0gbmV3IFNlcmlhbGl6ZXIoKTtcbiAgc2VyaWFsaXplUHVibGljS2V5KHNlcmlhbGl6ZXIsIHB1YmxpY0tleSk7XG4gIHJldHVybiBieXRlc1RvQmFzZTY0KHNlcmlhbGl6ZXIudG9VaW50OEFycmF5KCkpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVQdWJsaWNLZXlCNjQocHVibGljS2V5QjY0KSB7XG4gIGNvbnN0IHNlcmlhbGl6ZWRQdWJsaWNLZXkgPSBiYXNlNjRUb0J5dGVzKHB1YmxpY0tleUI2NCk7XG4gIGNvbnN0IGRlc2VyaWFsaXplciA9IG5ldyBEZXNlcmlhbGl6ZXIoc2VyaWFsaXplZFB1YmxpY0tleSk7XG4gIHJldHVybiBkZXNlcmlhbGl6ZVB1YmxpY0tleShkZXNlcmlhbGl6ZXIpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpIHtcbiAgcmV0dXJuIG5ldyBBcHRvc0VkMjU1MTlQdWJsaWNLZXkyKGRlY29kZUJhc2U2NChlZDI1NTE5UHVibGljS2V5QjY0KSk7XG59XG5mdW5jdGlvbiBzZXJpYWxpemVTaWduYXR1cmVCNjQoc2lnbmF0dXJlKSB7XG4gIGNvbnN0IHNlcmlhbGl6ZXIgPSBuZXcgU2VyaWFsaXplcigpO1xuICBzZXJpYWxpemVTaWduYXR1cmUoc2VyaWFsaXplciwgc2lnbmF0dXJlKTtcbiAgcmV0dXJuIGJ5dGVzVG9CYXNlNjQoc2VyaWFsaXplci50b1VpbnQ4QXJyYXkoKSk7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVNpZ25hdHVyZUI2NChzaWduYXR1cmVCNjQpIHtcbiAgY29uc3Qgc2VyaWFsaXplZFNpZ25hdHVyZSA9IGJhc2U2NFRvQnl0ZXMoc2lnbmF0dXJlQjY0KTtcbiAgY29uc3QgZGVzZXJpYWxpemVyID0gbmV3IERlc2VyaWFsaXplcihzZXJpYWxpemVkU2lnbmF0dXJlKTtcbiAgcmV0dXJuIGRlc2VyaWFsaXplU2lnbmF0dXJlKGRlc2VyaWFsaXplcik7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUVkMjU1MTlTaWduYXR1cmVCNjQoZWQyNTUxOVNpZ25hdHVyZUI2NCkge1xuICBjb25zdCBzaWduYXR1cmVCeXRlcyA9IEhleDIuZnJvbUhleElucHV0KGVkMjU1MTlTaWduYXR1cmVCNjQpLnRvVWludDhBcnJheSgpO1xuICByZXR1cm4gbmV3IEVkMjU1MTlTaWduYXR1cmUzKHNpZ25hdHVyZUJ5dGVzKTtcbn1cbmZ1bmN0aW9uIHB1YmxpY0tleUI2NEZyb21FZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpIHtcbiAgY29uc3QgcHVibGljS2V5ID0gZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpO1xuICByZXR1cm4gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSk7XG59XG5cbi8vIHNyYy93YWxsZXRBY2NvdW50cy50c1xuaW1wb3J0IHsgUHVibGljS2V5IGFzIEFwdG9zUHVibGljS2V5IH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuaW1wb3J0IHsgc2hhM18yNTYgYXMgc2hhM18yNTYzIH0gZnJvbSBcIkBub2JsZS9oYXNoZXMvc2hhM1wiO1xudmFyIEFjY291bnRDb25uZWN0aW9uQWN0aW9uID0gLyogQF9fUFVSRV9fICovICgoQWNjb3VudENvbm5lY3Rpb25BY3Rpb24yKSA9PiB7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uMltcIkFERFwiXSA9IFwiYWRkXCI7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uMltcIlJFTU9WRVwiXSA9IFwicmVtb3ZlXCI7XG4gIHJldHVybiBBY2NvdW50Q29ubmVjdGlvbkFjdGlvbjI7XG59KShBY2NvdW50Q29ubmVjdGlvbkFjdGlvbiB8fCB7fSk7XG5mdW5jdGlvbiBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIoZWQyNTUxOVNlY3JldEtleU9yU2lnbkNhbGxiYWNrLCBwdWJsaWNLZXkpIHtcbiAgY29uc3QgcHVibGljS2V5Qnl0ZXMgPSBwdWJsaWNLZXkgaW5zdGFuY2VvZiBBcHRvc1B1YmxpY0tleSA/IHB1YmxpY0tleS50b1VpbnQ4QXJyYXkoKSA6IHB1YmxpY0tleS5rZXk7XG4gIGlmIChlZDI1NTE5U2VjcmV0S2V5T3JTaWduQ2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgIGNvbnN0IHNlZWRHZW5lcmF0b3JCeXRlcyA9IG1lc3NhZ2VIYXNoKHB1YmxpY0tleUJ5dGVzLCBcIlRSQU5TUE9SVF9LRVlQQUlSXCIpO1xuICAgIGNvbnN0IHNpZ25hdHVyZSA9IGVkMjU1MTlTZWNyZXRLZXlPclNpZ25DYWxsYmFjayhzZWVkR2VuZXJhdG9yQnl0ZXMpO1xuICAgIGlmIChzaWduYXR1cmUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICByZXR1cm4gc2lnbmF0dXJlLnRoZW4oKHZhbHVlKSA9PiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQodmFsdWUudG9VaW50OEFycmF5KCkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGVkMjU1MTlLZXlwYWlyRnJvbVNlY3JldChzaWduYXR1cmUudG9VaW50OEFycmF5KCkpO1xuICB9XG4gIGNvbnN0IHNlZWRCeXRlcyA9IHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShwdWJsaWNLZXlCeXRlcywgZWQyNTUxOVNlY3JldEtleU9yU2lnbkNhbGxiYWNrLCBcIlRSQU5TUE9SVF9LRVlQQUlSXCIpO1xuICByZXR1cm4gZWQyNTUxOUtleXBhaXJGcm9tU2VjcmV0KHNlZWRCeXRlcyk7XG59XG5mdW5jdGlvbiBjcmVhdGVTZXJpYWxpemVkQWNjb3VudEluZm8oLi4uW1xuICBzaWduQ2FsbGJhY2ssXG4gIHB1YmxpY0tleSxcbiAgdHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleSxcbiAgYWN0aW9uLFxuICBpbnRlbnRJZCxcbiAgYWNjb3VudEFkZHJlc3Ncbl0pIHtcbiAgY29uc3QgYXV0aEtleSA9IHB1YmxpY0tleS5hdXRoS2V5KCk7XG4gIGNvbnN0IGZpbmFsQWNjb3VudEFkZHJlc3MgPSBhY2NvdW50QWRkcmVzcyB8fCBhdXRoS2V5LmRlcml2ZWRBZGRyZXNzKCkudG9TdHJpbmcoKTtcbiAgY29uc3QgcHVibGljS2V5QjY0ID0gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSk7XG4gIGNvbnN0IGFjY291bnRJbmZvID0ge1xuICAgIGFjY291bnRBZGRyZXNzOiBmaW5hbEFjY291bnRBZGRyZXNzLFxuICAgIGFjdGlvbixcbiAgICBpbnRlbnRJZCxcbiAgICBwdWJsaWNLZXlCNjQsXG4gICAgdGltZXN0YW1wTWlsbGlzOiBEYXRlLm5vdygpLFxuICAgIHRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXlCNjQ6IGVuY29kZUJhc2U2NCh0cmFuc3BvcnRFZDI1NTE5UHVibGljS2V5LmtleSlcbiAgfTtcbiAgY29uc3QgYWNjb3VudEluZm9TZXJpYWxpemVkID0gSlNPTi5zdHJpbmdpZnkoYWNjb3VudEluZm8pO1xuICBjb25zdCBhY2NvdW50SW5mb0J5dGVzID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGFjY291bnRJbmZvU2VyaWFsaXplZCk7XG4gIGNvbnN0IGFjY291bnRJbmZvSGFzaCA9IHNoYTNfMjU2MyhhY2NvdW50SW5mb0J5dGVzKTtcbiAgY29uc3Qgc2lnbmF0dXJlID0gc2lnbkNhbGxiYWNrKG1lc3NhZ2VIYXNoKGFjY291bnRJbmZvSGFzaCwgXCJBQ0NPVU5UX0lORk9cIikpO1xuICBpZiAoc2lnbmF0dXJlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgIHJldHVybiBzaWduYXR1cmUudGhlbigodmFsdWUpID0+ICh7XG4gICAgICBhY2NvdW50SW5mb1NlcmlhbGl6ZWQsXG4gICAgICBzaWduYXR1cmVCNjQ6IHNlcmlhbGl6ZVNpZ25hdHVyZUI2NCh2YWx1ZSlcbiAgICB9KSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBhY2NvdW50SW5mb1NlcmlhbGl6ZWQsXG4gICAgc2lnbmF0dXJlQjY0OiBzZXJpYWxpemVTaWduYXR1cmVCNjQoc2lnbmF0dXJlKVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gYXB0b3NBY2NvdW50VG9TZXJpYWxpemVkSW5mbyhhY2NvdW50LCBpbnRlbnRJZCkge1xuICBjb25zdCBzaWduQ2FsbGJhY2sgPSBhc3luYyAoZGF0YSkgPT4gYWNjb3VudC5zaWduKGRhdGEpO1xuICBjb25zdCB0cmFuc3BvcnRLZXkgPSBhd2FpdCBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIoc2lnbkNhbGxiYWNrLCBhY2NvdW50LnB1YmxpY0tleSk7XG4gIHJldHVybiBjcmVhdGVTZXJpYWxpemVkQWNjb3VudEluZm8oXG4gICAgc2lnbkNhbGxiYWNrLFxuICAgIGFjY291bnQucHVibGljS2V5LFxuICAgIHRyYW5zcG9ydEtleS5wdWJsaWNLZXksXG4gICAgXCJhZGRcIiAvKiBBREQgKi8sXG4gICAgaW50ZW50SWRcbiAgKTtcbn1cbmV4cG9ydCB7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uLFxuICBEZWNyeXB0aW9uRXJyb3IsXG4gIEVuY3J5cHRpb25FbnZlbG9wZUVycm9yLFxuICBFbnZlbG9wZU1lc3NhZ2VNaXNtYXRjaEVycm9yLFxuICBLZXlUeXBlcyxcbiAgUkVRVUlSRURfRklFTERTLFxuICBTSUdOQVRVUkVfUFJFRklYLFxuICBhcHRvc0FjY291bnRUb0VkMjU1MTlLZXlwYWlyLFxuICBhcHRvc0FjY291bnRUb1NlcmlhbGl6ZWRJbmZvLFxuICBjb25jYXRVaW50OGFycmF5LFxuICBjb25zdHJ1Y3RNZXRhZGF0YSxcbiAgY29udmVydEVkMjU1MTlQdWJsaWNLZXlUb1gyNTUxOVB1YmxpY0tleSxcbiAgY29udmVydEVkMjU1MTlTZWNyZXRLZXlUb1gyNTUxOVNlY3JldEtleSxcbiAgY3JlYXRlRWQyNTUxOUtleVBhaXIsXG4gIGNyZWF0ZVNlcmlhbGl6ZWRBY2NvdW50SW5mbyxcbiAgY3JlYXRlWDI1NTE5S2V5UGFpcixcbiAgZGFuZ2Vyb3VzbHlFbmNyeXB0QW5kU2lnbkVudmVsb3BlVW52YWxpZGF0ZWQsXG4gIGRlY29kZUJhc2U2NCxcbiAgZGVjcnlwdEVudmVsb3BlLFxuICBkZWNyeXB0TWVzc2FnZSxcbiAgZGVjcnlwdE1lc3NhZ2VEaXJlY3QsXG4gIGRlY3J5cHRPYmplY3QsXG4gIGRlY3J5cHRPYmplY3REaXJlY3QsXG4gIGRlY3J5cHRTZXJpYWxpemVkRW5jcnlwdGlvblJlc3VsdCxcbiAgZGVjcnlwdFNlcmlhbGl6ZWRFbmNyeXB0aW9uUmVzdWx0RGlyZWN0LFxuICBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIsXG4gIGRlc2VyaWFsaXplRWQyNTUxOVB1YmxpY0tleUI2NCxcbiAgZGVzZXJpYWxpemVFZDI1NTE5U2lnbmF0dXJlQjY0LFxuICBkZXNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQsXG4gIGRlc2VyaWFsaXplUHVibGljS2V5QjY0LFxuICBkZXNlcmlhbGl6ZVNpZ25hdHVyZUI2NCxcbiAgZGVzZXJpYWxpemVUcmFuc3BvcnRFbnZlbG9wZSxcbiAgZWQyNTUxOUtleXBhaXJGcm9tU2VjcmV0LFxuICBlbmNvZGVCYXNlNjQsXG4gIGVuY3J5cHRBbmRTaWduRW52ZWxvcGUsXG4gIGVuY3J5cHRNZXNzYWdlLFxuICBlbmNyeXB0TWVzc2FnZURpcmVjdCxcbiAgZW5jcnlwdE9iamVjdCxcbiAgZW5jcnlwdE9iamVjdERpcmVjdCxcbiAgZW5zdXJlTWV0YWRhdGFGaWVsZHMsXG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludCxcbiAgaGFzaEFuZFZlcmlmeVNpZ25hdHVyZSxcbiAga2V5cGFpclRvRWQyNTUxOSxcbiAga2V5cGFpclRvWDI1NTE5LFxuICBtYWtlRWQyNTUxOVNlY3JldEtleVNpZ25DYWxsYmFja05vRG9tYWluU2VwYXJhdGlvbixcbiAgbWVzc2FnZUhhc2gsXG4gIHB1YmxpY0tleUI2NEZyb21FZDI1NTE5UHVibGljS2V5QjY0LFxuICBzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0LFxuICBzZXJpYWxpemVQdWJsaWNLZXlCNjQsXG4gIHNlcmlhbGl6ZVNpZ25hdHVyZUI2NCxcbiAgc2lnbldpdGhFZDI1NTE5U2VjcmV0S2V5LFxuICB0b0tleSxcbiAgdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUsXG4gIHZlcmlmeVNpZ25hdHVyZVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/../../../../node_modules/@identity-connect/crypto/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/../../../../node_modules/@identity-connect/dapp-sdk/dist/index.mjs":
/*!**************************************************************************!*\
  !*** ../../../../node_modules/@identity-connect/dapp-sdk/dist/index.mjs ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ACDappClient: () => (/* binding */ ACDappClient),\n/* harmony export */   ACKeylessClient: () => (/* binding */ ACKeylessClient),\n/* harmony export */   DAPP_PAIRINGS_WINDOW_STORAGE_KEY: () => (/* binding */ DAPP_PAIRINGS_WINDOW_STORAGE_KEY),\n/* harmony export */   ICDappClient: () => (/* binding */ ICDappClient),\n/* harmony export */   windowStateAccessors: () => (/* binding */ windowStateAccessors)\n/* harmony export */ });\n/* harmony import */ var _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-connect/wallet-api */ \"(ssr)/../../../../node_modules/@aptos-connect/wallet-api/dist/index.mjs\");\n/* harmony import */ var _aptos_connect_web_transport__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aptos-connect/web-transport */ \"(ssr)/../../../../node_modules/@aptos-connect/web-transport/dist/index.mjs\");\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/../../../../node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @identity-connect/api */ \"(ssr)/../../../../node_modules/@identity-connect/api/dist/index.mjs\");\n/* harmony import */ var _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @identity-connect/crypto */ \"(ssr)/../../../../node_modules/@identity-connect/crypto/dist/index.mjs\");\n/* harmony import */ var _identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @identity-connect/wallet-api */ \"(ssr)/../../../../node_modules/@identity-connect/wallet-api/dist/index.mjs\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! axios */ \"(ssr)/../../../../node_modules/axios/lib/axios.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! axios */ \"(ssr)/../../../../node_modules/axios/index.js\");\n// src/ACDappClient.ts\n\n\n\n\n\n\n// src/constants.ts\nvar DEFAULT_FRONTEND_URL = \"https://aptosconnect.app\";\n\n// src/PairingClient.ts\n\n\n\n\n\n\n// src/errors.ts\nvar SignatureRequestError = class _SignatureRequestError extends Error {\n  constructor(status) {\n    super(status);\n    this.name = \"SignatureRequestError\";\n    Object.setPrototypeOf(this, _SignatureRequestError.prototype);\n  }\n};\nvar UnexpectedSignatureResponseError = class _UnexpectedSignatureResponseError extends Error {\n  constructor(missingFields) {\n    const message = `Missing the following fields: ${missingFields.join(\", \")}`;\n    super(message);\n    this.name = \"UnexpectedSignatureResponseError\";\n    Object.setPrototypeOf(this, _UnexpectedSignatureResponseError.prototype);\n  }\n};\nvar PairingExpiredError = class _PairingExpiredError extends Error {\n  constructor() {\n    super();\n    this.name = \"PairingExpiredError\";\n    Object.setPrototypeOf(this, _PairingExpiredError.prototype);\n  }\n};\nvar UnregisteredDappError = class _UnregisteredDappError extends Error {\n  constructor() {\n    super(\"Dapp ID is invalid or not associated with a registered Dapp.\");\n    this.name = \"UnregisteredDappError\";\n    Object.setPrototypeOf(this, _UnregisteredDappError.prototype);\n  }\n};\n\n// src/state.ts\nvar DAPP_PAIRINGS_WINDOW_STORAGE_KEY = \"icDappPairings\";\nvar windowStateAccessors = {\n  async get(address) {\n    const pairings = await this.getAll();\n    return pairings[address];\n  },\n  async getAll() {\n    const serialized = window.localStorage.getItem(DAPP_PAIRINGS_WINDOW_STORAGE_KEY);\n    return serialized ? JSON.parse(serialized) : {};\n  },\n  async update(address, pairing) {\n    const pairings = await this.getAll();\n    if (pairing === void 0) {\n      delete pairings[address];\n    } else {\n      pairings[address] = pairing;\n    }\n    const newSerialized = JSON.stringify(pairings);\n    window.localStorage.setItem(DAPP_PAIRINGS_WINDOW_STORAGE_KEY, newSerialized);\n  }\n};\n\n// src/utils.ts\nvar SIGN_MESSAGE_RESPONSE_REQUIRED_FIELDS = [\n  \"address\",\n  \"application\",\n  \"chainId\",\n  \"fullMessage\",\n  \"message\",\n  \"nonce\",\n  \"prefix\",\n  \"signature\"\n];\nfunction validateSignMessageResponse(response) {\n  const providedFields = new Set(Object.keys(response));\n  const missingFields = SIGN_MESSAGE_RESPONSE_REQUIRED_FIELDS.filter((field) => !providedFields.has(field));\n  if (missingFields.length > 0) {\n    throw new UnexpectedSignatureResponseError(missingFields);\n  }\n}\nvar SIGN_AND_SUBMIT_TRANSACTION_RESPONSE_REQUIRED_FIELDS = [\"hash\"];\nfunction validateSignAndSubmitTransactionResponse(response) {\n  const providedFields = new Set(Object.keys(response));\n  const missingFields = SIGN_AND_SUBMIT_TRANSACTION_RESPONSE_REQUIRED_FIELDS.filter(\n    (field) => !providedFields.has(field)\n  );\n  if (missingFields.length > 0) {\n    throw new UnexpectedSignatureResponseError(missingFields);\n  }\n}\n\n// src/PairingClient.ts\nvar API_VERSION = \"0.2.0\";\nvar SIGNING_REQUEST_POLLING_INTERVAL = 2500;\nvar SEQUENCE_NUMBER_MISMATCH_PATTERN = /^Sequence number mismatch, expected (?:\\S+ to be )?(\\d+)/;\nasync function waitFor(milliseconds) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, milliseconds);\n  });\n}\nasync function withRetries(requestFn, onError, retries = 1) {\n  for (let i = 0; i < retries; i += 1) {\n    try {\n      return await requestFn();\n    } catch (err) {\n      onError(err);\n    }\n  }\n  return requestFn();\n}\nvar ACPairingClient = class {\n  constructor({\n    accessors = windowStateAccessors,\n    axiosConfig,\n    defaultNetworkName = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.NetworkName.MAINNET\n  } = {}) {\n    // endregion\n    this.onDisconnectListeners = /* @__PURE__ */ new Set();\n    this.accessors = accessors;\n    this.defaultNetworkName = defaultNetworkName;\n    this.axiosInstance = axios__WEBPACK_IMPORTED_MODULE_6__[\"default\"].create({\n      baseURL: DEFAULT_FRONTEND_URL,\n      ...axiosConfig\n    });\n    const isClientSideRendering = typeof window !== \"undefined\";\n    this.initPromise = isClientSideRendering ? this.syncFirstPairing() : void 0;\n  }\n  async getPairing(id) {\n    const response = await this.axiosInstance.get(`v1/pairing/${id}/`);\n    return response.data.data.pairing;\n  }\n  async syncFirstPairing() {\n    const pairings = await this.accessors.getAll();\n    const firstPairing = Object.values(pairings)[0];\n    if (firstPairing === void 0) {\n      return;\n    }\n    try {\n      const { dappSpecificWallet, maxDappSequenceNumber } = await this.getPairing(firstPairing.pairingId);\n      await this.accessors.update(firstPairing.accountAddress, {\n        ...firstPairing,\n        currSequenceNumber: maxDappSequenceNumber,\n        dappWalletId: dappSpecificWallet?.id\n      });\n    } catch (err) {\n      await this.accessors.update(firstPairing.accountAddress, void 0);\n    }\n  }\n  async createSigningRequest(pairing, type, networkName, requestBody) {\n    const dappEd25519SecretKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519PublicKeyB64);\n    const accountTransportEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.accountTransportEd25519PublicKeyB64);\n    let sequenceNumber = pairing.currSequenceNumber + 1;\n    return withRetries(\n      async () => {\n        const requestEnvelope = await (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encryptAndSignEnvelope)(\n          (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519SecretKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n          (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n          (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(accountTransportEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n          sequenceNumber,\n          { apiVersion: API_VERSION, networkName, requestType: type },\n          requestBody\n        );\n        const response = await this.axiosInstance.post(\n          `v1/pairing/${pairing.pairingId}/signing-request/`,\n          requestEnvelope\n        );\n        await this.accessors.update(pairing.accountAddress, {\n          ...pairing,\n          currSequenceNumber: sequenceNumber\n        });\n        return response.data.data.signingRequest;\n      },\n      (err) => {\n        if ((0,axios__WEBPACK_IMPORTED_MODULE_7__.isAxiosError)(err)) {\n          const errorMessage = err.response?.data?.message;\n          const expectedSequenceNumber = errorMessage?.match(SEQUENCE_NUMBER_MISMATCH_PATTERN)?.[1];\n          if (expectedSequenceNumber !== void 0) {\n            sequenceNumber = Number(expectedSequenceNumber);\n            return;\n          }\n        }\n        throw err;\n      }\n    );\n  }\n  async getSigningRequest(id) {\n    const response = await this.axiosInstance.get(\n      `v1/signing-request/${id}/`,\n      {\n        validateStatus: (status) => status === 200 || status === 404\n      }\n    );\n    return response.data?.data?.signingRequest;\n  }\n  async deletePairing(pairingId, secretKey, publicKey) {\n    const requestEnvelope = await (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encryptAndSignEnvelope)(\n      secretKey,\n      publicKey,\n      publicKey,\n      0,\n      // ignored\n      {},\n      {}\n    );\n    await this.axiosInstance.post(\n      `v1/pairing/${pairingId}/delete/`,\n      requestEnvelope,\n      { validateStatus: (status) => status === 204 || status === 404 }\n    );\n  }\n  async cancelSigningRequest(pairing, id) {\n    const sequenceNumber = pairing.currSequenceNumber;\n    const dappEd25519SecretKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519PublicKeyB64);\n    const accountTransportEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.accountTransportEd25519PublicKeyB64);\n    const requestEnvelope = await (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encryptAndSignEnvelope)(\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519SecretKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(accountTransportEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n      sequenceNumber + 1,\n      {},\n      {}\n    );\n    const response = await this.axiosInstance.patch(\n      `v1/signing-request/${id}/cancel/`,\n      requestEnvelope\n    );\n    await this.accessors.update(pairing.accountAddress, {\n      ...pairing,\n      currSequenceNumber: sequenceNumber + 1\n    });\n    return response.data.data.signingRequest;\n  }\n  async signRequest(address, type, requestBody, { cancelToken, networkName } = {}) {\n    await this.initPromise;\n    const pairing = await this.accessors.get(address);\n    if (pairing === void 0) {\n      throw new Error(\"The requested account is not paired\");\n    }\n    let signingRequest;\n    try {\n      signingRequest = await this.createSigningRequest(\n        pairing,\n        type,\n        networkName || this.defaultNetworkName,\n        requestBody\n      );\n      while (signingRequest.status === \"PENDING\") {\n        await waitFor(SIGNING_REQUEST_POLLING_INTERVAL);\n        if (cancelToken?.cancelled) {\n          signingRequest.status = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestStatus.CANCELLED;\n          break;\n        }\n        signingRequest = await this.getSigningRequest(signingRequest.id) ?? signingRequest;\n      }\n    } catch (err) {\n      if ((0,axios__WEBPACK_IMPORTED_MODULE_7__.isAxiosError)(err) && err.code === \"404\") {\n        await this.accessors.update(address, void 0);\n        for (const listener of this.onDisconnectListeners) {\n          listener(address);\n        }\n        throw new PairingExpiredError();\n      }\n      throw err;\n    }\n    if (signingRequest.status !== \"APPROVED\") {\n      throw new SignatureRequestError(signingRequest.status);\n    }\n    const decrypted = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decryptEnvelope)(\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)((0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.accountTransportEd25519PublicKeyB64), _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)((0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64), _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n      signingRequest.responseEnvelope\n    );\n    return decrypted.privateMessage;\n  }\n  // region Public API\n  /**\n   * Requests a connection to an account (internally known as pairing).\n   * @returns either the address of the connected account, or undefined if the\n   * connection was cancelled.\n   */\n  async addPairing({ publicKey, secretKey }, finalizedPairing) {\n    await this.accessors.update(finalizedPairing.account.accountAddress, {\n      accountAddress: finalizedPairing.account.accountAddress,\n      accountAlias: finalizedPairing.account.userSubmittedAlias ?? void 0,\n      accountPublicKeyB64: finalizedPairing.account.publicKeyB64,\n      accountTransportEd25519PublicKeyB64: finalizedPairing.account.transportEd25519PublicKeyB64,\n      currSequenceNumber: finalizedPairing.maxDappSequenceNumber,\n      dappEd25519PublicKeyB64: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(publicKey.key),\n      dappEd25519SecretKeyB64: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(secretKey.key),\n      dappWalletId: finalizedPairing.dappSpecificWalletId,\n      pairingId: finalizedPairing.id\n    });\n  }\n  async disconnect(address) {\n    const pairing = await this.accessors.get(address);\n    if (pairing === void 0) {\n      throw new Error(\"The specified account is not paired\");\n    }\n    const dappEd25519SecretKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519PublicKeyB64);\n    await this.deletePairing(\n      pairing.pairingId,\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519SecretKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey)\n    );\n    await this.accessors.update(address, void 0);\n    for (const listener of this.onDisconnectListeners) {\n      listener(address);\n    }\n  }\n  async signMessage(address, args, options) {\n    const response = await this.signRequest(\n      address,\n      _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestTypes.SIGN_MESSAGE,\n      args,\n      options\n    );\n    validateSignMessageResponse(response);\n    return response;\n  }\n  async signTransaction(address, args, options) {\n    const serializedRequestArgs = (0,_identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__.serializeSignTransactionRequestArgs)(args);\n    const serializedResponseArgs = await this.signRequest(address, _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestTypes.SIGN_TRANSACTION, serializedRequestArgs, options);\n    return (0,_identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__.deserializeSignTransactionResponseArgs)(serializedResponseArgs);\n  }\n  // endregion\n  async signAndSubmitTransaction(address, args, options) {\n    const serializedRequestArgs = (0,_identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__.serializeSignAndSubmitTransactionRequestArgs)(args);\n    try {\n      const responseArgs = await this.signRequest(address, _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestTypes.SIGN_AND_SUBMIT_TRANSACTION, serializedRequestArgs, options);\n      validateSignAndSubmitTransactionResponse(responseArgs);\n      return responseArgs;\n    } catch (e) {\n      if (e instanceof axios__WEBPACK_IMPORTED_MODULE_7__.AxiosError && e.response?.data?.message) {\n        throw new Error(e.response?.data?.message);\n      }\n      throw e;\n    }\n  }\n  async getConnectedAccounts() {\n    await this.initPromise;\n    const pairings = await this.accessors.getAll();\n    return Object.values(pairings).map(\n      ({ accountAddress, accountEd25519PublicKeyB64, accountPublicKeyB64 }) => ({\n        address: _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(accountAddress),\n        publicKey: accountPublicKeyB64 !== void 0 ? (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.deserializePublicKeyB64)(accountPublicKeyB64) : (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.deserializeEd25519PublicKeyB64)(accountEd25519PublicKeyB64)\n      })\n    );\n  }\n  onDisconnect(listener) {\n    this.onDisconnectListeners.add(listener);\n    return () => this.onDisconnectListeners.delete(listener);\n  }\n};\n\n// src/ACDappClient.ts\nvar ACDappClient = class {\n  constructor({\n    backendBaseURL,\n    dappId,\n    dappImageURI,\n    dappName,\n    defaultNetworkName = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.NetworkName.MAINNET,\n    frontendBaseURL = DEFAULT_FRONTEND_URL\n  } = {}) {\n    this.defaultNetworkName = defaultNetworkName;\n    this.dappInfo = {\n      domain: window.location.origin,\n      imageURI: dappImageURI,\n      name: dappName ?? document.title\n    };\n    this.transport = new _aptos_connect_web_transport__WEBPACK_IMPORTED_MODULE_1__.WebWalletTransport(frontendBaseURL);\n    this.dappId = dappId;\n    this.pairingClient = new ACPairingClient({\n      axiosConfig: {\n        baseURL: backendBaseURL ?? frontendBaseURL\n      },\n      defaultNetworkName\n    });\n  }\n  // region Public API\n  async getKeylessAccounts() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async getIcAccounts() {\n    return this.pairingClient.getConnectedAccounts() ?? [];\n  }\n  async isIcAccount(address) {\n    const icAccounts = await this.getIcAccounts();\n    return icAccounts.find((account) => account.address.equals(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(address))) !== void 0;\n  }\n  async getConnectedAccounts() {\n    const keylessAccounts = await this.getKeylessAccounts();\n    const icAccounts = await this.getIcAccounts();\n    return [...keylessAccounts, ...icAccounts];\n  }\n  async disconnect(address) {\n    if (await this.isIcAccount(address)) {\n      const stringAddress = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(address).toString();\n      await this.pairingClient.disconnect(stringAddress);\n    } else {\n      const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.DisconnectRequest.serialize(this.dappInfo);\n      await this.transport.sendRequest(serializedRequest);\n    }\n  }\n  async connect() {\n    const dappKeypair = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.createEd25519KeyPair)();\n    const requestArgs = {\n      dappEd25519PublicKeyB64: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(dappKeypair.publicKey.key),\n      dappId: this.dappId\n    };\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectRequest.serialize(this.dappInfo, requestArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectResponse.deserialize(serializedResponse);\n    if (response.args.status === \"approved\") {\n      const { account, pairing } = response.args.args;\n      if (pairing) {\n        await this.pairingClient.addPairing(dappKeypair, pairing);\n      }\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({ account });\n    }\n    return response.args;\n  }\n  async signMessage(args) {\n    const { signerAddress } = args;\n    if (await this.isIcAccount(signerAddress)) {\n      const { chainId } = args;\n      const network = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.chainIdToNetwork)(chainId);\n      let message;\n      let nonce;\n      try {\n        message = new TextDecoder().decode(args.message);\n        nonce = new TextDecoder().decode(args.nonce);\n      } catch (err) {\n        throw new Error(\"Only UTF-8 encoded text is supported when using IC\");\n      }\n      const { fullMessage, signature: hexSignature } = await this.pairingClient.signMessage(\n        signerAddress.toString(),\n        {\n          address: true,\n          application: true,\n          chainId: true,\n          message,\n          nonce\n        },\n        { networkName: network }\n      );\n      const signatureBytes = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Hex.fromHexInput(hexSignature).toUint8Array();\n      const signature = signatureBytes.length === _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Ed25519Signature.LENGTH ? new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Ed25519Signature(signatureBytes) : _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AnySignature.deserialize(new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Deserializer(signatureBytes));\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({\n        fullMessage,\n        signature\n      });\n    }\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signTransaction(args) {\n    const normalizedArgs = \"transaction\" in args ? _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.normalizeArgs(args) : args;\n    const { signerAddress } = args;\n    if (await this.isIcAccount(signerAddress)) {\n      const {\n        expirationSecondsFromNow,\n        expirationTimestamp,\n        feePayer,\n        gasUnitPrice,\n        maxGasAmount,\n        network,\n        payload,\n        secondarySigners,\n        sender,\n        sequenceNumber\n      } = normalizedArgs;\n      if (feePayer !== void 0) {\n        throw new Error(\"Sponsored transaction not currently supported\");\n      }\n      if (secondarySigners && secondarySigners.length > 0) {\n        throw new Error(\"Multi-agent transactions not currently supported\");\n      }\n      const responseArgs = await this.pairingClient.signTransaction(\n        signerAddress.toString(),\n        {\n          options: {\n            expirationSecondsFromNow,\n            expirationTimestamp,\n            gasUnitPrice,\n            maxGasAmount,\n            sender: sender?.address.toString(),\n            sequenceNumber: sequenceNumber !== void 0 ? Number(sequenceNumber) : void 0\n          },\n          payload\n        },\n        {\n          networkName: network\n        }\n      );\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({\n        authenticator: responseArgs.accountAuthenticator,\n        rawTransaction: responseArgs.rawTxn\n      });\n    }\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.serialize(this.dappInfo, normalizedArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signAndSubmitTransaction(args) {\n    const { signerAddress } = args;\n    if (await this.isIcAccount(signerAddress)) {\n      const { expirationTimestamp, feePayer, gasUnitPrice, maxGasAmount, network } = args;\n      const aptosConfig = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AptosConfig({ network });\n      let payload;\n      if (\"bcsToBytes\" in args.payload) {\n        payload = args.payload;\n      } else if (\"bytecode\" in args.payload) {\n        payload = await (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateTransactionPayload)(args.payload);\n      } else {\n        payload = args.payload.abi !== void 0 ? (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateTransactionPayloadWithABI)({ ...args.payload, abi: args.payload.abi }) : await (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateTransactionPayload)({ aptosConfig, ...args.payload });\n      }\n      let convertedArgs;\n      if (feePayer !== void 0) {\n        const rawTxn = await (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateRawTransaction)({\n          aptosConfig,\n          feePayerAddress: feePayer.address,\n          options: {\n            gasUnitPrice,\n            maxGasAmount\n          },\n          payload,\n          sender: signerAddress\n        });\n        convertedArgs = {\n          feePayerAuthenticator: feePayer.authenticator,\n          rawTxn: new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.FeePayerRawTransaction(rawTxn, [], feePayer.address)\n        };\n      } else {\n        convertedArgs = {\n          options: {\n            expirationTimestamp,\n            gasUnitPrice,\n            maxGasAmount\n          },\n          payload\n        };\n      }\n      const { hash } = await this.pairingClient.signAndSubmitTransaction(signerAddress.toString(), convertedArgs, {\n        networkName: network\n      });\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({ txnHash: hash });\n    }\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  // endregion\n};\n\n// src/ICDappClient.ts\n\n\n\n// src/prompt.ts\nvar DEFAULT_PROMPT_SIZE = { height: 695, width: 465 };\nvar PROMPT_POLLER_INTERVAL = 500;\nfunction openPrompt(url, size = DEFAULT_PROMPT_SIZE) {\n  const { height, width } = size;\n  const options = {\n    height,\n    left: window.screenLeft + Math.round((window.outerWidth - width) / 2),\n    popup: true,\n    top: window.screenTop + Math.round((window.outerHeight - height) / 2),\n    width\n  };\n  const strOptions = Object.entries(options).map(([key, value]) => `${key}=${JSON.stringify(value)}`).reduce((acc, entry) => `${acc}, ${entry}`);\n  const href = url instanceof URL ? url.href : url;\n  const promptWindow = window.open(href, void 0, strOptions);\n  if (promptWindow === null) {\n    throw new Error(\"Couldn't open prompt\");\n  }\n  return promptWindow;\n}\nasync function waitForPromptResponse(promptWindow) {\n  return new Promise((resolve) => {\n    const listeners = {\n      onMessage: (message) => {\n        if (message.source !== promptWindow) {\n          return;\n        }\n        window.removeEventListener(\"message\", listeners.onMessage);\n        clearTimeout(listeners.promptPollerId);\n        resolve({\n          args: message.data,\n          status: \"approved\"\n        });\n      },\n      promptPollerId: setInterval(() => {\n        if (promptWindow.closed) {\n          window.removeEventListener(\"message\", listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          resolve({\n            status: \"dismissed\"\n          });\n        }\n      }, PROMPT_POLLER_INTERVAL)\n    };\n    window.addEventListener(\"message\", listeners.onMessage);\n  });\n}\n\n// src/ICDappClient.ts\nvar ICDappClient = class extends ACPairingClient {\n  constructor(dappId, { frontendBaseURL = DEFAULT_FRONTEND_URL, ...pairingClientConfig } = {}) {\n    super(pairingClientConfig);\n    this.dappId = dappId;\n    this.frontendBaseURL = frontendBaseURL;\n  }\n  async createPairingRequest(dappEd25519PublicKeyB64) {\n    try {\n      const response = await this.axiosInstance.post(\"v1/pairing/\", {\n        dappEd25519PublicKeyB64,\n        dappId: this.dappId\n      });\n      return response.data.data.pairing;\n    } catch (err) {\n      if ((0,axios__WEBPACK_IMPORTED_MODULE_7__.isAxiosError)(err) && err.response?.data?.message === \"Dapp not found\") {\n        throw new UnregisteredDappError();\n      }\n      throw err;\n    }\n  }\n  // region Public API\n  /**\n   * Requests a connection to an account (internally known as pairing).\n   * @returns either the address of the connected account, or undefined if the\n   * connection was cancelled.\n   */\n  async connect() {\n    const { publicKey, secretKey } = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.createEd25519KeyPair)();\n    const dappEd25519PublicKeyB64 = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(publicKey.key);\n    const url = new URL(`${this.frontendBaseURL}/pairing`);\n    const promptWindow = await openPrompt(url.href);\n    let pairingId;\n    try {\n      const pendingPairing = await this.createPairingRequest(dappEd25519PublicKeyB64);\n      pairingId = pendingPairing.id;\n    } catch (err) {\n      promptWindow.close();\n      throw err;\n    }\n    url.searchParams.set(\"pairingId\", pairingId);\n    promptWindow.location.href = url.href;\n    const promptResponse = await waitForPromptResponse(promptWindow);\n    if (promptResponse.status === \"dismissed\") {\n      void this.deletePairing(pairingId, secretKey, publicKey);\n      return void 0;\n    }\n    const finalizedPairing = promptResponse.args;\n    await this.addPairing({ publicKey, secretKey }, finalizedPairing);\n    return finalizedPairing.account.accountAddress;\n  }\n  async offboard(address) {\n    const pairing = await this.accessors.get(address);\n    if (pairing === void 0) {\n      throw new Error(\"This account is not paired\");\n    }\n    const walletId = pairing.dappWalletId;\n    if (walletId === void 0) {\n      throw new Error(\"This account cannot be offboarded\");\n    }\n    const url = new URL(`${this.frontendBaseURL}/offboarding?walletId=${walletId}`);\n    const promptWindow = openPrompt(url);\n    const response = await waitForPromptResponse(promptWindow);\n    if (response.status === \"approved\" && response.args.offboarded) {\n      this.disconnect(address);\n      return true;\n    }\n    return false;\n  }\n  // endregion\n};\n\n// src/KeylessClient.ts\n\n\n\nvar ACKeylessClient = class {\n  constructor({\n    dappImageURI,\n    dappName,\n    defaultNetworkName = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.NetworkName.MAINNET,\n    frontendBaseURL = DEFAULT_FRONTEND_URL\n  } = {}) {\n    this.defaultNetworkName = defaultNetworkName;\n    this.dappInfo = {\n      domain: window.location.origin,\n      imageURI: dappImageURI,\n      name: dappName ?? document.title\n    };\n    this.transport = new _aptos_connect_web_transport__WEBPACK_IMPORTED_MODULE_1__.WebWalletTransport(frontendBaseURL);\n  }\n  // region Public API\n  async isConnected() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.IsConnectedRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.IsConnectedResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async getConnectedAccounts() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async disconnect() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.DisconnectRequest.serialize(this.dappInfo);\n    await this.transport.sendRequest(serializedRequest);\n  }\n  async connect() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signMessage(args) {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signTransaction(args) {\n    const normalizedArgs = \"transaction\" in args ? _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.normalizeArgs(args) : args;\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.serialize(this.dappInfo, normalizedArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signAndSubmitTransaction(args) {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  // endregion\n};\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL0BpZGVudGl0eS1jb25uZWN0L2RhcHAtc2RrL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQWVtQztBQUMrQjtBQVl0QztBQUN3QztBQUMyQjs7QUFFL0Y7QUFDQTs7QUFFQTtBQUNvRDtBQUtyQjtBQVVHO0FBS0k7QUFDa0I7O0FBRXhEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELHlCQUF5QjtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0Esa0JBQWtCLGFBQWE7QUFDL0I7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsOERBQVc7QUFDcEMsSUFBSSxJQUFJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNkNBQUs7QUFDOUI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFn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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixxQkFBcUIsd0JBQXdCLFNBQVM7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFlbUM7QUFDc0Q7QUFDckI7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsOERBQVk7QUFDckM7QUFDQSxJQUFJLElBQUk7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNEVBQW1CO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qix5RUFBa0I7QUFDaEQ7QUFDQSxxQkFBcUIsMEVBQW1CO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixrRkFBNEI7QUFDMUQ7QUFDQSxxQkFBcUIsbUZBQTZCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qix3RUFBa0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHFFQUFlO0FBQzdDO0FBQ0EscUJBQXFCLHNFQUFnQjtBQUNyQztBQUNBO0FBQ0E7QUFDQSw4QkFBOEIseUVBQW1CO0FBQ2pEO0FBQ0EscUJBQXFCLDBFQUFvQjtBQUN6QztBQUNBO0FBQ0E7QUFDQSxtREFBbUQsNkVBQXVCO0FBQzFFLDhCQUE4Qiw2RUFBdUI7QUFDckQ7QUFDQSxxQkFBcUIsOEVBQXdCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixzRkFBZ0M7QUFDOUQ7QUFDQSxxQkFBcUIsdUZBQWlDO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBT0U7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Zyb250ZW5kLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9AaWRlbnRpdHktY29ubmVjdC9kYXBwLXNkay9kaXN0L2luZGV4Lm1qcz8wZGMxIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9BQ0RhcHBDbGllbnQudHNcbmltcG9ydCB7XG4gIGNoYWluSWRUb05ldHdvcmssXG4gIENvbm5lY3RSZXF1ZXN0LFxuICBDb25uZWN0UmVzcG9uc2UsXG4gIERpc2Nvbm5lY3RSZXF1ZXN0LFxuICBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QsXG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UsXG4gIG1ha2VVc2VyQXBwcm92YWwsXG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QsXG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlLFxuICBTaWduTWVzc2FnZVJlcXVlc3QsXG4gIFNpZ25NZXNzYWdlUmVzcG9uc2UsXG4gIFNpZ25UcmFuc2FjdGlvblJlcXVlc3QsXG4gIFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlXG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5pbXBvcnQgeyBXZWJXYWxsZXRUcmFuc3BvcnQgfSBmcm9tIFwiQGFwdG9zLWNvbm5lY3Qvd2ViLXRyYW5zcG9ydFwiO1xuaW1wb3J0IHtcbiAgQWNjb3VudEFkZHJlc3MgYXMgQWNjb3VudEFkZHJlc3MyLFxuICBBbnlTaWduYXR1cmUsXG4gIEFwdG9zQ29uZmlnLFxuICBEZXNlcmlhbGl6ZXIsXG4gIEVkMjU1MTlTaWduYXR1cmUsXG4gIEZlZVBheWVyUmF3VHJhbnNhY3Rpb24sXG4gIGdlbmVyYXRlUmF3VHJhbnNhY3Rpb24sXG4gIGdlbmVyYXRlVHJhbnNhY3Rpb25QYXlsb2FkLFxuICBnZW5lcmF0ZVRyYW5zYWN0aW9uUGF5bG9hZFdpdGhBQkksXG4gIEhleFxufSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQgeyBOZXR3b3JrTmFtZSBhcyBOZXR3b3JrTmFtZTIgfSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3QvYXBpXCI7XG5pbXBvcnQgeyBjcmVhdGVFZDI1NTE5S2V5UGFpciwgZW5jb2RlQmFzZTY0IGFzIGVuY29kZUJhc2U2NDIgfSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3QvY3J5cHRvXCI7XG5cbi8vIHNyYy9jb25zdGFudHMudHNcbnZhciBERUZBVUxUX0ZST05URU5EX1VSTCA9IFwiaHR0cHM6Ly9hcHRvc2Nvbm5lY3QuYXBwXCI7XG5cbi8vIHNyYy9QYWlyaW5nQ2xpZW50LnRzXG5pbXBvcnQgeyBBY2NvdW50QWRkcmVzcyB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmltcG9ydCB7XG4gIE5ldHdvcmtOYW1lLFxuICBTaWduaW5nUmVxdWVzdFN0YXR1cyxcbiAgU2lnbmluZ1JlcXVlc3RUeXBlc1xufSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3QvYXBpXCI7XG5pbXBvcnQge1xuICBkZWNvZGVCYXNlNjQsXG4gIGRlY3J5cHRFbnZlbG9wZSxcbiAgZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0LFxuICBkZXNlcmlhbGl6ZVB1YmxpY0tleUI2NCxcbiAgZW5jb2RlQmFzZTY0LFxuICBlbmNyeXB0QW5kU2lnbkVudmVsb3BlLFxuICBLZXlUeXBlcyxcbiAgdG9LZXlcbn0gZnJvbSBcIkBpZGVudGl0eS1jb25uZWN0L2NyeXB0b1wiO1xuaW1wb3J0IHtcbiAgZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3MsXG4gIHNlcmlhbGl6ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3RBcmdzLFxuICBzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXF1ZXN0QXJnc1xufSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3Qvd2FsbGV0LWFwaVwiO1xuaW1wb3J0IGF4aW9zLCB7IEF4aW9zRXJyb3IsIGlzQXhpb3NFcnJvciB9IGZyb20gXCJheGlvc1wiO1xuXG4vLyBzcmMvZXJyb3JzLnRzXG52YXIgU2lnbmF0dXJlUmVxdWVzdEVycm9yID0gY2xhc3MgX1NpZ25hdHVyZVJlcXVlc3RFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3Ioc3RhdHVzKSB7XG4gICAgc3VwZXIoc3RhdHVzKTtcbiAgICB0aGlzLm5hbWUgPSBcIlNpZ25hdHVyZVJlcXVlc3RFcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfU2lnbmF0dXJlUmVxdWVzdEVycm9yLnByb3RvdHlwZSk7XG4gIH1cbn07XG52YXIgVW5leHBlY3RlZFNpZ25hdHVyZVJlc3BvbnNlRXJyb3IgPSBjbGFzcyBfVW5leHBlY3RlZFNpZ25hdHVyZVJlc3BvbnNlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1pc3NpbmdGaWVsZHMpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gYE1pc3NpbmcgdGhlIGZvbGxvd2luZyBmaWVsZHM6ICR7bWlzc2luZ0ZpZWxkcy5qb2luKFwiLCBcIil9YDtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIlVuZXhwZWN0ZWRTaWduYXR1cmVSZXNwb25zZUVycm9yXCI7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIF9VbmV4cGVjdGVkU2lnbmF0dXJlUmVzcG9uc2VFcnJvci5wcm90b3R5cGUpO1xuICB9XG59O1xudmFyIFBhaXJpbmdFeHBpcmVkRXJyb3IgPSBjbGFzcyBfUGFpcmluZ0V4cGlyZWRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLm5hbWUgPSBcIlBhaXJpbmdFeHBpcmVkRXJyb3JcIjtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgX1BhaXJpbmdFeHBpcmVkRXJyb3IucHJvdG90eXBlKTtcbiAgfVxufTtcbnZhciBVbnJlZ2lzdGVyZWREYXBwRXJyb3IgPSBjbGFzcyBfVW5yZWdpc3RlcmVkRGFwcEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihcIkRhcHAgSUQgaXMgaW52YWxpZCBvciBub3QgYXNzb2NpYXRlZCB3aXRoIGEgcmVnaXN0ZXJlZCBEYXBwLlwiKTtcbiAgICB0aGlzLm5hbWUgPSBcIlVucmVnaXN0ZXJlZERhcHBFcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfVW5yZWdpc3RlcmVkRGFwcEVycm9yLnByb3RvdHlwZSk7XG4gIH1cbn07XG5cbi8vIHNyYy9zdGF0ZS50c1xudmFyIERBUFBfUEFJUklOR1NfV0lORE9XX1NUT1JBR0VfS0VZID0gXCJpY0RhcHBQYWlyaW5nc1wiO1xudmFyIHdpbmRvd1N0YXRlQWNjZXNzb3JzID0ge1xuICBhc3luYyBnZXQoYWRkcmVzcykge1xuICAgIGNvbnN0IHBhaXJpbmdzID0gYXdhaXQgdGhpcy5nZXRBbGwoKTtcbiAgICByZXR1cm4gcGFpcmluZ3NbYWRkcmVzc107XG4gIH0sXG4gIGFzeW5jIGdldEFsbCgpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKERBUFBfUEFJUklOR1NfV0lORE9XX1NUT1JBR0VfS0VZKTtcbiAgICByZXR1cm4gc2VyaWFsaXplZCA/IEpTT04ucGFyc2Uoc2VyaWFsaXplZCkgOiB7fTtcbiAgfSxcbiAgYXN5bmMgdXBkYXRlKGFkZHJlc3MsIHBhaXJpbmcpIHtcbiAgICBjb25zdCBwYWlyaW5ncyA9IGF3YWl0IHRoaXMuZ2V0QWxsKCk7XG4gICAgaWYgKHBhaXJpbmcgPT09IHZvaWQgMCkge1xuICAgICAgZGVsZXRlIHBhaXJpbmdzW2FkZHJlc3NdO1xuICAgIH0gZWxzZSB7XG4gICAgICBwYWlyaW5nc1thZGRyZXNzXSA9IHBhaXJpbmc7XG4gICAgfVxuICAgIGNvbnN0IG5ld1NlcmlhbGl6ZWQgPSBKU09OLnN0cmluZ2lmeShwYWlyaW5ncyk7XG4gICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKERBUFBfUEFJUklOR1NfV0lORE9XX1NUT1JBR0VfS0VZLCBuZXdTZXJpYWxpemVkKTtcbiAgfVxufTtcblxuLy8gc3JjL3V0aWxzLnRzXG52YXIgU0lHTl9NRVNTQUdFX1JFU1BPTlNFX1JFUVVJUkVEX0ZJRUxEUyA9IFtcbiAgXCJhZGRyZXNzXCIsXG4gIFwiYXBwbGljYXRpb25cIixcbiAgXCJjaGFpbklkXCIsXG4gIFwiZnVsbE1lc3NhZ2VcIixcbiAgXCJtZXNzYWdlXCIsXG4gIFwibm9uY2VcIixcbiAgXCJwcmVmaXhcIixcbiAgXCJzaWduYXR1cmVcIlxuXTtcbmZ1bmN0aW9uIHZhbGlkYXRlU2lnbk1lc3NhZ2VSZXNwb25zZShyZXNwb25zZSkge1xuICBjb25zdCBwcm92aWRlZEZpZWxkcyA9IG5ldyBTZXQoT2JqZWN0LmtleXMocmVzcG9uc2UpKTtcbiAgY29uc3QgbWlzc2luZ0ZpZWxkcyA9IFNJR05fTUVTU0FHRV9SRVNQT05TRV9SRVFVSVJFRF9GSUVMRFMuZmlsdGVyKChmaWVsZCkgPT4gIXByb3ZpZGVkRmllbGRzLmhhcyhmaWVsZCkpO1xuICBpZiAobWlzc2luZ0ZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRTaWduYXR1cmVSZXNwb25zZUVycm9yKG1pc3NpbmdGaWVsZHMpO1xuICB9XG59XG52YXIgU0lHTl9BTkRfU1VCTUlUX1RSQU5TQUNUSU9OX1JFU1BPTlNFX1JFUVVJUkVEX0ZJRUxEUyA9IFtcImhhc2hcIl07XG5mdW5jdGlvbiB2YWxpZGF0ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlKHJlc3BvbnNlKSB7XG4gIGNvbnN0IHByb3ZpZGVkRmllbGRzID0gbmV3IFNldChPYmplY3Qua2V5cyhyZXNwb25zZSkpO1xuICBjb25zdCBtaXNzaW5nRmllbGRzID0gU0lHTl9BTkRfU1VCTUlUX1RSQU5TQUNUSU9OX1JFU1BPTlNFX1JFUVVJUkVEX0ZJRUxEUy5maWx0ZXIoXG4gICAgKGZpZWxkKSA9PiAhcHJvdmlkZWRGaWVsZHMuaGFzKGZpZWxkKVxuICApO1xuICBpZiAobWlzc2luZ0ZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRTaWduYXR1cmVSZXNwb25zZUVycm9yKG1pc3NpbmdGaWVsZHMpO1xuICB9XG59XG5cbi8vIHNyYy9QYWlyaW5nQ2xpZW50LnRzXG52YXIgQVBJX1ZFUlNJT04gPSBcIjAuMi4wXCI7XG52YXIgU0lHTklOR19SRVFVRVNUX1BPTExJTkdfSU5URVJWQUwgPSAyNTAwO1xudmFyIFNFUVVFTkNFX05VTUJFUl9NSVNNQVRDSF9QQVRURVJOID0gL15TZXF1ZW5jZSBudW1iZXIgbWlzbWF0Y2gsIGV4cGVjdGVkICg/OlxcUysgdG8gYmUgKT8oXFxkKykvO1xuYXN5bmMgZnVuY3Rpb24gd2FpdEZvcihtaWxsaXNlY29uZHMpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgc2V0VGltZW91dChyZXNvbHZlLCBtaWxsaXNlY29uZHMpO1xuICB9KTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHdpdGhSZXRyaWVzKHJlcXVlc3RGbiwgb25FcnJvciwgcmV0cmllcyA9IDEpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXRyaWVzOyBpICs9IDEpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHJlcXVlc3RGbigpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgb25FcnJvcihlcnIpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVxdWVzdEZuKCk7XG59XG52YXIgQUNQYWlyaW5nQ2xpZW50ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgYWNjZXNzb3JzID0gd2luZG93U3RhdGVBY2Nlc3NvcnMsXG4gICAgYXhpb3NDb25maWcsXG4gICAgZGVmYXVsdE5ldHdvcmtOYW1lID0gTmV0d29ya05hbWUuTUFJTk5FVFxuICB9ID0ge30pIHtcbiAgICAvLyBlbmRyZWdpb25cbiAgICB0aGlzLm9uRGlzY29ubmVjdExpc3RlbmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gICAgdGhpcy5hY2Nlc3NvcnMgPSBhY2Nlc3NvcnM7XG4gICAgdGhpcy5kZWZhdWx0TmV0d29ya05hbWUgPSBkZWZhdWx0TmV0d29ya05hbWU7XG4gICAgdGhpcy5heGlvc0luc3RhbmNlID0gYXhpb3MuY3JlYXRlKHtcbiAgICAgIGJhc2VVUkw6IERFRkFVTFRfRlJPTlRFTkRfVVJMLFxuICAgICAgLi4uYXhpb3NDb25maWdcbiAgICB9KTtcbiAgICBjb25zdCBpc0NsaWVudFNpZGVSZW5kZXJpbmcgPSB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiO1xuICAgIHRoaXMuaW5pdFByb21pc2UgPSBpc0NsaWVudFNpZGVSZW5kZXJpbmcgPyB0aGlzLnN5bmNGaXJzdFBhaXJpbmcoKSA6IHZvaWQgMDtcbiAgfVxuICBhc3luYyBnZXRQYWlyaW5nKGlkKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmF4aW9zSW5zdGFuY2UuZ2V0KGB2MS9wYWlyaW5nLyR7aWR9L2ApO1xuICAgIHJldHVybiByZXNwb25zZS5kYXRhLmRhdGEucGFpcmluZztcbiAgfVxuICBhc3luYyBzeW5jRmlyc3RQYWlyaW5nKCkge1xuICAgIGNvbnN0IHBhaXJpbmdzID0gYXdhaXQgdGhpcy5hY2Nlc3NvcnMuZ2V0QWxsKCk7XG4gICAgY29uc3QgZmlyc3RQYWlyaW5nID0gT2JqZWN0LnZhbHVlcyhwYWlyaW5ncylbMF07XG4gICAgaWYgKGZpcnN0UGFpcmluZyA9PT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhcHBTcGVjaWZpY1dhbGxldCwgbWF4RGFwcFNlcXVlbmNlTnVtYmVyIH0gPSBhd2FpdCB0aGlzLmdldFBhaXJpbmcoZmlyc3RQYWlyaW5nLnBhaXJpbmdJZCk7XG4gICAgICBhd2FpdCB0aGlzLmFjY2Vzc29ycy51cGRhdGUoZmlyc3RQYWlyaW5nLmFjY291bnRBZGRyZXNzLCB7XG4gICAgICAgIC4uLmZpcnN0UGFpcmluZyxcbiAgICAgICAgY3VyclNlcXVlbmNlTnVtYmVyOiBtYXhEYXBwU2VxdWVuY2VOdW1iZXIsXG4gICAgICAgIGRhcHBXYWxsZXRJZDogZGFwcFNwZWNpZmljV2FsbGV0Py5pZFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBhd2FpdCB0aGlzLmFjY2Vzc29ycy51cGRhdGUoZmlyc3RQYWlyaW5nLmFjY291bnRBZGRyZXNzLCB2b2lkIDApO1xuICAgIH1cbiAgfVxuICBhc3luYyBjcmVhdGVTaWduaW5nUmVxdWVzdChwYWlyaW5nLCB0eXBlLCBuZXR3b3JrTmFtZSwgcmVxdWVzdEJvZHkpIHtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVNlY3JldEtleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5U2VjcmV0S2V5QjY0KTtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVB1YmxpY0tleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5UHVibGljS2V5QjY0KTtcbiAgICBjb25zdCBhY2NvdW50VHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmFjY291bnRUcmFuc3BvcnRFZDI1NTE5UHVibGljS2V5QjY0KTtcbiAgICBsZXQgc2VxdWVuY2VOdW1iZXIgPSBwYWlyaW5nLmN1cnJTZXF1ZW5jZU51bWJlciArIDE7XG4gICAgcmV0dXJuIHdpdGhSZXRyaWVzKFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCByZXF1ZXN0RW52ZWxvcGUgPSBhd2FpdCBlbmNyeXB0QW5kU2lnbkVudmVsb3BlKFxuICAgICAgICAgIHRvS2V5KGRhcHBFZDI1NTE5U2VjcmV0S2V5LCBLZXlUeXBlcy5FZDI1NTE5U2VjcmV0S2V5KSxcbiAgICAgICAgICB0b0tleShkYXBwRWQyNTUxOVB1YmxpY0tleSwgS2V5VHlwZXMuRWQyNTUxOVB1YmxpY0tleSksXG4gICAgICAgICAgdG9LZXkoYWNjb3VudFRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXksIEtleVR5cGVzLkVkMjU1MTlQdWJsaWNLZXkpLFxuICAgICAgICAgIHNlcXVlbmNlTnVtYmVyLFxuICAgICAgICAgIHsgYXBpVmVyc2lvbjogQVBJX1ZFUlNJT04sIG5ldHdvcmtOYW1lLCByZXF1ZXN0VHlwZTogdHlwZSB9LFxuICAgICAgICAgIHJlcXVlc3RCb2R5XG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5heGlvc0luc3RhbmNlLnBvc3QoXG4gICAgICAgICAgYHYxL3BhaXJpbmcvJHtwYWlyaW5nLnBhaXJpbmdJZH0vc2lnbmluZy1yZXF1ZXN0L2AsXG4gICAgICAgICAgcmVxdWVzdEVudmVsb3BlXG4gICAgICAgICk7XG4gICAgICAgIGF3YWl0IHRoaXMuYWNjZXNzb3JzLnVwZGF0ZShwYWlyaW5nLmFjY291bnRBZGRyZXNzLCB7XG4gICAgICAgICAgLi4ucGFpcmluZyxcbiAgICAgICAgICBjdXJyU2VxdWVuY2VOdW1iZXI6IHNlcXVlbmNlTnVtYmVyXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5kYXRhLnNpZ25pbmdSZXF1ZXN0O1xuICAgICAgfSxcbiAgICAgIChlcnIpID0+IHtcbiAgICAgICAgaWYgKGlzQXhpb3NFcnJvcihlcnIpKSB7XG4gICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlO1xuICAgICAgICAgIGNvbnN0IGV4cGVjdGVkU2VxdWVuY2VOdW1iZXIgPSBlcnJvck1lc3NhZ2U/Lm1hdGNoKFNFUVVFTkNFX05VTUJFUl9NSVNNQVRDSF9QQVRURVJOKT8uWzFdO1xuICAgICAgICAgIGlmIChleHBlY3RlZFNlcXVlbmNlTnVtYmVyICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyID0gTnVtYmVyKGV4cGVjdGVkU2VxdWVuY2VOdW1iZXIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgKTtcbiAgfVxuICBhc3luYyBnZXRTaWduaW5nUmVxdWVzdChpZCkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5heGlvc0luc3RhbmNlLmdldChcbiAgICAgIGB2MS9zaWduaW5nLXJlcXVlc3QvJHtpZH0vYCxcbiAgICAgIHtcbiAgICAgICAgdmFsaWRhdGVTdGF0dXM6IChzdGF0dXMpID0+IHN0YXR1cyA9PT0gMjAwIHx8IHN0YXR1cyA9PT0gNDA0XG4gICAgICB9XG4gICAgKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YT8uZGF0YT8uc2lnbmluZ1JlcXVlc3Q7XG4gIH1cbiAgYXN5bmMgZGVsZXRlUGFpcmluZyhwYWlyaW5nSWQsIHNlY3JldEtleSwgcHVibGljS2V5KSB7XG4gICAgY29uc3QgcmVxdWVzdEVudmVsb3BlID0gYXdhaXQgZW5jcnlwdEFuZFNpZ25FbnZlbG9wZShcbiAgICAgIHNlY3JldEtleSxcbiAgICAgIHB1YmxpY0tleSxcbiAgICAgIHB1YmxpY0tleSxcbiAgICAgIDAsXG4gICAgICAvLyBpZ25vcmVkXG4gICAgICB7fSxcbiAgICAgIHt9XG4gICAgKTtcbiAgICBhd2FpdCB0aGlzLmF4aW9zSW5zdGFuY2UucG9zdChcbiAgICAgIGB2MS9wYWlyaW5nLyR7cGFpcmluZ0lkfS9kZWxldGUvYCxcbiAgICAgIHJlcXVlc3RFbnZlbG9wZSxcbiAgICAgIHsgdmFsaWRhdGVTdGF0dXM6IChzdGF0dXMpID0+IHN0YXR1cyA9PT0gMjA0IHx8IHN0YXR1cyA9PT0gNDA0IH1cbiAgICApO1xuICB9XG4gIGFzeW5jIGNhbmNlbFNpZ25pbmdSZXF1ZXN0KHBhaXJpbmcsIGlkKSB7XG4gICAgY29uc3Qgc2VxdWVuY2VOdW1iZXIgPSBwYWlyaW5nLmN1cnJTZXF1ZW5jZU51bWJlcjtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVNlY3JldEtleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5U2VjcmV0S2V5QjY0KTtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVB1YmxpY0tleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5UHVibGljS2V5QjY0KTtcbiAgICBjb25zdCBhY2NvdW50VHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmFjY291bnRUcmFuc3BvcnRFZDI1NTE5UHVibGljS2V5QjY0KTtcbiAgICBjb25zdCByZXF1ZXN0RW52ZWxvcGUgPSBhd2FpdCBlbmNyeXB0QW5kU2lnbkVudmVsb3BlKFxuICAgICAgdG9LZXkoZGFwcEVkMjU1MTlTZWNyZXRLZXksIEtleVR5cGVzLkVkMjU1MTlTZWNyZXRLZXkpLFxuICAgICAgdG9LZXkoZGFwcEVkMjU1MTlQdWJsaWNLZXksIEtleVR5cGVzLkVkMjU1MTlQdWJsaWNLZXkpLFxuICAgICAgdG9LZXkoYWNjb3VudFRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXksIEtleVR5cGVzLkVkMjU1MTlQdWJsaWNLZXkpLFxuICAgICAgc2VxdWVuY2VOdW1iZXIgKyAxLFxuICAgICAge30sXG4gICAgICB7fVxuICAgICk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmF4aW9zSW5zdGFuY2UucGF0Y2goXG4gICAgICBgdjEvc2lnbmluZy1yZXF1ZXN0LyR7aWR9L2NhbmNlbC9gLFxuICAgICAgcmVxdWVzdEVudmVsb3BlXG4gICAgKTtcbiAgICBhd2FpdCB0aGlzLmFjY2Vzc29ycy51cGRhdGUocGFpcmluZy5hY2NvdW50QWRkcmVzcywge1xuICAgICAgLi4ucGFpcmluZyxcbiAgICAgIGN1cnJTZXF1ZW5jZU51bWJlcjogc2VxdWVuY2VOdW1iZXIgKyAxXG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEuZGF0YS5zaWduaW5nUmVxdWVzdDtcbiAgfVxuICBhc3luYyBzaWduUmVxdWVzdChhZGRyZXNzLCB0eXBlLCByZXF1ZXN0Qm9keSwgeyBjYW5jZWxUb2tlbiwgbmV0d29ya05hbWUgfSA9IHt9KSB7XG4gICAgYXdhaXQgdGhpcy5pbml0UHJvbWlzZTtcbiAgICBjb25zdCBwYWlyaW5nID0gYXdhaXQgdGhpcy5hY2Nlc3NvcnMuZ2V0KGFkZHJlc3MpO1xuICAgIGlmIChwYWlyaW5nID09PSB2b2lkIDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSByZXF1ZXN0ZWQgYWNjb3VudCBpcyBub3QgcGFpcmVkXCIpO1xuICAgIH1cbiAgICBsZXQgc2lnbmluZ1JlcXVlc3Q7XG4gICAgdHJ5IHtcbiAgICAgIHNpZ25pbmdSZXF1ZXN0ID0gYXdhaXQgdGhpcy5jcmVhdGVTaWduaW5nUmVxdWVzdChcbiAgICAgICAgcGFpcmluZyxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgbmV0d29ya05hbWUgfHwgdGhpcy5kZWZhdWx0TmV0d29ya05hbWUsXG4gICAgICAgIHJlcXVlc3RCb2R5XG4gICAgICApO1xuICAgICAgd2hpbGUgKHNpZ25pbmdSZXF1ZXN0LnN0YXR1cyA9PT0gXCJQRU5ESU5HXCIpIHtcbiAgICAgICAgYXdhaXQgd2FpdEZvcihTSUdOSU5HX1JFUVVFU1RfUE9MTElOR19JTlRFUlZBTCk7XG4gICAgICAgIGlmIChjYW5jZWxUb2tlbj8uY2FuY2VsbGVkKSB7XG4gICAgICAgICAgc2lnbmluZ1JlcXVlc3Quc3RhdHVzID0gU2lnbmluZ1JlcXVlc3RTdGF0dXMuQ0FOQ0VMTEVEO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHNpZ25pbmdSZXF1ZXN0ID0gYXdhaXQgdGhpcy5nZXRTaWduaW5nUmVxdWVzdChzaWduaW5nUmVxdWVzdC5pZCkgPz8gc2lnbmluZ1JlcXVlc3Q7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoaXNBeGlvc0Vycm9yKGVycikgJiYgZXJyLmNvZGUgPT09IFwiNDA0XCIpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5hY2Nlc3NvcnMudXBkYXRlKGFkZHJlc3MsIHZvaWQgMCk7XG4gICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgdGhpcy5vbkRpc2Nvbm5lY3RMaXN0ZW5lcnMpIHtcbiAgICAgICAgICBsaXN0ZW5lcihhZGRyZXNzKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgUGFpcmluZ0V4cGlyZWRFcnJvcigpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICBpZiAoc2lnbmluZ1JlcXVlc3Quc3RhdHVzICE9PSBcIkFQUFJPVkVEXCIpIHtcbiAgICAgIHRocm93IG5ldyBTaWduYXR1cmVSZXF1ZXN0RXJyb3Ioc2lnbmluZ1JlcXVlc3Quc3RhdHVzKTtcbiAgICB9XG4gICAgY29uc3QgZGVjcnlwdGVkID0gZGVjcnlwdEVudmVsb3BlKFxuICAgICAgdG9LZXkoZGVjb2RlQmFzZTY0KHBhaXJpbmcuYWNjb3VudFRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXlCNjQpLCBLZXlUeXBlcy5FZDI1NTE5UHVibGljS2V5KSxcbiAgICAgIHRvS2V5KGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5U2VjcmV0S2V5QjY0KSwgS2V5VHlwZXMuRWQyNTUxOVNlY3JldEtleSksXG4gICAgICBzaWduaW5nUmVxdWVzdC5yZXNwb25zZUVudmVsb3BlXG4gICAgKTtcbiAgICByZXR1cm4gZGVjcnlwdGVkLnByaXZhdGVNZXNzYWdlO1xuICB9XG4gIC8vIHJlZ2lvbiBQdWJsaWMgQVBJXG4gIC8qKlxuICAgKiBSZXF1ZXN0cyBhIGNvbm5lY3Rpb24gdG8gYW4gYWNjb3VudCAoaW50ZXJuYWxseSBrbm93biBhcyBwYWlyaW5nKS5cbiAgICogQHJldHVybnMgZWl0aGVyIHRoZSBhZGRyZXNzIG9mIHRoZSBjb25uZWN0ZWQgYWNjb3VudCwgb3IgdW5kZWZpbmVkIGlmIHRoZVxuICAgKiBjb25uZWN0aW9uIHdhcyBjYW5jZWxsZWQuXG4gICAqL1xuICBhc3luYyBhZGRQYWlyaW5nKHsgcHVibGljS2V5LCBzZWNyZXRLZXkgfSwgZmluYWxpemVkUGFpcmluZykge1xuICAgIGF3YWl0IHRoaXMuYWNjZXNzb3JzLnVwZGF0ZShmaW5hbGl6ZWRQYWlyaW5nLmFjY291bnQuYWNjb3VudEFkZHJlc3MsIHtcbiAgICAgIGFjY291bnRBZGRyZXNzOiBmaW5hbGl6ZWRQYWlyaW5nLmFjY291bnQuYWNjb3VudEFkZHJlc3MsXG4gICAgICBhY2NvdW50QWxpYXM6IGZpbmFsaXplZFBhaXJpbmcuYWNjb3VudC51c2VyU3VibWl0dGVkQWxpYXMgPz8gdm9pZCAwLFxuICAgICAgYWNjb3VudFB1YmxpY0tleUI2NDogZmluYWxpemVkUGFpcmluZy5hY2NvdW50LnB1YmxpY0tleUI2NCxcbiAgICAgIGFjY291bnRUcmFuc3BvcnRFZDI1NTE5UHVibGljS2V5QjY0OiBmaW5hbGl6ZWRQYWlyaW5nLmFjY291bnQudHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleUI2NCxcbiAgICAgIGN1cnJTZXF1ZW5jZU51bWJlcjogZmluYWxpemVkUGFpcmluZy5tYXhEYXBwU2VxdWVuY2VOdW1iZXIsXG4gICAgICBkYXBwRWQyNTUxOVB1YmxpY0tleUI2NDogZW5jb2RlQmFzZTY0KHB1YmxpY0tleS5rZXkpLFxuICAgICAgZGFwcEVkMjU1MTlTZWNyZXRLZXlCNjQ6IGVuY29kZUJhc2U2NChzZWNyZXRLZXkua2V5KSxcbiAgICAgIGRhcHBXYWxsZXRJZDogZmluYWxpemVkUGFpcmluZy5kYXBwU3BlY2lmaWNXYWxsZXRJZCxcbiAgICAgIHBhaXJpbmdJZDogZmluYWxpemVkUGFpcmluZy5pZFxuICAgIH0pO1xuICB9XG4gIGFzeW5jIGRpc2Nvbm5lY3QoYWRkcmVzcykge1xuICAgIGNvbnN0IHBhaXJpbmcgPSBhd2FpdCB0aGlzLmFjY2Vzc29ycy5nZXQoYWRkcmVzcyk7XG4gICAgaWYgKHBhaXJpbmcgPT09IHZvaWQgMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHNwZWNpZmllZCBhY2NvdW50IGlzIG5vdCBwYWlyZWRcIik7XG4gICAgfVxuICAgIGNvbnN0IGRhcHBFZDI1NTE5U2VjcmV0S2V5ID0gZGVjb2RlQmFzZTY0KHBhaXJpbmcuZGFwcEVkMjU1MTlTZWNyZXRLZXlCNjQpO1xuICAgIGNvbnN0IGRhcHBFZDI1NTE5UHVibGljS2V5ID0gZGVjb2RlQmFzZTY0KHBhaXJpbmcuZGFwcEVkMjU1MTlQdWJsaWNLZXlCNjQpO1xuICAgIGF3YWl0IHRoaXMuZGVsZXRlUGFpcmluZyhcbiAgICAgIHBhaXJpbmcucGFpcmluZ0lkLFxuICAgICAgdG9LZXkoZGFwcEVkMjU1MTlTZWNyZXRLZXksIEtleVR5cGVzLkVkMjU1MTlTZWNyZXRLZXkpLFxuICAgICAgdG9LZXkoZGFwcEVkMjU1MTlQdWJsaWNLZXksIEtleVR5cGVzLkVkMjU1MTlQdWJsaWNLZXkpXG4gICAgKTtcbiAgICBhd2FpdCB0aGlzLmFjY2Vzc29ycy51cGRhdGUoYWRkcmVzcywgdm9pZCAwKTtcbiAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIHRoaXMub25EaXNjb25uZWN0TGlzdGVuZXJzKSB7XG4gICAgICBsaXN0ZW5lcihhZGRyZXNzKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgc2lnbk1lc3NhZ2UoYWRkcmVzcywgYXJncywgb3B0aW9ucykge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5zaWduUmVxdWVzdChcbiAgICAgIGFkZHJlc3MsXG4gICAgICBTaWduaW5nUmVxdWVzdFR5cGVzLlNJR05fTUVTU0FHRSxcbiAgICAgIGFyZ3MsXG4gICAgICBvcHRpb25zXG4gICAgKTtcbiAgICB2YWxpZGF0ZVNpZ25NZXNzYWdlUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZTtcbiAgfVxuICBhc3luYyBzaWduVHJhbnNhY3Rpb24oYWRkcmVzcywgYXJncywgb3B0aW9ucykge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0QXJncyA9IHNlcmlhbGl6ZVNpZ25UcmFuc2FjdGlvblJlcXVlc3RBcmdzKGFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZUFyZ3MgPSBhd2FpdCB0aGlzLnNpZ25SZXF1ZXN0KGFkZHJlc3MsIFNpZ25pbmdSZXF1ZXN0VHlwZXMuU0lHTl9UUkFOU0FDVElPTiwgc2VyaWFsaXplZFJlcXVlc3RBcmdzLCBvcHRpb25zKTtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3Moc2VyaWFsaXplZFJlc3BvbnNlQXJncyk7XG4gIH1cbiAgLy8gZW5kcmVnaW9uXG4gIGFzeW5jIHNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvbihhZGRyZXNzLCBhcmdzLCBvcHRpb25zKSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3RBcmdzID0gc2VyaWFsaXplU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MoYXJncyk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlQXJncyA9IGF3YWl0IHRoaXMuc2lnblJlcXVlc3QoYWRkcmVzcywgU2lnbmluZ1JlcXVlc3RUeXBlcy5TSUdOX0FORF9TVUJNSVRfVFJBTlNBQ1RJT04sIHNlcmlhbGl6ZWRSZXF1ZXN0QXJncywgb3B0aW9ucyk7XG4gICAgICB2YWxpZGF0ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlKHJlc3BvbnNlQXJncyk7XG4gICAgICByZXR1cm4gcmVzcG9uc2VBcmdzO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmIChlIGluc3RhbmNlb2YgQXhpb3NFcnJvciAmJiBlLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGU7XG4gICAgfVxuICB9XG4gIGFzeW5jIGdldENvbm5lY3RlZEFjY291bnRzKCkge1xuICAgIGF3YWl0IHRoaXMuaW5pdFByb21pc2U7XG4gICAgY29uc3QgcGFpcmluZ3MgPSBhd2FpdCB0aGlzLmFjY2Vzc29ycy5nZXRBbGwoKTtcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhwYWlyaW5ncykubWFwKFxuICAgICAgKHsgYWNjb3VudEFkZHJlc3MsIGFjY291bnRFZDI1NTE5UHVibGljS2V5QjY0LCBhY2NvdW50UHVibGljS2V5QjY0IH0pID0+ICh7XG4gICAgICAgIGFkZHJlc3M6IEFjY291bnRBZGRyZXNzLmZyb20oYWNjb3VudEFkZHJlc3MpLFxuICAgICAgICBwdWJsaWNLZXk6IGFjY291bnRQdWJsaWNLZXlCNjQgIT09IHZvaWQgMCA/IGRlc2VyaWFsaXplUHVibGljS2V5QjY0KGFjY291bnRQdWJsaWNLZXlCNjQpIDogZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0KGFjY291bnRFZDI1NTE5UHVibGljS2V5QjY0KVxuICAgICAgfSlcbiAgICApO1xuICB9XG4gIG9uRGlzY29ubmVjdChsaXN0ZW5lcikge1xuICAgIHRoaXMub25EaXNjb25uZWN0TGlzdGVuZXJzLmFkZChsaXN0ZW5lcik7XG4gICAgcmV0dXJuICgpID0+IHRoaXMub25EaXNjb25uZWN0TGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lcik7XG4gIH1cbn07XG5cbi8vIHNyYy9BQ0RhcHBDbGllbnQudHNcbnZhciBBQ0RhcHBDbGllbnQgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHtcbiAgICBiYWNrZW5kQmFzZVVSTCxcbiAgICBkYXBwSWQsXG4gICAgZGFwcEltYWdlVVJJLFxuICAgIGRhcHBOYW1lLFxuICAgIGRlZmF1bHROZXR3b3JrTmFtZSA9IE5ldHdvcmtOYW1lMi5NQUlOTkVULFxuICAgIGZyb250ZW5kQmFzZVVSTCA9IERFRkFVTFRfRlJPTlRFTkRfVVJMXG4gIH0gPSB7fSkge1xuICAgIHRoaXMuZGVmYXVsdE5ldHdvcmtOYW1lID0gZGVmYXVsdE5ldHdvcmtOYW1lO1xuICAgIHRoaXMuZGFwcEluZm8gPSB7XG4gICAgICBkb21haW46IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sXG4gICAgICBpbWFnZVVSSTogZGFwcEltYWdlVVJJLFxuICAgICAgbmFtZTogZGFwcE5hbWUgPz8gZG9jdW1lbnQudGl0bGVcbiAgICB9O1xuICAgIHRoaXMudHJhbnNwb3J0ID0gbmV3IFdlYldhbGxldFRyYW5zcG9ydChmcm9udGVuZEJhc2VVUkwpO1xuICAgIHRoaXMuZGFwcElkID0gZGFwcElkO1xuICAgIHRoaXMucGFpcmluZ0NsaWVudCA9IG5ldyBBQ1BhaXJpbmdDbGllbnQoe1xuICAgICAgYXhpb3NDb25maWc6IHtcbiAgICAgICAgYmFzZVVSTDogYmFja2VuZEJhc2VVUkwgPz8gZnJvbnRlbmRCYXNlVVJMXG4gICAgICB9LFxuICAgICAgZGVmYXVsdE5ldHdvcmtOYW1lXG4gICAgfSk7XG4gIH1cbiAgLy8gcmVnaW9uIFB1YmxpYyBBUElcbiAgYXN5bmMgZ2V0S2V5bGVzc0FjY291bnRzKCkge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0LnNlcmlhbGl6ZSh0aGlzLmRhcHBJbmZvKTtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRyYW5zcG9ydC5zZW5kUmVxdWVzdChzZXJpYWxpemVkUmVxdWVzdCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBHZXRDb25uZWN0ZWRBY2NvdW50c1Jlc3BvbnNlLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmFyZ3M7XG4gIH1cbiAgYXN5bmMgZ2V0SWNBY2NvdW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5wYWlyaW5nQ2xpZW50LmdldENvbm5lY3RlZEFjY291bnRzKCkgPz8gW107XG4gIH1cbiAgYXN5bmMgaXNJY0FjY291bnQoYWRkcmVzcykge1xuICAgIGNvbnN0IGljQWNjb3VudHMgPSBhd2FpdCB0aGlzLmdldEljQWNjb3VudHMoKTtcbiAgICByZXR1cm4gaWNBY2NvdW50cy5maW5kKChhY2NvdW50KSA9PiBhY2NvdW50LmFkZHJlc3MuZXF1YWxzKEFjY291bnRBZGRyZXNzMi5mcm9tKGFkZHJlc3MpKSkgIT09IHZvaWQgMDtcbiAgfVxuICBhc3luYyBnZXRDb25uZWN0ZWRBY2NvdW50cygpIHtcbiAgICBjb25zdCBrZXlsZXNzQWNjb3VudHMgPSBhd2FpdCB0aGlzLmdldEtleWxlc3NBY2NvdW50cygpO1xuICAgIGNvbnN0IGljQWNjb3VudHMgPSBhd2FpdCB0aGlzLmdldEljQWNjb3VudHMoKTtcbiAgICByZXR1cm4gWy4uLmtleWxlc3NBY2NvdW50cywgLi4uaWNBY2NvdW50c107XG4gIH1cbiAgYXN5bmMgZGlzY29ubmVjdChhZGRyZXNzKSB7XG4gICAgaWYgKGF3YWl0IHRoaXMuaXNJY0FjY291bnQoYWRkcmVzcykpIHtcbiAgICAgIGNvbnN0IHN0cmluZ0FkZHJlc3MgPSBBY2NvdW50QWRkcmVzczIuZnJvbShhZGRyZXNzKS50b1N0cmluZygpO1xuICAgICAgYXdhaXQgdGhpcy5wYWlyaW5nQ2xpZW50LmRpc2Nvbm5lY3Qoc3RyaW5nQWRkcmVzcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gRGlzY29ubmVjdFJlcXVlc3Quc2VyaWFsaXplKHRoaXMuZGFwcEluZm8pO1xuICAgICAgYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIH1cbiAgfVxuICBhc3luYyBjb25uZWN0KCkge1xuICAgIGNvbnN0IGRhcHBLZXlwYWlyID0gY3JlYXRlRWQyNTUxOUtleVBhaXIoKTtcbiAgICBjb25zdCByZXF1ZXN0QXJncyA9IHtcbiAgICAgIGRhcHBFZDI1NTE5UHVibGljS2V5QjY0OiBlbmNvZGVCYXNlNjQyKGRhcHBLZXlwYWlyLnB1YmxpY0tleS5rZXkpLFxuICAgICAgZGFwcElkOiB0aGlzLmRhcHBJZFxuICAgIH07XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBDb25uZWN0UmVxdWVzdC5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgcmVxdWVzdEFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IENvbm5lY3RSZXNwb25zZS5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIGlmIChyZXNwb25zZS5hcmdzLnN0YXR1cyA9PT0gXCJhcHByb3ZlZFwiKSB7XG4gICAgICBjb25zdCB7IGFjY291bnQsIHBhaXJpbmcgfSA9IHJlc3BvbnNlLmFyZ3MuYXJncztcbiAgICAgIGlmIChwYWlyaW5nKSB7XG4gICAgICAgIGF3YWl0IHRoaXMucGFpcmluZ0NsaWVudC5hZGRQYWlyaW5nKGRhcHBLZXlwYWlyLCBwYWlyaW5nKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtYWtlVXNlckFwcHJvdmFsKHsgYWNjb3VudCB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3BvbnNlLmFyZ3M7XG4gIH1cbiAgYXN5bmMgc2lnbk1lc3NhZ2UoYXJncykge1xuICAgIGNvbnN0IHsgc2lnbmVyQWRkcmVzcyB9ID0gYXJncztcbiAgICBpZiAoYXdhaXQgdGhpcy5pc0ljQWNjb3VudChzaWduZXJBZGRyZXNzKSkge1xuICAgICAgY29uc3QgeyBjaGFpbklkIH0gPSBhcmdzO1xuICAgICAgY29uc3QgbmV0d29yayA9IGNoYWluSWRUb05ldHdvcmsoY2hhaW5JZCk7XG4gICAgICBsZXQgbWVzc2FnZTtcbiAgICAgIGxldCBub25jZTtcbiAgICAgIHRyeSB7XG4gICAgICAgIG1lc3NhZ2UgPSBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoYXJncy5tZXNzYWdlKTtcbiAgICAgICAgbm9uY2UgPSBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoYXJncy5ub25jZSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT25seSBVVEYtOCBlbmNvZGVkIHRleHQgaXMgc3VwcG9ydGVkIHdoZW4gdXNpbmcgSUNcIik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGZ1bGxNZXNzYWdlLCBzaWduYXR1cmU6IGhleFNpZ25hdHVyZSB9ID0gYXdhaXQgdGhpcy5wYWlyaW5nQ2xpZW50LnNpZ25NZXNzYWdlKFxuICAgICAgICBzaWduZXJBZGRyZXNzLnRvU3RyaW5nKCksXG4gICAgICAgIHtcbiAgICAgICAgICBhZGRyZXNzOiB0cnVlLFxuICAgICAgICAgIGFwcGxpY2F0aW9uOiB0cnVlLFxuICAgICAgICAgIGNoYWluSWQ6IHRydWUsXG4gICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICBub25jZVxuICAgICAgICB9LFxuICAgICAgICB7IG5ldHdvcmtOYW1lOiBuZXR3b3JrIH1cbiAgICAgICk7XG4gICAgICBjb25zdCBzaWduYXR1cmVCeXRlcyA9IEhleC5mcm9tSGV4SW5wdXQoaGV4U2lnbmF0dXJlKS50b1VpbnQ4QXJyYXkoKTtcbiAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IHNpZ25hdHVyZUJ5dGVzLmxlbmd0aCA9PT0gRWQyNTUxOVNpZ25hdHVyZS5MRU5HVEggPyBuZXcgRWQyNTUxOVNpZ25hdHVyZShzaWduYXR1cmVCeXRlcykgOiBBbnlTaWduYXR1cmUuZGVzZXJpYWxpemUobmV3IERlc2VyaWFsaXplcihzaWduYXR1cmVCeXRlcykpO1xuICAgICAgcmV0dXJuIG1ha2VVc2VyQXBwcm92YWwoe1xuICAgICAgICBmdWxsTWVzc2FnZSxcbiAgICAgICAgc2lnbmF0dXJlXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBTaWduTWVzc2FnZVJlcXVlc3Quc2VyaWFsaXplKHRoaXMuZGFwcEluZm8sIGFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IFNpZ25NZXNzYWdlUmVzcG9uc2UuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICBhc3luYyBzaWduVHJhbnNhY3Rpb24oYXJncykge1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRBcmdzID0gXCJ0cmFuc2FjdGlvblwiIGluIGFyZ3MgPyBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Lm5vcm1hbGl6ZUFyZ3MoYXJncykgOiBhcmdzO1xuICAgIGNvbnN0IHsgc2lnbmVyQWRkcmVzcyB9ID0gYXJncztcbiAgICBpZiAoYXdhaXQgdGhpcy5pc0ljQWNjb3VudChzaWduZXJBZGRyZXNzKSkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBleHBpcmF0aW9uU2Vjb25kc0Zyb21Ob3csXG4gICAgICAgIGV4cGlyYXRpb25UaW1lc3RhbXAsXG4gICAgICAgIGZlZVBheWVyLFxuICAgICAgICBnYXNVbml0UHJpY2UsXG4gICAgICAgIG1heEdhc0Ftb3VudCxcbiAgICAgICAgbmV0d29yayxcbiAgICAgICAgcGF5bG9hZCxcbiAgICAgICAgc2Vjb25kYXJ5U2lnbmVycyxcbiAgICAgICAgc2VuZGVyLFxuICAgICAgICBzZXF1ZW5jZU51bWJlclxuICAgICAgfSA9IG5vcm1hbGl6ZWRBcmdzO1xuICAgICAgaWYgKGZlZVBheWVyICE9PSB2b2lkIDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU3BvbnNvcmVkIHRyYW5zYWN0aW9uIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKHNlY29uZGFyeVNpZ25lcnMgJiYgc2Vjb25kYXJ5U2lnbmVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk11bHRpLWFnZW50IHRyYW5zYWN0aW9ucyBub3QgY3VycmVudGx5IHN1cHBvcnRlZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3BvbnNlQXJncyA9IGF3YWl0IHRoaXMucGFpcmluZ0NsaWVudC5zaWduVHJhbnNhY3Rpb24oXG4gICAgICAgIHNpZ25lckFkZHJlc3MudG9TdHJpbmcoKSxcbiAgICAgICAge1xuICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgIGV4cGlyYXRpb25TZWNvbmRzRnJvbU5vdyxcbiAgICAgICAgICAgIGV4cGlyYXRpb25UaW1lc3RhbXAsXG4gICAgICAgICAgICBnYXNVbml0UHJpY2UsXG4gICAgICAgICAgICBtYXhHYXNBbW91bnQsXG4gICAgICAgICAgICBzZW5kZXI6IHNlbmRlcj8uYWRkcmVzcy50b1N0cmluZygpLFxuICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXI6IHNlcXVlbmNlTnVtYmVyICE9PSB2b2lkIDAgPyBOdW1iZXIoc2VxdWVuY2VOdW1iZXIpIDogdm9pZCAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwYXlsb2FkXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBuZXR3b3JrTmFtZTogbmV0d29ya1xuICAgICAgICB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIG1ha2VVc2VyQXBwcm92YWwoe1xuICAgICAgICBhdXRoZW50aWNhdG9yOiByZXNwb25zZUFyZ3MuYWNjb3VudEF1dGhlbnRpY2F0b3IsXG4gICAgICAgIHJhd1RyYW5zYWN0aW9uOiByZXNwb25zZUFyZ3MucmF3VHhuXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0LnNlcmlhbGl6ZSh0aGlzLmRhcHBJbmZvLCBub3JtYWxpemVkQXJncyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gU2lnblRyYW5zYWN0aW9uUmVzcG9uc2UuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICBhc3luYyBzaWduQW5kU3VibWl0VHJhbnNhY3Rpb24oYXJncykge1xuICAgIGNvbnN0IHsgc2lnbmVyQWRkcmVzcyB9ID0gYXJncztcbiAgICBpZiAoYXdhaXQgdGhpcy5pc0ljQWNjb3VudChzaWduZXJBZGRyZXNzKSkge1xuICAgICAgY29uc3QgeyBleHBpcmF0aW9uVGltZXN0YW1wLCBmZWVQYXllciwgZ2FzVW5pdFByaWNlLCBtYXhHYXNBbW91bnQsIG5ldHdvcmsgfSA9IGFyZ3M7XG4gICAgICBjb25zdCBhcHRvc0NvbmZpZyA9IG5ldyBBcHRvc0NvbmZpZyh7IG5ldHdvcmsgfSk7XG4gICAgICBsZXQgcGF5bG9hZDtcbiAgICAgIGlmIChcImJjc1RvQnl0ZXNcIiBpbiBhcmdzLnBheWxvYWQpIHtcbiAgICAgICAgcGF5bG9hZCA9IGFyZ3MucGF5bG9hZDtcbiAgICAgIH0gZWxzZSBpZiAoXCJieXRlY29kZVwiIGluIGFyZ3MucGF5bG9hZCkge1xuICAgICAgICBwYXlsb2FkID0gYXdhaXQgZ2VuZXJhdGVUcmFuc2FjdGlvblBheWxvYWQoYXJncy5wYXlsb2FkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBheWxvYWQgPSBhcmdzLnBheWxvYWQuYWJpICE9PSB2b2lkIDAgPyBnZW5lcmF0ZVRyYW5zYWN0aW9uUGF5bG9hZFdpdGhBQkkoeyAuLi5hcmdzLnBheWxvYWQsIGFiaTogYXJncy5wYXlsb2FkLmFiaSB9KSA6IGF3YWl0IGdlbmVyYXRlVHJhbnNhY3Rpb25QYXlsb2FkKHsgYXB0b3NDb25maWcsIC4uLmFyZ3MucGF5bG9hZCB9KTtcbiAgICAgIH1cbiAgICAgIGxldCBjb252ZXJ0ZWRBcmdzO1xuICAgICAgaWYgKGZlZVBheWVyICE9PSB2b2lkIDApIHtcbiAgICAgICAgY29uc3QgcmF3VHhuID0gYXdhaXQgZ2VuZXJhdGVSYXdUcmFuc2FjdGlvbih7XG4gICAgICAgICAgYXB0b3NDb25maWcsXG4gICAgICAgICAgZmVlUGF5ZXJBZGRyZXNzOiBmZWVQYXllci5hZGRyZXNzLFxuICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgIGdhc1VuaXRQcmljZSxcbiAgICAgICAgICAgIG1heEdhc0Ftb3VudFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcGF5bG9hZCxcbiAgICAgICAgICBzZW5kZXI6IHNpZ25lckFkZHJlc3NcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnZlcnRlZEFyZ3MgPSB7XG4gICAgICAgICAgZmVlUGF5ZXJBdXRoZW50aWNhdG9yOiBmZWVQYXllci5hdXRoZW50aWNhdG9yLFxuICAgICAgICAgIHJhd1R4bjogbmV3IEZlZVBheWVyUmF3VHJhbnNhY3Rpb24ocmF3VHhuLCBbXSwgZmVlUGF5ZXIuYWRkcmVzcylcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnZlcnRlZEFyZ3MgPSB7XG4gICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgZXhwaXJhdGlvblRpbWVzdGFtcCxcbiAgICAgICAgICAgIGdhc1VuaXRQcmljZSxcbiAgICAgICAgICAgIG1heEdhc0Ftb3VudFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcGF5bG9hZFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgY29uc3QgeyBoYXNoIH0gPSBhd2FpdCB0aGlzLnBhaXJpbmdDbGllbnQuc2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uKHNpZ25lckFkZHJlc3MudG9TdHJpbmcoKSwgY29udmVydGVkQXJncywge1xuICAgICAgICBuZXR3b3JrTmFtZTogbmV0d29ya1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gbWFrZVVzZXJBcHByb3ZhbCh7IHR4bkhhc2g6IGhhc2ggfSk7XG4gICAgfVxuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdC5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgYXJncyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICAvLyBlbmRyZWdpb25cbn07XG5cbi8vIHNyYy9JQ0RhcHBDbGllbnQudHNcbmltcG9ydCB7IGNyZWF0ZUVkMjU1MTlLZXlQYWlyIGFzIGNyZWF0ZUVkMjU1MTlLZXlQYWlyMiwgZW5jb2RlQmFzZTY0IGFzIGVuY29kZUJhc2U2NDMgfSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3QvY3J5cHRvXCI7XG5pbXBvcnQgeyBpc0F4aW9zRXJyb3IgYXMgaXNBeGlvc0Vycm9yMiB9IGZyb20gXCJheGlvc1wiO1xuXG4vLyBzcmMvcHJvbXB0LnRzXG52YXIgREVGQVVMVF9QUk9NUFRfU0laRSA9IHsgaGVpZ2h0OiA2OTUsIHdpZHRoOiA0NjUgfTtcbnZhciBQUk9NUFRfUE9MTEVSX0lOVEVSVkFMID0gNTAwO1xuZnVuY3Rpb24gb3BlblByb21wdCh1cmwsIHNpemUgPSBERUZBVUxUX1BST01QVF9TSVpFKSB7XG4gIGNvbnN0IHsgaGVpZ2h0LCB3aWR0aCB9ID0gc2l6ZTtcbiAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICBoZWlnaHQsXG4gICAgbGVmdDogd2luZG93LnNjcmVlbkxlZnQgKyBNYXRoLnJvdW5kKCh3aW5kb3cub3V0ZXJXaWR0aCAtIHdpZHRoKSAvIDIpLFxuICAgIHBvcHVwOiB0cnVlLFxuICAgIHRvcDogd2luZG93LnNjcmVlblRvcCArIE1hdGgucm91bmQoKHdpbmRvdy5vdXRlckhlaWdodCAtIGhlaWdodCkgLyAyKSxcbiAgICB3aWR0aFxuICB9O1xuICBjb25zdCBzdHJPcHRpb25zID0gT2JqZWN0LmVudHJpZXMob3B0aW9ucykubWFwKChba2V5LCB2YWx1ZV0pID0+IGAke2tleX09JHtKU09OLnN0cmluZ2lmeSh2YWx1ZSl9YCkucmVkdWNlKChhY2MsIGVudHJ5KSA9PiBgJHthY2N9LCAke2VudHJ5fWApO1xuICBjb25zdCBocmVmID0gdXJsIGluc3RhbmNlb2YgVVJMID8gdXJsLmhyZWYgOiB1cmw7XG4gIGNvbnN0IHByb21wdFdpbmRvdyA9IHdpbmRvdy5vcGVuKGhyZWYsIHZvaWQgMCwgc3RyT3B0aW9ucyk7XG4gIGlmIChwcm9tcHRXaW5kb3cgPT09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZG4ndCBvcGVuIHByb21wdFwiKTtcbiAgfVxuICByZXR1cm4gcHJvbXB0V2luZG93O1xufVxuYXN5bmMgZnVuY3Rpb24gd2FpdEZvclByb21wdFJlc3BvbnNlKHByb21wdFdpbmRvdykge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBjb25zdCBsaXN0ZW5lcnMgPSB7XG4gICAgICBvbk1lc3NhZ2U6IChtZXNzYWdlKSA9PiB7XG4gICAgICAgIGlmIChtZXNzYWdlLnNvdXJjZSAhPT0gcHJvbXB0V2luZG93KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBsaXN0ZW5lcnMub25NZXNzYWdlKTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGxpc3RlbmVycy5wcm9tcHRQb2xsZXJJZCk7XG4gICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgIGFyZ3M6IG1lc3NhZ2UuZGF0YSxcbiAgICAgICAgICBzdGF0dXM6IFwiYXBwcm92ZWRcIlxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBwcm9tcHRQb2xsZXJJZDogc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBpZiAocHJvbXB0V2luZG93LmNsb3NlZCkge1xuICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBsaXN0ZW5lcnMub25NZXNzYWdlKTtcbiAgICAgICAgICBjbGVhclRpbWVvdXQobGlzdGVuZXJzLnByb21wdFBvbGxlcklkKTtcbiAgICAgICAgICByZXNvbHZlKHtcbiAgICAgICAgICAgIHN0YXR1czogXCJkaXNtaXNzZWRcIlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCBQUk9NUFRfUE9MTEVSX0lOVEVSVkFMKVxuICAgIH07XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGxpc3RlbmVycy5vbk1lc3NhZ2UpO1xuICB9KTtcbn1cblxuLy8gc3JjL0lDRGFwcENsaWVudC50c1xudmFyIElDRGFwcENsaWVudCA9IGNsYXNzIGV4dGVuZHMgQUNQYWlyaW5nQ2xpZW50IHtcbiAgY29uc3RydWN0b3IoZGFwcElkLCB7IGZyb250ZW5kQmFzZVVSTCA9IERFRkFVTFRfRlJPTlRFTkRfVVJMLCAuLi5wYWlyaW5nQ2xpZW50Q29uZmlnIH0gPSB7fSkge1xuICAgIHN1cGVyKHBhaXJpbmdDbGllbnRDb25maWcpO1xuICAgIHRoaXMuZGFwcElkID0gZGFwcElkO1xuICAgIHRoaXMuZnJvbnRlbmRCYXNlVVJMID0gZnJvbnRlbmRCYXNlVVJMO1xuICB9XG4gIGFzeW5jIGNyZWF0ZVBhaXJpbmdSZXF1ZXN0KGRhcHBFZDI1NTE5UHVibGljS2V5QjY0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5heGlvc0luc3RhbmNlLnBvc3QoXCJ2MS9wYWlyaW5nL1wiLCB7XG4gICAgICAgIGRhcHBFZDI1NTE5UHVibGljS2V5QjY0LFxuICAgICAgICBkYXBwSWQ6IHRoaXMuZGFwcElkXG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhLmRhdGEucGFpcmluZztcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGlmIChpc0F4aW9zRXJyb3IyKGVycikgJiYgZXJyLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlID09PSBcIkRhcHAgbm90IGZvdW5kXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFVucmVnaXN0ZXJlZERhcHBFcnJvcigpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfVxuICAvLyByZWdpb24gUHVibGljIEFQSVxuICAvKipcbiAgICogUmVxdWVzdHMgYSBjb25uZWN0aW9uIHRvIGFuIGFjY291bnQgKGludGVybmFsbHkga25vd24gYXMgcGFpcmluZykuXG4gICAqIEByZXR1cm5zIGVpdGhlciB0aGUgYWRkcmVzcyBvZiB0aGUgY29ubmVjdGVkIGFjY291bnQsIG9yIHVuZGVmaW5lZCBpZiB0aGVcbiAgICogY29ubmVjdGlvbiB3YXMgY2FuY2VsbGVkLlxuICAgKi9cbiAgYXN5bmMgY29ubmVjdCgpIHtcbiAgICBjb25zdCB7IHB1YmxpY0tleSwgc2VjcmV0S2V5IH0gPSBjcmVhdGVFZDI1NTE5S2V5UGFpcjIoKTtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVB1YmxpY0tleUI2NCA9IGVuY29kZUJhc2U2NDMocHVibGljS2V5LmtleSk7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChgJHt0aGlzLmZyb250ZW5kQmFzZVVSTH0vcGFpcmluZ2ApO1xuICAgIGNvbnN0IHByb21wdFdpbmRvdyA9IGF3YWl0IG9wZW5Qcm9tcHQodXJsLmhyZWYpO1xuICAgIGxldCBwYWlyaW5nSWQ7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBlbmRpbmdQYWlyaW5nID0gYXdhaXQgdGhpcy5jcmVhdGVQYWlyaW5nUmVxdWVzdChkYXBwRWQyNTUxOVB1YmxpY0tleUI2NCk7XG4gICAgICBwYWlyaW5nSWQgPSBwZW5kaW5nUGFpcmluZy5pZDtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHByb21wdFdpbmRvdy5jbG9zZSgpO1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInBhaXJpbmdJZFwiLCBwYWlyaW5nSWQpO1xuICAgIHByb21wdFdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdXJsLmhyZWY7XG4gICAgY29uc3QgcHJvbXB0UmVzcG9uc2UgPSBhd2FpdCB3YWl0Rm9yUHJvbXB0UmVzcG9uc2UocHJvbXB0V2luZG93KTtcbiAgICBpZiAocHJvbXB0UmVzcG9uc2Uuc3RhdHVzID09PSBcImRpc21pc3NlZFwiKSB7XG4gICAgICB2b2lkIHRoaXMuZGVsZXRlUGFpcmluZyhwYWlyaW5nSWQsIHNlY3JldEtleSwgcHVibGljS2V5KTtcbiAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxuICAgIGNvbnN0IGZpbmFsaXplZFBhaXJpbmcgPSBwcm9tcHRSZXNwb25zZS5hcmdzO1xuICAgIGF3YWl0IHRoaXMuYWRkUGFpcmluZyh7IHB1YmxpY0tleSwgc2VjcmV0S2V5IH0sIGZpbmFsaXplZFBhaXJpbmcpO1xuICAgIHJldHVybiBmaW5hbGl6ZWRQYWlyaW5nLmFjY291bnQuYWNjb3VudEFkZHJlc3M7XG4gIH1cbiAgYXN5bmMgb2ZmYm9hcmQoYWRkcmVzcykge1xuICAgIGNvbnN0IHBhaXJpbmcgPSBhd2FpdCB0aGlzLmFjY2Vzc29ycy5nZXQoYWRkcmVzcyk7XG4gICAgaWYgKHBhaXJpbmcgPT09IHZvaWQgMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBhY2NvdW50IGlzIG5vdCBwYWlyZWRcIik7XG4gICAgfVxuICAgIGNvbnN0IHdhbGxldElkID0gcGFpcmluZy5kYXBwV2FsbGV0SWQ7XG4gICAgaWYgKHdhbGxldElkID09PSB2b2lkIDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoaXMgYWNjb3VudCBjYW5ub3QgYmUgb2ZmYm9hcmRlZFwiKTtcbiAgICB9XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChgJHt0aGlzLmZyb250ZW5kQmFzZVVSTH0vb2ZmYm9hcmRpbmc/d2FsbGV0SWQ9JHt3YWxsZXRJZH1gKTtcbiAgICBjb25zdCBwcm9tcHRXaW5kb3cgPSBvcGVuUHJvbXB0KHVybCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB3YWl0Rm9yUHJvbXB0UmVzcG9uc2UocHJvbXB0V2luZG93KTtcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSBcImFwcHJvdmVkXCIgJiYgcmVzcG9uc2UuYXJncy5vZmZib2FyZGVkKSB7XG4gICAgICB0aGlzLmRpc2Nvbm5lY3QoYWRkcmVzcyk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIC8vIGVuZHJlZ2lvblxufTtcblxuLy8gc3JjL0tleWxlc3NDbGllbnQudHNcbmltcG9ydCB7XG4gIENvbm5lY3RSZXF1ZXN0IGFzIENvbm5lY3RSZXF1ZXN0MixcbiAgQ29ubmVjdFJlc3BvbnNlIGFzIENvbm5lY3RSZXNwb25zZTIsXG4gIERpc2Nvbm5lY3RSZXF1ZXN0IGFzIERpc2Nvbm5lY3RSZXF1ZXN0MixcbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0IGFzIEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdDIsXG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UgYXMgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZTIsXG4gIElzQ29ubmVjdGVkUmVxdWVzdCxcbiAgSXNDb25uZWN0ZWRSZXNwb25zZSxcbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdCBhcyBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0MixcbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UgYXMgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UyLFxuICBTaWduTWVzc2FnZVJlcXVlc3QgYXMgU2lnbk1lc3NhZ2VSZXF1ZXN0MixcbiAgU2lnbk1lc3NhZ2VSZXNwb25zZSBhcyBTaWduTWVzc2FnZVJlc3BvbnNlMixcbiAgU2lnblRyYW5zYWN0aW9uUmVxdWVzdCBhcyBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0MixcbiAgU2lnblRyYW5zYWN0aW9uUmVzcG9uc2UgYXMgU2lnblRyYW5zYWN0aW9uUmVzcG9uc2UyXG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5pbXBvcnQgeyBXZWJXYWxsZXRUcmFuc3BvcnQgYXMgV2ViV2FsbGV0VHJhbnNwb3J0MiB9IGZyb20gXCJAYXB0b3MtY29ubmVjdC93ZWItdHJhbnNwb3J0XCI7XG5pbXBvcnQgeyBOZXR3b3JrTmFtZSBhcyBOZXR3b3JrTmFtZTMgfSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3QvYXBpXCI7XG52YXIgQUNLZXlsZXNzQ2xpZW50ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgZGFwcEltYWdlVVJJLFxuICAgIGRhcHBOYW1lLFxuICAgIGRlZmF1bHROZXR3b3JrTmFtZSA9IE5ldHdvcmtOYW1lMy5NQUlOTkVULFxuICAgIGZyb250ZW5kQmFzZVVSTCA9IERFRkFVTFRfRlJPTlRFTkRfVVJMXG4gIH0gPSB7fSkge1xuICAgIHRoaXMuZGVmYXVsdE5ldHdvcmtOYW1lID0gZGVmYXVsdE5ldHdvcmtOYW1lO1xuICAgIHRoaXMuZGFwcEluZm8gPSB7XG4gICAgICBkb21haW46IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sXG4gICAgICBpbWFnZVVSSTogZGFwcEltYWdlVVJJLFxuICAgICAgbmFtZTogZGFwcE5hbWUgPz8gZG9jdW1lbnQudGl0bGVcbiAgICB9O1xuICAgIHRoaXMudHJhbnNwb3J0ID0gbmV3IFdlYldhbGxldFRyYW5zcG9ydDIoZnJvbnRlbmRCYXNlVVJMKTtcbiAgfVxuICAvLyByZWdpb24gUHVibGljIEFQSVxuICBhc3luYyBpc0Nvbm5lY3RlZCgpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IElzQ29ubmVjdGVkUmVxdWVzdC5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gSXNDb25uZWN0ZWRSZXNwb25zZS5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIGdldENvbm5lY3RlZEFjY291bnRzKCkge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZTIuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICBhc3luYyBkaXNjb25uZWN0KCkge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gRGlzY29ubmVjdFJlcXVlc3QyLnNlcmlhbGl6ZSh0aGlzLmRhcHBJbmZvKTtcbiAgICBhd2FpdCB0aGlzLnRyYW5zcG9ydC5zZW5kUmVxdWVzdChzZXJpYWxpemVkUmVxdWVzdCk7XG4gIH1cbiAgYXN5bmMgY29ubmVjdCgpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IENvbm5lY3RSZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gQ29ubmVjdFJlc3BvbnNlMi5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIHNpZ25NZXNzYWdlKGFyZ3MpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IFNpZ25NZXNzYWdlUmVxdWVzdDIuc2VyaWFsaXplKHRoaXMuZGFwcEluZm8sIGFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IFNpZ25NZXNzYWdlUmVzcG9uc2UyLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmFyZ3M7XG4gIH1cbiAgYXN5bmMgc2lnblRyYW5zYWN0aW9uKGFyZ3MpIHtcbiAgICBjb25zdCBub3JtYWxpemVkQXJncyA9IFwidHJhbnNhY3Rpb25cIiBpbiBhcmdzID8gU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIubm9ybWFsaXplQXJncyhhcmdzKSA6IGFyZ3M7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgbm9ybWFsaXplZEFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlMi5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIHNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvbihhcmdzKSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgYXJncyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UyLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmFyZ3M7XG4gIH1cbiAgLy8gZW5kcmVnaW9uXG59O1xuZXhwb3J0IHtcbiAgQUNEYXBwQ2xpZW50LFxuICBBQ0tleWxlc3NDbGllbnQsXG4gIERBUFBfUEFJUklOR1NfV0lORE9XX1NUT1JBR0VfS0VZLFxuICBJQ0RhcHBDbGllbnQsXG4gIHdpbmRvd1N0YXRlQWNjZXNzb3JzXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/../../../../node_modules/@identity-connect/dapp-sdk/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/../../../../node_modules/@identity-connect/wallet-api/dist/index.mjs":
/*!****************************************************************************!*\
  !*** ../../../../node_modules/@identity-connect/wallet-api/dist/index.mjs ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bcsDeserialize: () => (/* binding */ bcsDeserialize),\n/* harmony export */   bcsSerialize: () => (/* binding */ bcsSerialize),\n/* harmony export */   deserializeJsonTransactionPayload: () => (/* binding */ deserializeJsonTransactionPayload),\n/* harmony export */   deserializeRawTransaction: () => (/* binding */ deserializeRawTransaction),\n/* harmony export */   deserializeSignAndSubmitTransactionRequestArgs: () => (/* binding */ deserializeSignAndSubmitTransactionRequestArgs),\n/* harmony export */   deserializeSignTransactionRequestArgs: () => (/* binding */ deserializeSignTransactionRequestArgs),\n/* harmony export */   deserializeSignTransactionResponseArgs: () => (/* binding */ deserializeSignTransactionResponseArgs),\n/* harmony export */   isBcsSerializable: () => (/* binding */ isBcsSerializable),\n/* harmony export */   makeFullMessage: () => (/* binding */ makeFullMessage),\n/* harmony export */   serializeJsonTransactionPayload: () => (/* binding */ serializeJsonTransactionPayload),\n/* harmony export */   serializeRawTransaction: () => (/* binding */ serializeRawTransaction),\n/* harmony export */   serializeSignAndSubmitTransactionRequestArgs: () => (/* binding */ serializeSignAndSubmitTransactionRequestArgs),\n/* harmony export */   serializeSignTransactionRequestArgs: () => (/* binding */ serializeSignTransactionRequestArgs),\n/* harmony export */   serializeSignTransactionResponseArgs: () => (/* binding */ serializeSignTransactionResponseArgs)\n/* harmony export */ });\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/../../../../node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var aptos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aptos */ \"(ssr)/../../../../node_modules/aptos/dist/index.mjs\");\n// src/serialization/bcsSerialization.ts\n\n\nfunction isBcsSerializableV1(value) {\n  return value?.serialize !== void 0;\n}\nfunction isBcsSerializableV2(value) {\n  return value?.serialize !== void 0 && value?.bcsToBytes !== void 0 && value?.bcsToHex !== void 0;\n}\nfunction isBcsSerializable(value) {\n  return isBcsSerializableV1(value) || isBcsSerializableV2(value);\n}\nfunction bcsSerialize(serializable) {\n  if (isBcsSerializableV2(serializable)) {\n    return serializable.bcsToHex().toString();\n  }\n  const serializedValueBytes = aptos__WEBPACK_IMPORTED_MODULE_1__.BCS.bcsToBytes(serializable);\n  return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(serializedValueBytes).toString();\n}\nfunction bcsDeserialize(deserializableClass, serializedValue) {\n  const serializedValueBytes = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexString(serializedValue).toUint8Array();\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedValueBytes);\n  return deserializableClass.deserialize(deserializer);\n}\n\n// src/serialization/jsonPayload.ts\n\n\n// src/serialization/error.ts\nvar UnexpectedValueError = class _UnexpectedValueError extends Error {\n  constructor(message) {\n    super(message);\n    this.name = \"UnexpectedValueError\";\n    Object.setPrototypeOf(this, _UnexpectedValueError.prototype);\n  }\n};\n\n// src/serialization/jsonPayload.ts\nfunction isSerializedUint8Array(arg) {\n  return arg?.type === \"Uint8Array\" && typeof arg?.value === \"string\";\n}\nfunction serializeEntryFunctionArg(arg) {\n  if (arg instanceof Uint8Array) {\n    return {\n      type: \"Uint8Array\",\n      value: _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(arg).toString()\n    };\n  }\n  if (Array.isArray(arg)) {\n    return arg.map(serializeEntryFunctionArg);\n  }\n  return arg;\n}\nfunction deserializeEntryFunctionArg(arg) {\n  if (isSerializedUint8Array(arg)) {\n    return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(arg.value).toUint8Array();\n  }\n  if (Array.isArray(arg)) {\n    return arg.map(deserializeEntryFunctionArg);\n  }\n  return arg;\n}\nfunction serializeEntryFunctionPayload(payload) {\n  const normalizedArgs = payload.arguments.map(serializeEntryFunctionArg);\n  return {\n    ...payload,\n    arguments: normalizedArgs,\n    type: \"entry_function_payload\"\n  };\n}\nfunction deserializeEntryFunctionPayload(payload) {\n  const deserializedArgs = payload.arguments.map(deserializeEntryFunctionArg);\n  return {\n    ...payload,\n    arguments: deserializedArgs,\n    type: \"entry_function_payload\"\n  };\n}\nfunction serializeJsonTransactionPayload(payload) {\n  if (payload.type === \"entry_function_payload\" || payload.type === void 0) {\n    return serializeEntryFunctionPayload(payload);\n  }\n  if (payload.type === \"multisig_payload\") {\n    const innerPayload = payload.transaction_payload !== void 0 ? serializeEntryFunctionPayload(payload.transaction_payload) : void 0;\n    return { ...payload, transaction_payload: innerPayload };\n  }\n  throw new UnexpectedValueError();\n}\nfunction deserializeJsonTransactionPayload(payload) {\n  if (payload.type === \"entry_function_payload\" || payload.type === void 0) {\n    return deserializeEntryFunctionPayload(payload);\n  }\n  if (payload.type === \"multisig_payload\") {\n    const innerPayload = payload.transaction_payload !== void 0 ? deserializeEntryFunctionPayload(payload.transaction_payload) : void 0;\n    return { ...payload, transaction_payload: innerPayload };\n  }\n  throw new UnexpectedValueError();\n}\n\n// src/serialization/rawTxn.ts\n\nfunction serializeRawTransaction(rawTxn) {\n  const value = bcsSerialize(rawTxn);\n  if (\"fee_payer_address\" in rawTxn) {\n    return { type: \"fee_payer_raw_txn\", value };\n  }\n  if (\"secondary_signer_addresses\" in rawTxn) {\n    return { type: \"multi_agent_raw_txn\", value };\n  }\n  if (\"chain_id\" in rawTxn) {\n    return { type: \"raw_txn\", value };\n  }\n  throw new UnexpectedValueError(\"Invalid raw transaction type\");\n}\nfunction deserializeRawTransaction(serialized) {\n  switch (serialized.type) {\n    case \"raw_txn\":\n      return bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransaction, serialized.value);\n    case \"fee_payer_raw_txn\":\n      return bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransactionWithData, serialized.value);\n    case \"multi_agent_raw_txn\":\n      return bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransactionWithData, serialized.value);\n    default:\n      throw new UnexpectedValueError(\"Invalid raw transaction type\");\n  }\n}\n\n// src/serialization/signAndSubmitTransactionRequestArgs.ts\n\nfunction serializeSignAndSubmitTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const serializedPayload = isBcsSerializable(args.payload) ? bcsSerialize(args.payload) : serializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload: serializedPayload };\n  }\n  if (\"feePayerAuthenticator\" in args) {\n    return {\n      feePayerAuthenticator: bcsSerialize(args.feePayerAuthenticator),\n      rawTxn: serializeRawTransaction(args.rawTxn)\n    };\n  }\n  if (\"rawTxn\" in args) {\n    return { rawTxn: serializeRawTransaction(args.rawTxn) };\n  }\n  throw new UnexpectedValueError();\n}\nfunction deserializeSignAndSubmitTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const payload = typeof args.payload === \"string\" ? bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TransactionPayload, args.payload) : deserializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload };\n  }\n  if (\"feePayerAuthenticator\" in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    const feePayerAuthenticator = bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAuthenticator, args.feePayerAuthenticator);\n    return { feePayerAuthenticator, rawTxn: deserializedRawTxn };\n  }\n  if (\"rawTxn\" in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    return { rawTxn: deserializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\n\n// src/serialization/signTransactionRequestArgs.ts\n\nfunction serializeSignTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const serializedPayload = isBcsSerializable(args.payload) ? bcsSerialize(args.payload) : serializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload: serializedPayload };\n  }\n  if (\"rawTxn\" in args) {\n    const serializedRawTxn = serializeRawTransaction(args.rawTxn);\n    return { rawTxn: serializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\nfunction deserializeSignTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const payload = typeof args.payload === \"string\" ? bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TransactionPayload, args.payload) : deserializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload };\n  }\n  if (\"rawTxn\" in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    return { rawTxn: deserializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\n\n// src/serialization/signTransactionResponseArgs.ts\n\nfunction serializeSignTransactionResponseArgs(args) {\n  const accountAuthenticator = bcsSerialize(args.accountAuthenticator);\n  if (\"rawTxn\" in args) {\n    const rawTxn = bcsSerialize(args.rawTxn);\n    return { accountAuthenticator, rawTxn };\n  }\n  return { accountAuthenticator };\n}\nfunction deserializeSignTransactionResponseArgs(args) {\n  const accountAuthenticator = bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAuthenticator, args.accountAuthenticator);\n  if (\"rawTxn\" in args) {\n    const rawTxn = bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransaction, args.rawTxn);\n    return { accountAuthenticator, rawTxn };\n  }\n  return { accountAuthenticator };\n}\n\n// src/utils/makeFullMessage.ts\nvar prefix = \"APTOS\";\nfunction makeFullMessage(params, flags) {\n  let fullMessage = prefix;\n  if (flags.address) {\n    fullMessage += `\naddress: ${params.address}`;\n  }\n  if (flags.application) {\n    fullMessage += `\napplication: ${params.application}`;\n  }\n  if (flags.chainId) {\n    fullMessage += `\nchainId: ${params.chainId}`;\n  }\n  fullMessage += `\nmessage: ${params.message}`;\n  fullMessage += `\nnonce: ${params.nonce}`;\n  return {\n    fullMessage,\n    prefix\n  };\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL0BpZGVudGl0eS1jb25uZWN0L3dhbGxldC1hcGkvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ3VEO0FBQzNCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHNDQUFHO0FBQ2xDLFNBQVMsbURBQUc7QUFDWjtBQUNBO0FBQ0EsK0JBQStCLG1EQUFHO0FBQ2xDLDJCQUEyQiw0REFBWTtBQUN2QztBQUNBOztBQUVBO0FBQ2lEOztBQUVqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLG1EQUFJO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsbURBQUk7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBSTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDhEQUFjO0FBQzFDO0FBQ0EsNEJBQTRCLHNFQUFzQjtBQUNsRDtBQUNBLDRCQUE0QixzRUFBc0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDOEU7QUFDOUU7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSxrRUFBa0I7QUFDeEYsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxvRUFBb0I7QUFDckUsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDK0U7QUFDL0U7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLGtFQUFtQjtBQUN6RixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNzSDtBQUN0SDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsOENBQThDLG9FQUFxQjtBQUNuRTtBQUNBLGtDQUFrQyw4REFBZTtBQUNqRCxhQUFhO0FBQ2I7QUFDQSxXQUFXO0FBQ1g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxlQUFlO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLGVBQWUsbUJBQW1CO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLFdBQVcsZUFBZTtBQUMxQjtBQUNBO0FBQ0EsV0FBVyxlQUFlO0FBQzFCO0FBQ0EsU0FBUyxhQUFhO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFnQkU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Zyb250ZW5kLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9AaWRlbnRpdHktY29ubmVjdC93YWxsZXQtYXBpL2Rpc3QvaW5kZXgubWpzPzM4MTkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3NlcmlhbGl6YXRpb24vYmNzU2VyaWFsaXphdGlvbi50c1xuaW1wb3J0IHsgRGVzZXJpYWxpemVyLCBIZXggfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQgeyBCQ1MgfSBmcm9tIFwiYXB0b3NcIjtcbmZ1bmN0aW9uIGlzQmNzU2VyaWFsaXphYmxlVjEodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlPy5zZXJpYWxpemUgIT09IHZvaWQgMDtcbn1cbmZ1bmN0aW9uIGlzQmNzU2VyaWFsaXphYmxlVjIodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlPy5zZXJpYWxpemUgIT09IHZvaWQgMCAmJiB2YWx1ZT8uYmNzVG9CeXRlcyAhPT0gdm9pZCAwICYmIHZhbHVlPy5iY3NUb0hleCAhPT0gdm9pZCAwO1xufVxuZnVuY3Rpb24gaXNCY3NTZXJpYWxpemFibGUodmFsdWUpIHtcbiAgcmV0dXJuIGlzQmNzU2VyaWFsaXphYmxlVjEodmFsdWUpIHx8IGlzQmNzU2VyaWFsaXphYmxlVjIodmFsdWUpO1xufVxuZnVuY3Rpb24gYmNzU2VyaWFsaXplKHNlcmlhbGl6YWJsZSkge1xuICBpZiAoaXNCY3NTZXJpYWxpemFibGVWMihzZXJpYWxpemFibGUpKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6YWJsZS5iY3NUb0hleCgpLnRvU3RyaW5nKCk7XG4gIH1cbiAgY29uc3Qgc2VyaWFsaXplZFZhbHVlQnl0ZXMgPSBCQ1MuYmNzVG9CeXRlcyhzZXJpYWxpemFibGUpO1xuICByZXR1cm4gSGV4LmZyb21IZXhJbnB1dChzZXJpYWxpemVkVmFsdWVCeXRlcykudG9TdHJpbmcoKTtcbn1cbmZ1bmN0aW9uIGJjc0Rlc2VyaWFsaXplKGRlc2VyaWFsaXphYmxlQ2xhc3MsIHNlcmlhbGl6ZWRWYWx1ZSkge1xuICBjb25zdCBzZXJpYWxpemVkVmFsdWVCeXRlcyA9IEhleC5mcm9tSGV4U3RyaW5nKHNlcmlhbGl6ZWRWYWx1ZSkudG9VaW50OEFycmF5KCk7XG4gIGNvbnN0IGRlc2VyaWFsaXplciA9IG5ldyBEZXNlcmlhbGl6ZXIoc2VyaWFsaXplZFZhbHVlQnl0ZXMpO1xuICByZXR1cm4gZGVzZXJpYWxpemFibGVDbGFzcy5kZXNlcmlhbGl6ZShkZXNlcmlhbGl6ZXIpO1xufVxuXG4vLyBzcmMvc2VyaWFsaXphdGlvbi9qc29uUGF5bG9hZC50c1xuaW1wb3J0IHsgSGV4IGFzIEhleDIgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uL2Vycm9yLnRzXG52YXIgVW5leHBlY3RlZFZhbHVlRXJyb3IgPSBjbGFzcyBfVW5leHBlY3RlZFZhbHVlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIlVuZXhwZWN0ZWRWYWx1ZUVycm9yXCI7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIF9VbmV4cGVjdGVkVmFsdWVFcnJvci5wcm90b3R5cGUpO1xuICB9XG59O1xuXG4vLyBzcmMvc2VyaWFsaXphdGlvbi9qc29uUGF5bG9hZC50c1xuZnVuY3Rpb24gaXNTZXJpYWxpemVkVWludDhBcnJheShhcmcpIHtcbiAgcmV0dXJuIGFyZz8udHlwZSA9PT0gXCJVaW50OEFycmF5XCIgJiYgdHlwZW9mIGFyZz8udmFsdWUgPT09IFwic3RyaW5nXCI7XG59XG5mdW5jdGlvbiBzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJnKGFyZykge1xuICBpZiAoYXJnIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcIlVpbnQ4QXJyYXlcIixcbiAgICAgIHZhbHVlOiBIZXgyLmZyb21IZXhJbnB1dChhcmcpLnRvU3RyaW5nKClcbiAgICB9O1xuICB9XG4gIGlmIChBcnJheS5pc0FycmF5KGFyZykpIHtcbiAgICByZXR1cm4gYXJnLm1hcChzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJnKTtcbiAgfVxuICByZXR1cm4gYXJnO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJnKGFyZykge1xuICBpZiAoaXNTZXJpYWxpemVkVWludDhBcnJheShhcmcpKSB7XG4gICAgcmV0dXJuIEhleDIuZnJvbUhleElucHV0KGFyZy52YWx1ZSkudG9VaW50OEFycmF5KCk7XG4gIH1cbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJnKSkge1xuICAgIHJldHVybiBhcmcubWFwKGRlc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZyk7XG4gIH1cbiAgcmV0dXJuIGFyZztcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25QYXlsb2FkKHBheWxvYWQpIHtcbiAgY29uc3Qgbm9ybWFsaXplZEFyZ3MgPSBwYXlsb2FkLmFyZ3VtZW50cy5tYXAoc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZyk7XG4gIHJldHVybiB7XG4gICAgLi4ucGF5bG9hZCxcbiAgICBhcmd1bWVudHM6IG5vcm1hbGl6ZWRBcmdzLFxuICAgIHR5cGU6IFwiZW50cnlfZnVuY3Rpb25fcGF5bG9hZFwiXG4gIH07XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25QYXlsb2FkKHBheWxvYWQpIHtcbiAgY29uc3QgZGVzZXJpYWxpemVkQXJncyA9IHBheWxvYWQuYXJndW1lbnRzLm1hcChkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25BcmcpO1xuICByZXR1cm4ge1xuICAgIC4uLnBheWxvYWQsXG4gICAgYXJndW1lbnRzOiBkZXNlcmlhbGl6ZWRBcmdzLFxuICAgIHR5cGU6IFwiZW50cnlfZnVuY3Rpb25fcGF5bG9hZFwiXG4gIH07XG59XG5mdW5jdGlvbiBzZXJpYWxpemVKc29uVHJhbnNhY3Rpb25QYXlsb2FkKHBheWxvYWQpIHtcbiAgaWYgKHBheWxvYWQudHlwZSA9PT0gXCJlbnRyeV9mdW5jdGlvbl9wYXlsb2FkXCIgfHwgcGF5bG9hZC50eXBlID09PSB2b2lkIDApIHtcbiAgICByZXR1cm4gc2VyaWFsaXplRW50cnlGdW5jdGlvblBheWxvYWQocGF5bG9hZCk7XG4gIH1cbiAgaWYgKHBheWxvYWQudHlwZSA9PT0gXCJtdWx0aXNpZ19wYXlsb2FkXCIpIHtcbiAgICBjb25zdCBpbm5lclBheWxvYWQgPSBwYXlsb2FkLnRyYW5zYWN0aW9uX3BheWxvYWQgIT09IHZvaWQgMCA/IHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25QYXlsb2FkKHBheWxvYWQudHJhbnNhY3Rpb25fcGF5bG9hZCkgOiB2b2lkIDA7XG4gICAgcmV0dXJuIHsgLi4ucGF5bG9hZCwgdHJhbnNhY3Rpb25fcGF5bG9hZDogaW5uZXJQYXlsb2FkIH07XG4gIH1cbiAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRWYWx1ZUVycm9yKCk7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUpzb25UcmFuc2FjdGlvblBheWxvYWQocGF5bG9hZCkge1xuICBpZiAocGF5bG9hZC50eXBlID09PSBcImVudHJ5X2Z1bmN0aW9uX3BheWxvYWRcIiB8fCBwYXlsb2FkLnR5cGUgPT09IHZvaWQgMCkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25QYXlsb2FkKHBheWxvYWQpO1xuICB9XG4gIGlmIChwYXlsb2FkLnR5cGUgPT09IFwibXVsdGlzaWdfcGF5bG9hZFwiKSB7XG4gICAgY29uc3QgaW5uZXJQYXlsb2FkID0gcGF5bG9hZC50cmFuc2FjdGlvbl9wYXlsb2FkICE9PSB2b2lkIDAgPyBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25QYXlsb2FkKHBheWxvYWQudHJhbnNhY3Rpb25fcGF5bG9hZCkgOiB2b2lkIDA7XG4gICAgcmV0dXJuIHsgLi4ucGF5bG9hZCwgdHJhbnNhY3Rpb25fcGF5bG9hZDogaW5uZXJQYXlsb2FkIH07XG4gIH1cbiAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRWYWx1ZUVycm9yKCk7XG59XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uL3Jhd1R4bi50c1xuaW1wb3J0IHtcbiAgUmF3VHJhbnNhY3Rpb24sXG4gIFJhd1RyYW5zYWN0aW9uV2l0aERhdGFcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplUmF3VHJhbnNhY3Rpb24ocmF3VHhuKSB7XG4gIGNvbnN0IHZhbHVlID0gYmNzU2VyaWFsaXplKHJhd1R4bik7XG4gIGlmIChcImZlZV9wYXllcl9hZGRyZXNzXCIgaW4gcmF3VHhuKSB7XG4gICAgcmV0dXJuIHsgdHlwZTogXCJmZWVfcGF5ZXJfcmF3X3R4blwiLCB2YWx1ZSB9O1xuICB9XG4gIGlmIChcInNlY29uZGFyeV9zaWduZXJfYWRkcmVzc2VzXCIgaW4gcmF3VHhuKSB7XG4gICAgcmV0dXJuIHsgdHlwZTogXCJtdWx0aV9hZ2VudF9yYXdfdHhuXCIsIHZhbHVlIH07XG4gIH1cbiAgaWYgKFwiY2hhaW5faWRcIiBpbiByYXdUeG4pIHtcbiAgICByZXR1cm4geyB0eXBlOiBcInJhd190eG5cIiwgdmFsdWUgfTtcbiAgfVxuICB0aHJvdyBuZXcgVW5leHBlY3RlZFZhbHVlRXJyb3IoXCJJbnZhbGlkIHJhdyB0cmFuc2FjdGlvbiB0eXBlXCIpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVSYXdUcmFuc2FjdGlvbihzZXJpYWxpemVkKSB7XG4gIHN3aXRjaCAoc2VyaWFsaXplZC50eXBlKSB7XG4gICAgY2FzZSBcInJhd190eG5cIjpcbiAgICAgIHJldHVybiBiY3NEZXNlcmlhbGl6ZShSYXdUcmFuc2FjdGlvbiwgc2VyaWFsaXplZC52YWx1ZSk7XG4gICAgY2FzZSBcImZlZV9wYXllcl9yYXdfdHhuXCI6XG4gICAgICByZXR1cm4gYmNzRGVzZXJpYWxpemUoUmF3VHJhbnNhY3Rpb25XaXRoRGF0YSwgc2VyaWFsaXplZC52YWx1ZSk7XG4gICAgY2FzZSBcIm11bHRpX2FnZW50X3Jhd190eG5cIjpcbiAgICAgIHJldHVybiBiY3NEZXNlcmlhbGl6ZShSYXdUcmFuc2FjdGlvbldpdGhEYXRhLCBzZXJpYWxpemVkLnZhbHVlKTtcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRWYWx1ZUVycm9yKFwiSW52YWxpZCByYXcgdHJhbnNhY3Rpb24gdHlwZVwiKTtcbiAgfVxufVxuXG4vLyBzcmMvc2VyaWFsaXphdGlvbi9zaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0QXJncy50c1xuaW1wb3J0IHsgQWNjb3VudEF1dGhlbnRpY2F0b3IsIFRyYW5zYWN0aW9uUGF5bG9hZCB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmZ1bmN0aW9uIHNlcmlhbGl6ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3RBcmdzKGFyZ3MpIHtcbiAgaWYgKFwicGF5bG9hZFwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUGF5bG9hZCA9IGlzQmNzU2VyaWFsaXphYmxlKGFyZ3MucGF5bG9hZCkgPyBiY3NTZXJpYWxpemUoYXJncy5wYXlsb2FkKSA6IHNlcmlhbGl6ZUpzb25UcmFuc2FjdGlvblBheWxvYWQoYXJncy5wYXlsb2FkKTtcbiAgICByZXR1cm4geyBvcHRpb25zOiBhcmdzLm9wdGlvbnMsIHBheWxvYWQ6IHNlcmlhbGl6ZWRQYXlsb2FkIH07XG4gIH1cbiAgaWYgKFwiZmVlUGF5ZXJBdXRoZW50aWNhdG9yXCIgaW4gYXJncykge1xuICAgIHJldHVybiB7XG4gICAgICBmZWVQYXllckF1dGhlbnRpY2F0b3I6IGJjc1NlcmlhbGl6ZShhcmdzLmZlZVBheWVyQXV0aGVudGljYXRvciksXG4gICAgICByYXdUeG46IHNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uKGFyZ3MucmF3VHhuKVxuICAgIH07XG4gIH1cbiAgaWYgKFwicmF3VHhuXCIgaW4gYXJncykge1xuICAgIHJldHVybiB7IHJhd1R4bjogc2VyaWFsaXplUmF3VHJhbnNhY3Rpb24oYXJncy5yYXdUeG4pIH07XG4gIH1cbiAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRWYWx1ZUVycm9yKCk7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3RBcmdzKGFyZ3MpIHtcbiAgaWYgKFwicGF5bG9hZFwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCBwYXlsb2FkID0gdHlwZW9mIGFyZ3MucGF5bG9hZCA9PT0gXCJzdHJpbmdcIiA/IGJjc0Rlc2VyaWFsaXplKFRyYW5zYWN0aW9uUGF5bG9hZCwgYXJncy5wYXlsb2FkKSA6IGRlc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZChhcmdzLnBheWxvYWQpO1xuICAgIHJldHVybiB7IG9wdGlvbnM6IGFyZ3Mub3B0aW9ucywgcGF5bG9hZCB9O1xuICB9XG4gIGlmIChcImZlZVBheWVyQXV0aGVudGljYXRvclwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCBkZXNlcmlhbGl6ZWRSYXdUeG4gPSBkZXNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uKGFyZ3MucmF3VHhuKTtcbiAgICBjb25zdCBmZWVQYXllckF1dGhlbnRpY2F0b3IgPSBiY3NEZXNlcmlhbGl6ZShBY2NvdW50QXV0aGVudGljYXRvciwgYXJncy5mZWVQYXllckF1dGhlbnRpY2F0b3IpO1xuICAgIHJldHVybiB7IGZlZVBheWVyQXV0aGVudGljYXRvciwgcmF3VHhuOiBkZXNlcmlhbGl6ZWRSYXdUeG4gfTtcbiAgfVxuICBpZiAoXCJyYXdUeG5cIiBpbiBhcmdzKSB7XG4gICAgY29uc3QgZGVzZXJpYWxpemVkUmF3VHhuID0gZGVzZXJpYWxpemVSYXdUcmFuc2FjdGlvbihhcmdzLnJhd1R4bik7XG4gICAgcmV0dXJuIHsgcmF3VHhuOiBkZXNlcmlhbGl6ZWRSYXdUeG4gfTtcbiAgfVxuICB0aHJvdyBuZXcgVW5leHBlY3RlZFZhbHVlRXJyb3IoKTtcbn1cblxuLy8gc3JjL3NlcmlhbGl6YXRpb24vc2lnblRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MudHNcbmltcG9ydCB7IFRyYW5zYWN0aW9uUGF5bG9hZCBhcyBUcmFuc2FjdGlvblBheWxvYWQyIH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MoYXJncykge1xuICBpZiAoXCJwYXlsb2FkXCIgaW4gYXJncykge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRQYXlsb2FkID0gaXNCY3NTZXJpYWxpemFibGUoYXJncy5wYXlsb2FkKSA/IGJjc1NlcmlhbGl6ZShhcmdzLnBheWxvYWQpIDogc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZChhcmdzLnBheWxvYWQpO1xuICAgIHJldHVybiB7IG9wdGlvbnM6IGFyZ3Mub3B0aW9ucywgcGF5bG9hZDogc2VyaWFsaXplZFBheWxvYWQgfTtcbiAgfVxuICBpZiAoXCJyYXdUeG5cIiBpbiBhcmdzKSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJhd1R4biA9IHNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uKGFyZ3MucmF3VHhuKTtcbiAgICByZXR1cm4geyByYXdUeG46IHNlcmlhbGl6ZWRSYXdUeG4gfTtcbiAgfVxuICB0aHJvdyBuZXcgVW5leHBlY3RlZFZhbHVlRXJyb3IoKTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MoYXJncykge1xuICBpZiAoXCJwYXlsb2FkXCIgaW4gYXJncykge1xuICAgIGNvbnN0IHBheWxvYWQgPSB0eXBlb2YgYXJncy5wYXlsb2FkID09PSBcInN0cmluZ1wiID8gYmNzRGVzZXJpYWxpemUoVHJhbnNhY3Rpb25QYXlsb2FkMiwgYXJncy5wYXlsb2FkKSA6IGRlc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZChhcmdzLnBheWxvYWQpO1xuICAgIHJldHVybiB7IG9wdGlvbnM6IGFyZ3Mub3B0aW9ucywgcGF5bG9hZCB9O1xuICB9XG4gIGlmIChcInJhd1R4blwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCBkZXNlcmlhbGl6ZWRSYXdUeG4gPSBkZXNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uKGFyZ3MucmF3VHhuKTtcbiAgICByZXR1cm4geyByYXdUeG46IGRlc2VyaWFsaXplZFJhd1R4biB9O1xuICB9XG4gIHRocm93IG5ldyBVbmV4cGVjdGVkVmFsdWVFcnJvcigpO1xufVxuXG4vLyBzcmMvc2VyaWFsaXphdGlvbi9zaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3MudHNcbmltcG9ydCB7IEFjY291bnRBdXRoZW50aWNhdG9yIGFzIEFjY291bnRBdXRoZW50aWNhdG9yMiwgUmF3VHJhbnNhY3Rpb24gYXMgUmF3VHJhbnNhY3Rpb24yIH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVzcG9uc2VBcmdzKGFyZ3MpIHtcbiAgY29uc3QgYWNjb3VudEF1dGhlbnRpY2F0b3IgPSBiY3NTZXJpYWxpemUoYXJncy5hY2NvdW50QXV0aGVudGljYXRvcik7XG4gIGlmIChcInJhd1R4blwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCByYXdUeG4gPSBiY3NTZXJpYWxpemUoYXJncy5yYXdUeG4pO1xuICAgIHJldHVybiB7IGFjY291bnRBdXRoZW50aWNhdG9yLCByYXdUeG4gfTtcbiAgfVxuICByZXR1cm4geyBhY2NvdW50QXV0aGVudGljYXRvciB9O1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3MoYXJncykge1xuICBjb25zdCBhY2NvdW50QXV0aGVudGljYXRvciA9IGJjc0Rlc2VyaWFsaXplKEFjY291bnRBdXRoZW50aWNhdG9yMiwgYXJncy5hY2NvdW50QXV0aGVudGljYXRvcik7XG4gIGlmIChcInJhd1R4blwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCByYXdUeG4gPSBiY3NEZXNlcmlhbGl6ZShSYXdUcmFuc2FjdGlvbjIsIGFyZ3MucmF3VHhuKTtcbiAgICByZXR1cm4geyBhY2NvdW50QXV0aGVudGljYXRvciwgcmF3VHhuIH07XG4gIH1cbiAgcmV0dXJuIHsgYWNjb3VudEF1dGhlbnRpY2F0b3IgfTtcbn1cblxuLy8gc3JjL3V0aWxzL21ha2VGdWxsTWVzc2FnZS50c1xudmFyIHByZWZpeCA9IFwiQVBUT1NcIjtcbmZ1bmN0aW9uIG1ha2VGdWxsTWVzc2FnZShwYXJhbXMsIGZsYWdzKSB7XG4gIGxldCBmdWxsTWVzc2FnZSA9IHByZWZpeDtcbiAgaWYgKGZsYWdzLmFkZHJlc3MpIHtcbiAgICBmdWxsTWVzc2FnZSArPSBgXG5hZGRyZXNzOiAke3BhcmFtcy5hZGRyZXNzfWA7XG4gIH1cbiAgaWYgKGZsYWdzLmFwcGxpY2F0aW9uKSB7XG4gICAgZnVsbE1lc3NhZ2UgKz0gYFxuYXBwbGljYXRpb246ICR7cGFyYW1zLmFwcGxpY2F0aW9ufWA7XG4gIH1cbiAgaWYgKGZsYWdzLmNoYWluSWQpIHtcbiAgICBmdWxsTWVzc2FnZSArPSBgXG5jaGFpbklkOiAke3BhcmFtcy5jaGFpbklkfWA7XG4gIH1cbiAgZnVsbE1lc3NhZ2UgKz0gYFxubWVzc2FnZTogJHtwYXJhbXMubWVzc2FnZX1gO1xuICBmdWxsTWVzc2FnZSArPSBgXG5ub25jZTogJHtwYXJhbXMubm9uY2V9YDtcbiAgcmV0dXJuIHtcbiAgICBmdWxsTWVzc2FnZSxcbiAgICBwcmVmaXhcbiAgfTtcbn1cbmV4cG9ydCB7XG4gIGJjc0Rlc2VyaWFsaXplLFxuICBiY3NTZXJpYWxpemUsXG4gIGRlc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZCxcbiAgZGVzZXJpYWxpemVSYXdUcmFuc2FjdGlvbixcbiAgZGVzZXJpYWxpemVTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0QXJncyxcbiAgZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXF1ZXN0QXJncyxcbiAgZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3MsXG4gIGlzQmNzU2VyaWFsaXphYmxlLFxuICBtYWtlRnVsbE1lc3NhZ2UsXG4gIHNlcmlhbGl6ZUpzb25UcmFuc2FjdGlvblBheWxvYWQsXG4gIHNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uLFxuICBzZXJpYWxpemVTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0QXJncyxcbiAgc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MsXG4gIHNlcmlhbGl6ZVNpZ25UcmFuc2FjdGlvblJlc3BvbnNlQXJnc1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/../../../../node_modules/@identity-connect/wallet-api/dist/index.mjs\n");

/***/ })

};
;